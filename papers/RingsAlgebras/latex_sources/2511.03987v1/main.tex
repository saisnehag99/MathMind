\documentclass[12pt,letterpaper, oneside, reqno]{amsart}
\usepackage{lmodern}
\usepackage{amssymb,amsthm,amsmath,amstext,amsxtra, amscd, amsrefs}
\usepackage{enumitem}
\usepackage{mathrsfs}
\usepackage{comment}
\usepackage{geometry}
\usepackage{fullpage}
\usepackage{colonequals}
\usepackage[colorlinks=true, linkcolor=blue, citecolor=blue,urlcolor=blue]{hyperref}
\usepackage{cleveref}
\numberwithin{equation}{subsection}
\usepackage{tikz-cd}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{textgreek}
\allowdisplaybreaks

\newtheorem{thm}[equation]{Theorem}
\newtheorem{con}[equation]{Conjecture}
\newtheorem{prop}[equation]{Proposition}
\newtheorem{lem}[equation]{Lemma}
\newtheorem{cor}[equation]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[equation]{Definition}
\newtheorem{example}[equation]{Example}
\newtheorem{exm}[equation]{Example}
\newtheorem{properties}[equation]{Properties}
\newtheorem{note}[equation]{Note}
\theoremstyle{remark}
\newtheorem{remark}[equation]{Remark}

%%%%%%%%%%
\newcommand{\R}{\mathbb{R}}    
\newcommand{\Z}{\mathbb{Z}}  
\newcommand{\Q}{\mathbb{Q}}   
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\G}{\mathbb{G}}
\newcommand{\HH}{\mathcal{H}}

\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\disc}{disc}
\DeclareMathOperator{\sgndisc}{sgndisc}
\DeclareMathOperator{\Ob}{Ob}
\DeclareMathOperator{\Gen}{Gen}
\DeclareMathOperator{\Cls}{Cls}
\DeclareMathOperator{\opchar}{char} 
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\rad}{rad}
\DeclareMathOperator{\rk}{rank}
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\Pl}{Pl}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\Nm}{Nm}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\Clf}{Clf}
\DeclareMathOperator{\Ten}{Ten}
\DeclareMathOperator{\rev}{rev}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\M}{M}
\DeclareMathOperator{\OO}{O}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Pic}{Pic}
\DeclareMathOperator{\Frac}{Frac}
\DeclareMathOperator{\trd}{trd}
\DeclareMathOperator{\nrd}{nrd}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\GO}{GO}
\DeclareMathOperator{\Orthogonal}{O}
\DeclareMathOperator{\GSO}{GSO}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Real}{Re}
\DeclareMathOperator{\Imag}{Im}
\DeclareMathOperator{\Idl}{Idl}
\DeclareMathOperator{\lvl}{lvl}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\res}{res}
\DeclareMathOperator{\ev}{ev}
\DeclareMathOperator{\Qfr}{\mathcal{Q}^{fr}}
\DeclareMathOperator{\Pfr}{\mathcal{P}^{fr}}
\DeclareMathOperator{\SIfr}{\mathcal{SI}^{fr}}
\newcommand{\Gm}{\mathbb{G}_m}

\newcommand{\tbigwedge}{\smash{\raisebox{0.2ex}{\ensuremath{\textstyle{\bigwedge}}}}}

\newcommand{\scrA}{\mathscr{A}}
\newcommand{\scrC}{\mathscr{C}}
\newcommand{\scrE}{\mathscr{E}}
\newcommand{\scrO}{\mathscr{O}}
\newcommand{\scrM}{\mathscr{M}}
\newcommand{\scrL}{\mathscr{L}}
\newcommand{\calO}{\scrO}
\newcommand{\scrI}{\mathscr{I}}
\newcommand{\scrJ}{\mathscr{J}}
\newcommand{\scrN}{\mathscr{N}}
\newcommand{\scrP}{\mathscr{P}}
\newcommand{\scrZ}{\mathscr{Z}}


\newcommand{\fraka}{\mathfrak{a}}
\newcommand{\frakb}{\mathfrak{b}}
\newcommand{\frakp}{\mathfrak{p}}

\DeclareMathOperator{\HHom}{\mathscr{H}\!\mathit{om}}
\DeclareMathOperator{\TTen}{\mathscr{T}\!\mathit{en}}

\newenvironment{enumalph}
{\begin{enumerate}\renewcommand{\labelenumi}{\textnormal{(\alph{enumi})}}}
{\end{enumerate}}

\newenvironment{enumroman}
{\begin{enumerate}\renewcommand{\labelenumi}{\textnormal{(\roman{enumi})}}}
{\end{enumerate}}


\newcommand{\simeqGSO}{\simeq_{\GSO}} 
\newcommand{\simeqSO}{\simeq_{\SO}}
\newcommand{\simeqGO}{\simeq_{\GO}}
\newcommand{\simeqO}{\simeq_{\OO}}

\newcommand{\abs}[1]{\lvert #1 \rvert}
\newcommand{\hlb}[2]{( #1, #2 )}
\newcommand{\legendre}[2]{\ensuremath{\left( \frac{#1}{#2} \right) }}
\newcommand\isomto{\stackrel{\sim}{\smash{\longrightarrow}\rule{0pt}{0.4ex}}}

\newcommand{\jv}[1]{{\color{red} \sf JV: [#1]}}
\newcommand{\hw}[1]{{\color{blue} \sf HW: [#1]}}

\newcommand{\defi}[1]{\textit{\textsf{#1}}}

\DeclareMathOperator{\catPic}{\textup{\textbf{\textsf{Pic}}}}
\DeclareMathOperator{\catSch}{\textup{\textbf{\textsf{Sch}}}}
\DeclareMathOperator{\catQuad}{\textup{\textbf{\textsf{Quad}}}}
\DeclareMathOperator{\catSet}{\textup{\textbf{\textsf{Set}}}}
\DeclareMathOperator{\catGrpd}{\textup{\textbf{\textsf{Grpd}}}}

\author{John Voight}
\address{Department of Mathematics, Dartmouth College, Kemeny Hall, Hanover, NH 03755, USA; Carslaw Building (F07), Department of Mathematics and Statistics, University of Sydney, NSW 2006, Australia}
\email{jvoight@gmail.com}

\author{Haochen Wu}
\address{Department of Mathematics, Dartmouth College, Kemeny Hall, Hanover, NH 03755, USA}
\email{haochen.wu.gr@dartmouth.edu}

\title{An orthogonal perspective on Gauss composition}

\begin{document}

\begin{abstract}
We revisit Gauss composition over a general base scheme, with a focus on orthogonal groups.  We show that the Clifford and norm functors provide a discriminant-preserving equivalence of categories between binary quadratic modules and pseudoregular modules over quadratic algebras.  This perspective synthesizes the constructions of Kneser and Wood, reconciling algebraic and geometric approaches and clarifying the role of orientations and the natural emergence of narrow class groups.  As an application, we restrict to lattices and show that binary orthogonal eigenforms correspond to Hecke characters.
\end{abstract}

\setcounter{tocdepth}{1}

\subjclass[2020]{11E16, 11E12, 11E41, 11R65, 14L35, 14D20}
\keywords{binary quadratic forms, orthogonal groups, Gauss composition, orthogonal modular forms, Clifford algebras, norms}

\maketitle
\tableofcontents

\section{Introduction}

\subsection{Motivation}

\emph{Gauss composition} is the term commonly employed for the bijection between equivalence classes of binary quadratic forms over $\Z$ and class groups of quadratic orders.  Many papers have been written providing generalizations of this all important result: we provide in \cref{recent work} an overview of recent work.  

In this paper, we view Gauss composition within the framework of orthogonal groups, synthesizing and extending previous work.  We show that Gauss composition over an arbitrary base can be understood through Clifford algebras with inverse given by the norm, recovering both the classical approach of Kneser \cite{Kneser} and the more geometric approach of Wood \cite{Wood}.  Organized by orthogonal groups, this perspective also naturally reconciles notions of orientations and morphisms, thereby providing a general composition law (including for narrow class groups) as well as applications to spaces of binary orthogonal modular forms.

\subsection{Setup}

To state our results, we will first need some definitions and notation; for further details in the setup, see \cref{sec:setup}.

Let $X$ be a scheme.  A \defi{quadratic $\scrO_X$-module} is a locally free $\scrO_X$-module $\scrM$ of finite rank equipped with a quadratic map $Q \colon \scrM \to \scrL$ taking values in an invertible $\scrO_X$-module, which we call the \defi{value line bundle}.  The quadratic map is equivalently specified by a global section of $(\Sym_2 \scrM)^\vee \otimes \scrL$.  A \defi{similarity} between two quadratic $\scrO_X$-modules is the natural commutative square \eqref{eqn:commdiag}.

The Clifford functor associates to a quadratic $\scrO_X$-module $Q \colon \scrM \to \scrL$ the odd Clifford bimodule $\Clf^1(Q)$ over the even Clifford $\scrO_X$-algebra $\Clf^0(Q)$.  When $\scrM$ is binary, $\Clf^0(Q)$ is a locally free quadratic $\scrO_X$-algebra and the Clifford functor fibers over the category $\catQuad$ of locally free quadratic algebras (itself fibered over $\catSch$, the category of schemes).  

The Clifford bimodule inherits the following key structural property.  Let $Y \to X$ be a locally free morphism of degree $n \geq 1$ and let $\scrI$ be an $\scrO_Y$-module which is locally free of rank $n$ as an $\scrO_X$-module.  Recall that the \emph{regular} $\scrO_Y$-module is $\scrO_Y$ itself (considered as an $\scrO_Y$-module).  Accordingly, we say that $\scrI$ is \defi{pseudoregular} if for all open $U \subseteq X$ and all $\alpha \in \scrO_Y(U)$, the characteristic polynomial of $\alpha$ acting by multiplication on $\scrO_Y(U)$ and $\scrI(U)$ are equal.  When $Y \to X$ has degree $n=2$, it is enough to check traces (\Cref{lem:traceable}), and so $\scrI$ is also called \defi{traceable} by Wood \cite{Wood}*{p.~1758}.  

Let $Q \colon \scrM \to \scrL$ be a binary quadratic $\scrO_X$-module and let $\scrO_Y$ be a quadratic $\scrO_X$-algebra.  An \defi{$\scrO_Y$-orientation} of $Q$ is an $\scrO_X$-algebra isomorphism $\Clf^0(Q) \xrightarrow{\sim} \scrO_Y$.  A similarity preserving orientations is called an \defi{oriented similarity}.  For further discussion on orientations, see below and \cref{sec:contribution}.  

Norms furnish an inverse to the Clifford functor, as follows.  Let $\scrI$ be a $\calO_Y$-module which is locally free of rank $2$ as an $\calO_X$-module.  We define a canonical \defi{norm map} 
\begin{equation} 
N_\scrI \colon \scrI \to \scrN(\scrI)
\end{equation}
where 
\begin{equation} \label{eqn:normmodule}
\scrN(\scrI) \colonequals \tbigwedge^2 \scrI \otimes (\scrO_Y/\scrO_X)^\vee;
\end{equation}
it earns its name from the property that 
\begin{equation}
N_\scrI(\gamma x)=\Nm(\gamma)N_\scrI(x)
\end{equation}
for all $x \in \scrI(U)$ and $\gamma \in \scrO_Y(U)$ on open $U \subseteq X$, matching Kneser \cite{Kneser}*{section 4}. The norm map arises from a twist of the \defi{canonical exterior form}, the unique quadratic map
\begin{equation} 
E_\scrI \colon \scrI \otimes \scrO_Y/\scrO_X \to \tbigwedge^2 \scrI \otimes \scrO_Y/\scrO_X
\end{equation}
such that $E_\scrI(x \otimes \gamma) = (\gamma x \wedge x) \otimes \gamma$ for all $x \in \scrI(U)$ and $\gamma \in (\scrO_Y/\scrO_X)(U)$.  After appropriate identifications and (perhaps a bit surprisingly) a duality, we show this agrees with the construction of Wood \cite{Wood}*{Theorem 2.1} in \cref{sec:wood}.

\subsection{Similarity classes}

Our first theorem corresponds to the reductive group $\GSO$.

\begin{thm}{\label{Main Thm GSO}}
The Clifford and norm functors define a discriminant-preserving equivalence of categories fibered over $\catQuad$ between 
\begin{center}
$\scrO_Y$-oriented binary quadratic $\scrO_X$-modules under oriented similarities
\end{center}
and
\begin{center}
pseudoregular $\scrO_Y$-modules under $\scrO_Y$-module isomorphisms.
\end{center}
\end{thm}

In particular, the Clifford and norm are quasi-inverse functors; and if $\scrM \leftrightarrow \scrI$ in the equivalence then we have an isomorphism of group schemes $\GSO(\scrM) \simeq \Aut_{\scrO_Y}(\scrI)$ over $X$. Note that free objects correspond to each other in the two categories above, indeed there are universal framed objects.

We say a quadratic $\scrO_X$-module is \defi{primitive} if the values of $Q$ generate $\scrL$ on every open.  The restriction to primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-modules under oriented similarities gives an equivalence to invertible (i.e., locally principal) $\scrO_Y$-modules under $\scrO_Y$-module isomorphisms (\Cref{primitive = invertible}): in particular, the isomorphism class of $\Clf^1(Q)$ as a $\scrO_Y$-module gives a well-defined element of $\Pic(Y)$.  
We obtain following corollary.  

\begin{cor} \label{GSO class =Pic Y}
Let $\calO_Y$ be a quadratic $\calO_X$-algebra. Then the Clifford and norm functors define mutually inverse bijections between the set of oriented similarity classes of primitive $\calO_Y$-oriented binary quadratic $\calO_X$-modules and the group $\Pic Y$.  
\end{cor}

\Cref{GSO class =Pic Y} provides, for each $\scrO_Y$, a composition law on the set of oriented similarity classes of primitive binary quadratic modules.  Gauss composition becomes the special case $X=\Spec \Z$: the choice of orientation is implicit in the ordered choice of basis in which the binary quadratic form is expressed, and treats the real and imaginary cases uniformly (see \Cref{exm:classical}). 

Although Wood \cite{Wood} did not make it explicit, other authors \cites{O'Dorney,Dallaporta,Mondal} have adapted her equivalence of categories to provide a composition law as in \Cref{GSO class =Pic Y} using a notion of orientation that differs from ours: see the next section and \cref{sec:contribution} for a comparison.

Forgetting orientations, we have the following theorem, corresponding to the reductive group $\GO$.

\begin{cor}{\label{Main Thm GO}}
The Clifford and norm functors define a discriminant-preserving equivalence of categories between 
\begin{center}
binary quadratic $\scrO_X$-modules under similarities
\end{center}
and
\begin{center}
pseudoregular modules over quadratic $\calO_X$-algebras under isomorphisms.
\end{center}

In particular, they furnish mutually inverse bijections between the set of similarity classes of primitive binary quadratic $\calO_X$-modules and $\Pic(Y)/\Aut_{\calO_X}(\calO_Y)$.  
\end{cor}

Mondal--Venkata Balaji \cite{Mondal}*{Theorem 3.1, Theorem 5.11} also prove a version of \Cref{Main Thm GO} (bijections without the equivalence of categories), and instead of constructing an explicit norm functor they apply the theory of \emph{universal norms}.  Classically, \Cref{Main Thm GO} describes $\GL_2(\Z)$-equivalence, whose classes correspond to the quotient of the class group by inversion.  Unfortunately, having lost the orientation, we lose the group structure and therefore the composition law.

\subsection{Similitude classes} \label{sec:simlattices}

In the study of quadratic modules, often the value line bundle is fixed.  For example, the more basic notion of a \defi{quadratic form} corresponds to the case where the value line bundle is trivial, $\scrL=\scrO_X$.  

Accordingly, we define a \defi{similitude} between $Q \colon \scrM \to \scrL$ and $Q' \colon \scrM' \to \scrL'$ to be a similarity with $\scrL=\scrL'$; its \defi{similitude factor} is $\lambda \in \scrO_X(X)^\times$.  In this way, the similitude class of a binary quadratic module remembers the value line bundle (not just up to isomorphism); therefore the category of binary quadratic modules under similitudes is fibered over $\catPic$, the category of invertible modules over schemes under isomorphisms.  

The rigidification provided by this additional data is accounted for in the Clifford functor, as follows: a ($\scrL$-)\defi{rigidification} of $\scrI$ is an isomorphism $r \colon \scrN(\scrI) \xrightarrow{\sim} \scrL$. Wood \cite{Wood}*{section 5} calls this an \emph{$\scrL$-type orientation}, but we avoid that name to distinguish it from the orientation defined above.  Since $\scrN(\scrI) = \tbigwedge^2 \scrI \otimes (\scrO_Y/\scrO_X)^\vee$, given an $\scrO_Y$-orientation, a $\scrL$-rigidification of $\scrI$ canonically determines an isomorphism $\tbigwedge^2 \scrI \xrightarrow{\sim} \scrL \otimes (\scrO_Y/\scrO_X)$ and conversely.  From a rigidification $r$ of $\scrI$, we define the \defi{modified norm map} by $r \circ N_{\scrI}$.  

\begin{thm}{\label{Main Thm sim}}
The Clifford and modified norm functors define a discriminant-preserving equivalence of categories fibered over $\catQuad \times_{\catSch} \catPic$ between 
\begin{center}
$\scrO_Y$-oriented binary quadratic $\scrO_X$-modules under oriented similitudes 
\end{center}
and
\begin{center}
rigidified pseudoregular $\scrO_Y$-modules under $\scrO_Y$-module isomorphisms 
\end{center}
\end{thm}

\begin{cor}
    The Clifford and modified norm functors furnish mutually inverse bijections between the set of similitude classes of primitive binary quadratic $\calO_X$-modules with value line bundle $\scrL$ and the fiber of the map
\begin{equation} 
\begin{aligned}
\Pic Y &\to \Pic X \\
\scrI &\mapsto \scrN(\scrI)
\end{aligned} 
\end{equation}
over $[\scrL] \in \Pic X$.
\end{cor}

Similarly, as in \Cref{Main Thm GO} we may forget orientations, corresponding to the further quotient by $\Aut_{\calO_X}(\calO_Y)$ in \Cref{Main Thm sim}.

\subsection{Isometry classes} \label{sec:isomlattices}

Having fixed the line bundle, we may now restrict similarities according to their similitude factor; this opens the door to generalizing a key aspect of Gauss composition, where $\SL_2(\Z)$-classes of \emph{indefinite} binary quadratic forms are in bijection with the \emph{narrow} class group of a real quadratic field.  This is nicely explained by restricting the group of similitude factors, leading to the orthogonal groups $\SO$ and $\Orthogonal$.  

An \defi{isometry} is a similitude with similitude factor $\lambda=1$.  If $\scrI, \scrI'$ are rigidified $\scrO_Y$-modules, we say that an $\scrO_Y$-module isomorphism $\varphi \colon \scrI \to \scrI'$ is \defi{rigidified} if the induced isomorphism $\scrN(\scrI)\to \scrN(\scrI')$ commutes with the rigidifications. 

\begin{thm}{\label{Main Thm SO}}
The Clifford and norm functors define a discriminant-preserving equivalence of categories fibered over $\catQuad \times_{\catSch} \catPic$ between 
\begin{center}
$\scrO_Y$-oriented binary quadratic $\scrO_X$-modules under oriented isometries
\end{center}
and
\begin{center}
rigidified pseudoregular $\scrO_Y$-modules under rigidified $\scrO_Y$-module isomorphisms.
\end{center}
\end{thm}

These similarly yield corollaries in the vein of Gauss composition, as follows.  Over a fixed base, we may work a bit more generally.  More generally, let $H \leq \scrO_X(X)^\times$ be a subgroup; an \defi{$H$-similitude} is a similitude whose similitude factor lies in $H$.  There is a canonical isomorphism $\Pic Y \cong H^1(Y,\scrO_Y^\times)$.  Let $\scrO_Y^1 \colonequals  \ker( \Nm \colon \scrO_Y^\times \to \scrO_X^\times)$.  Considering $H \leq \scrO_X(X)^\times$ as a constant subsheaf, let $\scrO_Y^{(H)} \colonequals \Nm^{-1}(H)$ and define $\Pic^{(H)} Y \colonequals H^1(Y,\scrO_Y^{(H)})$.  The map $\scrO_Y^{(H)} \to \scrO_Y^\times$ induces a natural map $\Pic^{(H)} Y \to \Pic Y$.  

\begin{cor} \label{H-similitude class = Pic H}
Let $\scrO_Y$ be a quadratic $\scrO_X$-algebra.  Then for all $H \leq \scrO_X(X)^\times$, the Clifford and norm functors define bijections between the set of oriented $H$-similitude classes of primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-modules and the group $\Pic^{(H)} Y$.  
\end{cor}

For example, if $K \supseteq F$ is a quadratic extension of number fields with corresponding maps on integral spectra $Y=\Spec \Z_K \to X=\Spec \Z_F$, then we may take $H=\Z_{F,>0}^\times$ to be the subgroup of units that are positive at all real places of $F$, and then $\Pic^{(H)}(Y)$ is the narrow class group of $\Z_K$.  In particular, if $F=\Q$ and $K$ is real quadratic, then we recover Gauss composition for the narrow class group (see \cref{exm:narrowclass}).  

Of course we have similar notions where we forget $\scrO_Y$-orientations, corresponding to the group $\Orthogonal$.

\subsection{Lattices} \label{sec:lattices}

An important special case of the above theorems arises as follows.  Take $X=\Spec R$ with $R$ a Dedekind domain in the above (for example, $R=\Z$).  Let $F \colonequals \Frac R$ be the field of fractions of $R$.  Let $Q \colon V \to F$ be a nondegenerate binary quadratic form and let $K \colonequals \Clf^0(Q)$ be its even Clifford algebra, a quadratic $F$-algebra.  Then \Cref{Main Thm GSO} and \Cref{GSO class =Pic Y} specialize to the following statement.

\begin{cor}
Clifford and norm define mutually inverse discriminant-preserving bijections between the set of similarity classes of $R$-lattices in $V$ and the set of invertible ideal classes for quadratic orders $S \subseteq K$.  In particular, there is a bijection between the set of similarity classes of $R$-lattices $M \subset V$ with multiplicator ring $S$ and the group $\Pic S$.  
\end{cor}

This corollary bears mention first because the orientations have disappeared: this is because every $R$-lattice has a canonical $S$-orientation, obtained by restricting the tautological orientation $\Clf^0(Q) = K$ on $V$.  The value line bundle has also disappeared, taken to be the fractional ideal generated by the values of the quadratic form on the lattice (so by construction, every quadratic module is primitive).  And if we restrict to isometries then we obtain a bijection with the infinite group $\Pic^{(1)} S$, the group of fractional ideals of $S$ modulo principal ideals of norm $1$ (from $K$ to $F$).  

\subsection{Contribution} \label{sec:contribution}

The first contribution of this paper is to synthesize the work of Kneser \cite{Kneser} and Wood \cite{Wood}.  Kneser approaches composition laws via the even Clifford algebra and the norm without a categorical equivalence, whereas Wood provides a categorical equivalence and geometric approach without a composition law and without Clifford and the norm.  Our theorems combine and recover their results.  In particular, we show that the functor defined by Wood is naturally isomorphic to the norm functor composed with a duality by showing there is a unique such functor which restricts to the usual norm.  For further context on other related work, see \cref{recent work}.  As a consequence, by viewing Gauss composition over an arbitrary base through the Clifford functor, we can see it as just one instance of the beautiful exceptional isomorphisms of Lie groups in low rank $n$ \cite{bookofinv}*{\S 15}: indeed this paper fills in a gap in the cases $n=1$ and $n=3$ considered by Voight \cites{Voight:quadmonoid,Voight:quatring}.  

Our second contribution is to center the quartet of orthogonal groups $\GSO,\GO,\SO,\Orthogonal$.  This identifies Wood's \emph{linear binary quadratic forms} under the action of $\GL_1 \times \GL_2$ as binary quadratic forms under similarity.  Previous work does not address the role of the narrow class group in Gauss composition; we see it here as arising from oriented isometries.  

Third, this paper reconciles notions of orientation.  Our approach follows Kneser who calls it \emph{$C$-type} \cite{Kneser}*{section 4}; this notion also appears in Knus--Merkurjev--Rost--Tignol \cite{bookofinv}*{Definition (12.40)} in the case of odd dimension over a field and in Auel \cite{Auel11}*{1.10} in the \'etale case.  This solves the problems caused by the standard involution on the quadratic algebra necessary to get a composition law, noticed by other authors.  This notion of orientation seems particularly well-suited to this task: the set of $\scrO_Y$-orientations on a binary quadratic module form a torsor under $\Aut_{\scrO_X}(\scrO_Y)$, so for example if $Y \to X$ is \'etale and $X$ is connected, then $\Aut_{\scrO_X}(\scrO_Y) \simeq \Z/2\Z$.  By contrast, the set of rigidifications (or equivalently the set of determinant structures) is a torsor for $\G_m(X)=\scrO_X(X)^\times$, and this is a bit of overengineering in resolving the ambiguity caused by the standard involution.  We view the role of the even Clifford algebra (and more generally the universal Clifford center) as a refinement of the discriminant and therefore a natural invariant to isolate.  

Next, we generalize Wood's notion of \emph{traceable} to \emph{pseudoregular}; this notion (but without the name) was also studied in the work of Voight \cite{Voight:quatring}, following Gross--Lucianovic \cite{GL} and Bhargava \cite{Bhargava2}.  We identify pseudoregularity as a general property of the Clifford functor in arbitrary rank via the formation of the \emph{universal Clifford center}: see \cref{sec:univclifcenter}.

Finally, the elaboration of the theory in the case of lattices over a domain makes it especially well-suited for our intended application: to understand (and compute with) spaces of orthogonal modular forms as algebraic modular forms as well as their relationship to Hecke quasicharacters (and then Hilbert modular forms), see \cref{sec:algmodform}.

\subsection{Contents}
In \cref{sec:setup}, we give terminology and notation for quadratic modules, universal framed objects, Clifford algebras. In \cref{sec:pseudo}, we explore pseudoregular modules and show functorial properties of the Clfford map. In \cref{sec:dor}, we discuss discriminants, orientations via the universal Clifford center, and rigidifications (and compare to determinant structures). In \cref{sec:norms}, we define a norm functor and compare to Wood's result. In \cref{sec:finishproof}, we prove the main theorem and derive its corollaries. Finally, in \cref{sec:litreview}, we discuss the application to orthogonal modular forms, derive the connections to genera and class sets, and review recent work generalizing Gauss composition. 

\subsection{Acknowledgements}

The authors would like to thank Eran Assaf, Asher Auel, and Melanie Matchett Wood for helpful conversations.  Voight was supported by Simons Foundation grants 550029 and SFI-MPS-Infra\-structure-00008650. Wu was partially supported by National Science Foundation DMS-2200845 and DMS-2401601.

\section{Background} \label{sec:setup}

We begin with a bit of background and setup.  For further reading, see Voight \cite{Voight:quadmonoid}, Bischel--Knus \cite{BK}, and Auel \cite{Auel15}.

\subsection{Quadratic modules and algebras} \label{sec:quadmodules}

Let $X$ be a scheme. A \defi{quadratic $\scrO_X$-module} is a triple $(\scrM, \scrL, Q)$ where $\scrM$ is a locally free $\scrO_X$-module of finite rank, $\scrL$ is an invertible $\scrO_X$-module, and $Q\colon \scrM\to\scrL$ is a \defi{quadratic map}: for all open sets $U\subseteq X$, we have 
\begin{enumerate}[label={\textup{(\roman*)}}]
    \item $Q(rx)=r^2Q(x)$ for all $r\in\scrO_X(U)$ and $x\in \scrM(U)$;  and
    \item The map $T\colon \scrM(U)\times \scrM(U)\to\scrL(U)$ defined by $T(x,y)=Q(x+y)-Q(x)-Q(y)$ for $x,y\in\scrM(U)$ is $\scrO_X(U)$-bilinear.
\end{enumerate}
We call $T \colon \scrM \times \scrM \to \scrL$ the \defi{associated bilinear form}; we often just write $Q \colon \scrM \to \scrL$ for the triple $(\scrM,\scrL,Q)$ and refer to it as a quadratic module. 

By $\Sym^k \scrM$ we mean the usual quotient of $\scrM^{\otimes k}$ and by $\Sym_k \scrM$ we mean the usual submodule.  By definition, a quadratic $\scrO_X$-module is a global section of the sheaf 
\begin{equation} \label{eqn:sym2sym2}
(\Sym_2 \scrM)^\vee \otimes \scrL \cong \Sym^2 (\scrM^\vee) \otimes \scrL.
\end{equation}
Concisely put, the isomorphism is defined by pullback under the natural projection $\Sym_2 \scrM \to \Sym^2 \scrM$.

A \defi{similarity} between two quadratic modules $Q\colon\scrM\to\scrL$ and $Q'\colon \scrM'\to\scrL'$ is a pair of $\scrO_X$-module isomorphisms $\varphi\colon\scrM\to\scrM'$ and $\lambda\colon\scrL\to\scrL'$ such that $Q'\circ \varphi=\lambda \circ Q$, i.e., the diagram
\begin{equation} \label{eqn:commdiag}
\begin{tikzcd}
	\scrM & \scrL \\
	\scrM' & \scrL'
	\arrow["{Q}", from=1-1, to=1-2]
	\arrow["{\varphi}", swap, from=1-1, to=2-1]
	\arrow["{Q'}", from=2-1, to=2-2]
	\arrow["{\lambda}", from=1-2, to=2-2]
\end{tikzcd}
\end{equation}
commutes.  A \defi{similitude} is a similarity with $\scrL=\scrL'$, and an \defi{isometry} is a similitude with $\lambda=\id$, i.e.,
\begin{equation} \label{eqn:commdiag_isom}
\begin{tikzcd}[
  row sep={0.5ex}
]
	\scrM &  \\
    & \scrL \\
	\scrM' & 
	\arrow["{Q}" pos=0.3, from=1-1, to=2-2]
	\arrow["{\varphi}", swap, from=1-1, to=3-1]
	\arrow["{Q'}" pos=0.3, swap, from=3-1, to=2-2]
\end{tikzcd}
\end{equation}
When $Q=Q'$, then the self-similitudes and self-isometries form groups (indeed group schemes). 

A \defi{quadratic $\scrO_X$-algebra} is an $\scrO_X$-algebra (with $1$) that is locally free of rank $2$ as an $\scrO_X$-module.  Equivalently, a quadratic $\scrO_X$-algebra is given by $\scrO_Y$ where $Y \to X$ is a locally free morphism of degree $2$.  Let $\scrO_Y$ be a quadratic $\scrO_X$-algebra.  Then there is a unique \defi{standard involution} $\sigma$ on $\scrO_Y$.  The \defi{discriminant} of $\scrO_Y$ is the quadratic map $d \colon (\tbigwedge^2 \scrO_Y)^{\otimes2}\to \scrO_X$ defined by $d((x\wedge y)\otimes(z\wedge w))=(x\sigma(y)-\sigma(x)y)(z\sigma(w)-\sigma(z)w)$ for all $x,y,z,w \in \scrO_Y(U)$ with $U \subseteq X$ open \cite{Voight: quadmonoid}*{Proposition 3.13}.

Since the objects (e.g., quadratic modules or algebras) we work with are usually locally free, we usually choose trivilizations so that we can work in coordinates. We will often consider universal framed objects over the universal coordinate ring $R$ which represents the moduli of framed data.

A \defi{framed $\scrO_X$-module} of rank $m$ over $\scrO_X$ is a tuple $(\scrM, \beta)$ where $\scrM=\scrO_X e_1 \oplus \dots \oplus \scrO_X e_m$ is a free $\scrO_X$-module with (ordered) basis $\beta=\{e_1,\ldots, e_m\}$.  A \defi{framed quadratic $\scrO_X$-module} is a quadratic module $Q \colon \scrM \to \scrL$ where $\scrM$ and $\scrL$ are framed (of ranks $m$ and $1$, respectively).  An isomorphism of framed quadratic $\scrO_X$-modules is a similarity which preserves the framing.  The automorphism group of a framed quadratic $\scrO_X$-module is therefore trivial.  

We define a functor $\Qfr \colon  \catSch^{\textup{op}} \to \catSet$
which assigns to each scheme $X$ the set of isomorphism classes of framed quadratic $\scrO_X$-modules of rank $m$ under isometries preserving the framing and assigns to a morphism of schemes $f\colon X'\to X$ the pullback along $f$.

\begin{lem}\label{lem: universal quadratic form}
    Let $R \colonequals \Z[a_{ij}]_{1\leq i\leq j\leq m}$ be a polynomial ring in $m(m+1)/2$ variables over $\Z$.  Then functor $\Qfr$ is represented by $Z=\Spec(R)$, with universal object is 
\begin{equation} \label{eqn:univquad}
\begin{aligned}
Q \colon \scrO^m_Z &\to \scrO_Z \\
Q(x_1,\dots,x_m) &= \sum_{1 \leq i \leq j \leq m} a_{ij} x_i x_j.
\end{aligned}
\end{equation}
\end{lem}

\begin{proof}
Over any scheme $X$, a framed quadratic form $Q \colon \scrM \to \scrL$ with $\beta=e_1,\dots,e_m$ an $\scrO_X$-basis for $\scrM$ and $\scrL=\scrO_X g$ is uniquely determined by the values $a_{ii}=Q(e_i)g$ for $i=1,\dots,m$ and $a_{ij}=(Q(e_i+e_j)-Q(e_i)-Q(e_j))g$ with $1 \leq i \leq j \leq m$.
\end{proof}

In particular, framed binary quadratic modules are parametrized by $\mathbb{A}^3_{\mathbb{Z}}$ in the familiar way.

\subsection{Clifford map}

For an invertible $\scrO_X$-module $\scrL$ (equivalently, locally free $\calO_X$-module of rank $1$), we define $\scrL^\vee\colonequals \HHom_{\scrO_X}(\scrL,\scrO_X)$. 

Let $Q \colon \scrM \to \scrL$ be a quadratic $\scrO_X$-module.  We define the \defi{even tensor $\scrO_X$-algebra} by 
\begin{equation}
\TTen^0(\scrM;\scrL)\colonequals\displaystyle\bigoplus_{d=0}^{\infty}(\scrM\otimes\scrM\otimes\scrL^\vee)^{\otimes d}.
\end{equation}
Let $\scrJ^0(Q)$ be the two-sided ideal of $\TTen^0(\scrM;\scrL)$ defined over $U \subseteq X$ open by
\begin{equation}
\begin{aligned}
&\langle x\otimes x\otimes f-f(Q(x)) : x \in \scrM(U), f \in \scrL^\vee(U) \rangle \\
&\quad + \langle x\otimes y\otimes y \otimes z\otimes f\otimes g-f(Q(y))\, x\otimes z\otimes g : x,y,z \in \scrM(U), f,g \in \scrL^\vee(U) \rangle.
\end{aligned}
\end{equation}
We define the \defi{even Clifford algebra} of $Q$ to be the quotient 
\begin{equation}
\Clf^0(Q)\colonequals\TTen^0(\scrM;\scrL)/\scrJ^0(Q).
\end{equation}

\begin{prop}
The even Clifford map defines a functor between 
\begin{center}
quadratic $\scrO_X$-module under similarities
\end{center}
and
\begin{center}
$\scrO_X$-algebras under $\scrO_X$-algebra isomorphisms.
\end{center}
\end{prop}

\begin{proof}
See Auel \cite{Auel15}*{Proposition 1.2} and for a slightly different but equivalent construction using the Rees algebra, see Bichsel--Knus \cite{BK}*{\S 3}.
\end{proof}

\begin{example}\label{binary even cliff mod O_X}
\label{binarycliff}
    In the binary case, we have a canonical isomorphism
    \[ \Clf^0(Q)/\calO_X \cong \tbigwedge^2 \scrM \otimes \scrL^{\vee}\]
    as $\calO_X$-modules.  
    
    If $X=\Spec R$ is affine with $S=\Clf^0(Q)$, then we get a noncanonical splitting
    \[ S \simeq R \oplus S/R \simeq R \oplus (\tbigwedge^2 M \otimes L^\vee). \]
    See Voight \cite{Voight:quadmonoid}*{Lemma 3.2, Remark 3.3} for further freeness comments.
\end{example}

Let 
\begin{equation}
\TTen^1(\scrM;\scrL)\colonequals\displaystyle\bigoplus_{\substack{d=1\\d \text{ odd}}}^\infty\scrM^{\otimes d}\otimes (\scrL^{\vee})^{\otimes \lfloor d/2 \rfloor}.
\end{equation}
Then $\TTen^1(\scrM;\scrL)$ is a graded $\TTen^0(\scrM;\scrL)$-bimodule under the tensor multiplication law. Let $\scrJ^1(Q)$ be the $\TTen^0(\scrM;\scrL)$-sub-bimodule of $\TTen^1(\scrM;\scrL)$ defined over $U\subseteq X$ open by 
\begin{equation}
    \begin{aligned}
     \langle x\otimes x \otimes y\otimes f-f(Q(x))y, y\otimes x\otimes x\otimes f-f(Q(x))y: x,y\in \scrM(U), f\in\scrL^{\vee}(U)\rangle.
    \end{aligned}
\end{equation}
 We define the \defi{odd Clifford bimodule} of $Q$ to be the quotient
\begin{equation}
 \Clf^1(Q)\colonequals\TTen^1(\scrM;\scrL)/\scrJ^1(Q).
\end{equation}
Then under the natural multiplication, $\Clf^1(Q)$ has the structure of a $\Clf^0(Q)$-bimodule.  Its formation is also functorial, but we first characterize a key property in the next section.  

\section{Pseudoregularity} \label{sec:pseudo}

In this section, we explore modules which from the point of view of characteristic polynomials look like the regular module (affording the regular representation).  We then show this holds for the odd Clifford bimodule over the even Clifford algebra.  

\subsection{Pseudoregular modules}

We first work locally.  Let $R$ be a commutative ring (with $1$).  Let $A$ be an $R$-algebra (with $1$, not necessarily commutative) that is free of rank $n$ as an $R$-module.  Left multiplication defines an $R$-algebra homomorphism
$\lambda_A \colon A \to \End_R(A) \simeq \M_n(R)$, called the \defi{(left) regular representation} of $A$ (over $R$).  We obtain for each $\alpha \in A$ a (left) characteristic polynomial $c_A(\alpha;T)=\det(T-\lambda_A(\alpha)) \in R[T]$.  

Now let $I$ be a left $A$-module.  We say that $I$ is \defi{$R$-rank balanced} if $I$ is also free of rank $n$ as an $R$-module.  

Suppose that $I$ is $R$-rank balanced.  Then again the left $A$-module structure on $I$ yields an $R$-algebra homomorphism $\lambda_I \colon A \to \End_R(I) \simeq \M_n(R)$ and $c_I(\alpha;T) \in R[T]$.  

\begin{definition} \label{defn:pseudoregular_affine}
We say $I$ is $(R,A)$-\defi{pseudoregular} if $I$ is $R$-rank balanced and for all $\alpha \in A$ we have $c_A(\alpha;T)=c_I(\alpha;T)$.  
\end{definition} 

The name is justified as $I$ looks like the regular representation of $A$ from the point of view of the numerical data encoded in characteristic polynomials over $R$.  When clear from context, we will often drop the prefix $(R,A)$ and say simply that $I$ is pseudoregular.

\begin{remark}
One could extend \Cref{defn:pseudoregular_affine} to the case where $M$ is a left $A$-module that is free $R$-module of rank $nd$ with $d \geq 1$ and ask that $c_M(x;T)=c_A(x;T)^d$.  
\end{remark}

\begin{lem} \label{lem:Ifreepseudo}
The following statements hold.
\begin{enumalph}
\item If $I$ is free as an $A$-module, then $I$ is pseudoregular.  
\item If $R \to R'$ is a flat ring homomorphism and $I \otimes_{R} R'$ is $(R',A \otimes_{R} R')$-pseudoregular, then $I$ is $(R,A)$-pseudoregular.  
\item If $A$ is a (commutative) domain, then $I$ is pseudoregular.  
\end{enumalph}
\end{lem}

\begin{proof}
For part (a), writing $I=Ae$, an $R$-basis $\beta$ for $A$ yields $\beta e$ an $R$-basis for $I$, and accordingly $[\lambda_A(\alpha)]_\beta=[\lambda_I(\alpha)]_{\beta e}$ so in particular $c_A(\alpha;T)=c_I(\alpha;T)$.  

For (b), let $I' \colonequals I\otimes_{R} R'$ and $A' \colonequals A\otimes_{R} R'$. For $\alpha \in A$, since $R \to R'$ is flat, then 
\begin{equation}
\begin{aligned}
c_{I'}(\alpha;T)&=\det(T-\lambda_{I'}(\alpha))=\det(T-\lambda_{I'}(\alpha)\otimes_R1) \\
&=\det(T-\lambda_{I'}(\alpha))\otimes_R1=c_I(x;T)\otimes_R1\in R'[T]. 
\end{aligned}
\end{equation}
Similarly, we have $c_{A'}(\alpha;T)=c_A(\alpha;T)\otimes_R1$. By pseudoregularity we have $c_{I'}(\alpha;T)=c_{A'}(\alpha;T)$, and we conclude that $I$ is $(R,A)$-pseudoregular by flatness. 

For (c), apply (b) with the map $R \to F$, we see that $A \otimes_R F$ is a field so $I \otimes_R F$ is free.
\end{proof}

\begin{exm} \label{exm:faith}
Let $A \colonequals R \times R$, let $\frakp=R \times \{0\}$ and let $I \colonequals A/\frakp \oplus A/\frakp \simeq R \oplus R$.  Then $\rk_R A = \rk_R I = 2$, but $I$ is not pseudoregular because $\alpha=(a,b)$ has $c_A(\alpha;T)=(T-a)(T-b)$, but $c_I(\alpha;T)=(T-b)^2$.  Indeed, $I$ is not faithful as an $A$-module, as $(1,0)$ annihilates $I$.
\end{exm}

\begin{exm}
Let $A = \M_2(R)$ and $I=R^2 \oplus R^2$, with action $\alpha \cdot (v,w) = (\alpha v, 0)$.  Then $c_A(\alpha;T)=\det(T-\alpha)^2$ but $c_I(\alpha;T)=\det(T-\alpha)T^2$, so $I$ is not pseudoregular and $I$ is faithful as an $A$-module.
\end{exm}

We now define the global notion.  First, if $A$ is a \emph{locally} free $R$-algebra of rank $n$ and $I$ is an $S$-module which is locally free of rank $n$ as an $R$-module, then we again have (uniquely defined) characteristic polynomials, so we just repeat \Cref{defn:pseudoregular_affine}.  

Finally, let $X$ be a scheme, let $\scrA$ be a locally free $\calO_X$-algebra.  Let $\scrI$ be an $\scrA$-module which is locally free of rank $n$ as a $\scrO_X$-module.  

\begin{definition}
We say $\scrI$ is $(\scrO_X,\scrA)$-\defi{pseudoregular} if there exists an affine open cover $X=\bigcup_i U_i$ such that $\scrI(U_i)$ is $(\scrO_X(U_i),\scrA(U_i))$-pseudoregular for all $i$. 
\end{definition}

It is straightforward to check that $\scrI$ is pseudoregular if and only if for all affine open $U \subseteq X$ we have $\scrI(U)$ is pseudoregular. 

We make similar definitions for right modules and for bimodules (pseudoregular as both a left and right module).

\begin{prop} \label{prop:cliffpseudo}
$\Clf^1(Q)$ is pseudoregular as a $\Clf^0(Q)$-bimodule.  
\end{prop}

\begin{proof}
We first work universally, using the universal framed quadratic module $Q$ \eqref{eqn:univquad}.  Let $S \colonequals \Clf^0(Q)$ and $I \colonequals \Clf^1(Q)$ be the resulting (universal) framed even Clifford algebra and odd Clifford bimodule.  Let $\xi \colonequals \sum_{1 \leq i \leq j \leq n} z_{ij} e_i e_j \in R' \colonequals R[z_{ij}]_{i,j}$ be the universal element of $S$.  Let $S' \colonequals S \otimes_R R'$ and similarly $I'$.  We claim that $I'$ is $(R',S')$-pseudoregular.  Indeed, since $R'$ is a domain, by \Cref{lem:Ifreepseudo}(b) it is enough to check this over $F' \colonequals \Frac R'$.  But then $I'$ is free over $S'$ with basis $e_1$ (essentially since $e_1^2=a_{11} \in (F')^\times$), so the claim follows from \Cref{lem:Ifreepseudo}(a).  In particular, we get that
\begin{equation} \label{csI:univ}
c_{S'}(\xi;T) = c_{I'}(\xi;T) \in R'[T]. 
\end{equation}

Now for the general case.  As the notion is local, we reduce to the case of an affine cover where the objects are free.  So let $Q \colon M \to L$ be a quadratic module with $M = R^n$ and $L=R$.  Let $S \colonequals \Clf^0(Q)$ and $I \colonequals \Clf^1(Q)$, and let $\alpha \in S$; we want to show that $c_{S}(\alpha;T)=c_{I}(\alpha;T)$.  But $Q$ and $\alpha$ are specializations of the universal quadratic form and $\xi$ under a unique ring homomorphism by \Cref{lem: universal quadratic form}, so the result follows by specializing \eqref{csI:univ}.
\end{proof}

\begin{prop} \label{prop:oddcliff}
The association of the odd Clifford bimodule over the even Clifford algebra defines a functor between 
\begin{center}
quadratic $\scrO_X$-modules under similarities
\end{center}
and
\begin{center}
pseudoregular bimodules over $\calO_X$-algebras under semilinear module isomorphisms.
\end{center}
\end{prop}

\begin{proof}
See \cite{Auel15}*{Proposition 1.5} together with \Cref{prop:cliffpseudo}.  
\end{proof}

\begin{prop}\label{Clif functor similarity}
The association $Q\to (\Clf^0(Q),\Clf^1(Q))$ gives a functor fibered over $\catSch$ from the category  
\begin{center}
quadratic $\scrO_X$-modules under similarities
\end{center}
to the category 
\begin{center}
pairs $(\scrA,\scrI)$ where $\scrA$ is a locally free $\scrO_X$-algebra and $\scrI$ is a pseudoregular $\scrA$-bimodule \\  under semilinear module isomorphisms.
\end{center}
\end{prop}

\begin{proof}
It is clear from the Clifford construction that objects go to objects in the above, with pseudoregularity implied by \Cref{prop:cliffpseudo}. The functorial properties in \cite{Auel11}*{Section 4} shows the fact that similarites associate to similinear module isomorphisms between pairs $(\scrA, \scrI)$.
\end{proof}

\subsection{Quadratic pseudoregular modules}

We now specialize to the quadratic case, first exhibiting a universal object.

Indeed, we similarly consider framed objects for $\scrO_X$-algebras and pseudoregular modules over them.  A \defi{framed unital $\scrO_X$-algebra} is an $\scrO_X$-algebra with a framing $\beta$ such that $\beta_1=1$.  

A $\scrO_X$-rank balanced $\scrO_Y$-module $\scrI$ is \defi{framed} if both $\scrO_Y$ and $\scrI$ are framed.  An isomorphism of $\scrO_X$-rank balanced modules is an isomorphism of modules which preserves the framing: more precisely, a pair $(\varphi,\psi)$ where $\varphi \colon \scrO_Y \to \scrO_{Y'}$ is an $\scrO_X$-algebra isomorphism preserving framings and $\psi \colon \scrI \to \scrI'$ a $\varphi$-semilinear module isomorphism that also preserves framings. 

Let $\scrI$ be a framed quadratic $\scrO_X$-rank balanced module, with $1,\gamma$ an $\scrO_X$-basis for $\scrO_Y$ and $e_1,e_2$ a $\scrO_X$-basis for $\scrI$.  Then $\gamma^2-t\gamma+n=0$ with $t,n \in \scrO_X(X)$ and the matrix of $\gamma$ in the given basis is of the form $\begin{pmatrix} a & c \\ b & d \end{pmatrix}$ with $a,b,c,d \in \scrO_X(X)$.  Following Wood \cite{Wood}*{proof of Theorem 2.1}, replacing $\gamma \leftarrow \gamma-d$, we see that we can arrange $d=0$.  But then following Gross--Lucianovic \cite{GL} and Voight \cite{Voight:quatring}, we say that $e_1,e_2$ is a \defi{good basis} for $\scrI$ (over $\scrO_Y$) and altogether they give a \defi{good frame}.

\begin{example}
For a framed binary quadratic module with form $ax^2+bxy+cy^2$, we have $\Clf^0(Q)=\scrO_X \oplus \scrO_X e_1 e_2$ and $\Clf^1(Q)=\scrO_X e_1\oplus \scrO_X e_2$, and this is a good frame: we have $(e_1e_2)e_1 = e_1(b-e_1e_2)=be_1 - ae_2$ and $(e_1e_2)e_2=ce_1$ so $[e_1e_2]=\begin{pmatrix} b & -a \\ c & 0 \end{pmatrix}$. 
\end{example}

We define a functor $\Pfr\colon \catSch^{\textup{op}} \to \catSet$ which assigns to each scheme $X$ the set of isomorphism classes of good framed quadratic $\scrO_X$-rank balanced modules, and to a morphism assigns the pullback.  

\begin{lem}\label{lem: universal quadratic algebra}
    Let $R \colonequals \Z[a,b,c,t,n]/(t-a, n+bc) \simeq \Z[a,b,c]$. Then the functor $\Pfr$ is represented by $Z=\Spec(R)$, with universal object $\scrI=\scrO_X e_1 \oplus \scrO_X e_2$ over $\scrO_Y=\scrO_X \oplus \scrO_X \alpha$ satisfying $\alpha^2-t\alpha+n=0$ and acting by $[\alpha]=\begin{pmatrix} a & b \\ c & 0 \end{pmatrix}$.     
\end{lem}

\begin{proof}
As in the setup of Wood \cite{Wood}*{Proof of Theorem 1.4}, there are no automorphisms of a good framed quadratic rank-balanced quadratic module, and it is uniquely determined by the data $t,n,a,b,c$ by linearity; the relations come from the fact that the characteristic polynomial matches, so $a=t$ and $n=-bc$.
\end{proof}

Indeed, in the quadratic case one only needs to check traces, as follows.

\begin{lem} \label{lem:traceable}
Let $\scrO_Y$ be a quadratic $\scrO_X$-algebra and let $\scrI$ be an $\scrO_Y$-module which is locally free of rank $2$ as an $\scrO_X$-module.  Then $\scrI$ is pseudoregular if and only if for all open $U \subseteq X$ and all $\alpha \in \scrO_Y(U)$ we have $\Tr_{\scrO_Y(U)}(\alpha) = \Tr_{\scrI(U)}(\alpha)$.  
\end{lem}

Therefore $\scrI$ is pseudoregular if and only if $\scrI$ is \defi{traceable} in the language of Wood \cite{Wood}.

\begin{proof}
We immediately reduce to the local case, so we may suppose that $S,I$ are free over $R$ of rank $2$. 

If $\scrI$ is pseudoregular, then reading the coefficient of $T$ in $c_S(\alpha;T)=c_I(\alpha;T)$ we have $\Tr_S(\alpha)=\Tr_I(\alpha)$ for all $\alpha \in S$.  

Conversely, suppose that $\Tr_S(\alpha)=\Tr_I(\alpha)$ for all $\alpha \in S$.  It suffices to show that $\Nm_S(\alpha)=\Nm_I(\alpha)$ for all $\alpha\in S$. Let $1, \gamma, e_1, e_2$ be a good basis for $S$ and $I$. Then as in the universal case, we have $\gamma^2-t\gamma+n=0$ with $t,n\in R$ and $\gamma e_1=ae_1+be_2$ and $\gamma e_2=ce_1$ with $a,b,c\in R$.  Since $\Tr_S(\gamma)=\Tr_I(\gamma)$, then $t=a$. Also, we have 
\begin{equation}
tce_1-ne_2=(t\gamma-n)e_2=\gamma^2e_2=ace_1+bce_2
\end{equation}
and thus $\Nm_S(\gamma)=n=-bc=\Nm_I(\gamma)$.  Finally, given $\alpha=x+y\gamma \in S$ with $x,y \in R$ and $[\alpha]=\begin{pmatrix} x+ay & by \\ cy & x\end{pmatrix}$ having $\det([\alpha])=x^2+axy-bcy^2$, we have
\begin{equation}
\Nm_S(\alpha)=(x+y\gamma)(x+y(t-\gamma))=x^2+txy+ny^2 = x^2+axy-bcy^2 = \Nm_I(\alpha)
\end{equation}
and hence $c_S(\alpha;T)=c_I(\alpha;T)$ as desired.
\end{proof}

\section{Discriminants, orientations, and rigidifications} \label{sec:dor}

\subsection{Universal Clifford center} \label{sec:univclifcenter}

In this section, we explain how to associate a quadratic algebra to every quadratic module in a discriminant-preserving way.  

Recall the universal framed quadratic module and its even Clifford algebra in the proof of \Cref{prop:cliffpseudo}.  Given a quadratic $\scrO_X$-module $Q\colon \scrM \to \scrL$, the center of the universal even Clifford algebra specializes to the even Clifford algebra of $Q$, which we call the \defi{universal Clifford center} of $Q$, denoted $\scrZ(Q)$.  By construction, the formation of the universal Clifford center is functorial for similarities and commutes with base change.  

\begin{prop}
If $\scrM$ is a locally free $\scrO_X$-module of even rank, then $\scrZ(Q)$ is a quadratic $\scrO_X$-algebra.
\end{prop}

\begin{proof}
It is enough to check this for the center of the universal even Clifford algebra: for details, see \cite{Auel15}*{Proposition 1.2}.
\end{proof}

\begin{example}
When $Q$ is binary, we have $\scrZ(Q)=\Clf^0(Q)$.
\end{example}

\subsection{Discriminants}
In this section, we define the discriminant of $Q$ intrinsically and show that it agrees with the discriminant of $\scrZ(Q)$.

Let $T$ be the associated bilinear form of $Q$. On each open set $U=\Spec{R}$ with $\scrM(U)=M$ free of rank $n$ and $\scrL(U)=L$, we define the \defi{discriminant} $\disc(Q)$ of $Q$ to be the determinant $\det(T)$ of $T$ with respect to a basis of $M\simeq R^n$, which is a section of $L^{\otimes n}\otimes(\tbigwedge^2M)^{\otimes{-2}}$. The collection of local discriminants on an affine open cover glue to the \defi{(global) discriminant} $\disc(Q)$ of $Q$. 

Suppose that $Q$ is binary. Let $M=Re_1\oplus Re_2$ and $L=Rl$. Suppose that $Q(e_1)=al$, $Q(e_2)=cl$, and $T(e_1,e_2)=bl$. Then $\disc(Q)=\det(T)=(b^2-4ac)l^2$. our definition of discriminate agrees with Wood \cite{Wood}*{p.~1760}. Let $\Clf^0(Q)(U)=S=R\otimes Re_1e_2$ and $\sigma$ be the standard involution on $\Clf^0(Q)$ and $d\colon (\tbigwedge^2\Clf^0(Q))^{\otimes 2}\to \scrO_X$ be the discriminant of $\Clf^0(Q)$. Locally on $U$, we have $d((1\wedge e_1e_2l^\vee)\otimes (1\wedge e_1e_2l^\vee))=(\sigma(e_1e_2l^\vee)-e_1e_2l^\vee)^2=b^2-4ac$. Hence, we can instead define the \defi{discriminant} of $Q$ to be the discriminant $d_{\scrZ(Q)}$ of $\scrZ(Q)$ which is a refinement of $\disc(Q)$.

\subsection{Orientations}

We now organize quadratic modules according to the invariant provided by the universal Clifford center, as follows.  For more details of orientations, see the discussion and references in \cref{sec:contribution}.

\begin{definition}
Let $\scrO_Y$ be a quadratic $\scrO_X$-algebra.  An $\scrO_Y$-\defi{orientation} of $Q \colon \scrM \to \scrL$ is an $\calO_X$-algebra isomorphism $\iota \colon\scrZ(Q) \xrightarrow{\sim} \scrO_Y$.  An \defi{orientation} of $Q$ is an $\calO_Y$-orientation for some $Y$.   
\end{definition}

Let $Q'\colon\scrM' \to \scrL'$ be another quadratic $\scrO_X$-module with $\scrO_Y$-orientation $\iota'\colon\scrZ(Q')\xrightarrow{\sim}\scrO_Y$. We say that a similarity $(\varphi, \lambda)$ between $Q$ and $Q'$ is \defi{$\scrO_Y$-oriented} if the diagram 
\begin{equation}
\begin{tikzcd}
	\scrZ(Q) && \scrZ(Q') \\
	& \scrO_Y
	\arrow["{\Clf^0(\varphi, \lambda)}", from=1-1, to=1-3]
	\arrow["\sim", "\iota"', from=1-1, to=2-2]
	\arrow["\iota'", "\sim"', from=1-3, to=2-2]
\end{tikzcd}
\end{equation}
commutes. 

\begin{lem}
    The set of $\scrO_Y$-orientations is a torsor under $\Aut_{\scrO_X}(\scrO_Y)$ by postcompositions.
\end{lem}

\begin{proof}
 Given an $\scrO_Y$-orientation $\iota\colon \scrZ(Q)\to \scrO_Y$, $u\circ \iota=\iota$ with $u\in \Aut_{\scrO_X}(\scrO_Y)$ forces $u=\id$, and thus this implies the freeness. Given another $\scrO_Y$-orientation $\iota'\colon \scrZ(Q)\to \scrO_Y$, then $u\circ \iota =\iota'$ with $U=\iota'\circ \iota^{-1}$, and thus this implies the transitivity.
\end{proof}

Every $Q$ has a canonical $\scrZ(Q)$-orientation given by the identity.  If $Q$ admits an $\scrO_Y$-orientation, then the set of possibly $\scrO_Y$-orientations is a torsor for $\Aut_{\scrO_X}(\scrO_Y)$ (under post-composition).  In particular, 

\begin{exm}
If $Y$ is an integral scheme (hence $X$ is also integral) and $Y \to X$ is generically separable, then $\Aut_{\scrO_X}(\scrO_Y) \simeq C_2$ with the nontrivial element given by the standard involution. Now let $X=\Spec F$ where $F$ is a field and $(V,Q)$ be a quadratic space over $F$. Consider the case when $\Clf^0(Q)\simeq F(\sqrt{d}).$ Then an orientation of $Q$ is a choice of generator for $F(\sqrt{d}).$
\end{exm}

\begin{cor}
The association $Q\to (\Clf^0(Q),\Clf^1(Q))$ gives a functor fibered over $\catQuad$ from the category  
\begin{center}
$\scrO_Y$-oriented quadratic $\scrO_X$-modules under oriented similarities
\end{center}
to the category 
\begin{center}
pseudoregular $\scrO_Y$-modules under $\scrO_Y$-module isomorphisms.
\end{center}
\end{cor}

\begin{proof}
    By \Cref{Clif functor similarity}, we only need to check that morphisms match. Let $(\varphi, \lambda)$ be an $\scrO_Y$-oriented similarity between quadratic $\scrO_X$-modules $Q\colon \scrM\to \scrL$ and $Q'\colon \scrM'\to \scrL'$ with respect to the orientations $\iota\colon \Clf^0(Q)\to \scrO_Y$ and $\iota'\colon \Clf^0(Q')\to \scrO_Y$. Then we define the $\scrO_Y$-actions on $\Clf^1(Q)=\scrM$ and $\Clf^1(Q')=\scrM'$ by $rx=\iota^{-1}(r)x$ and $rx'=\iota'^{-1}(r)x'$ for all $r\in \scrO_Y$, and $x\in \scrM$, and $x'\in \scrM'$. Then we have $\varphi(rx)=\varphi(\iota^{-1}(r)x)=\Clf^0(\varphi, \lambda)(\iota^{-1}(r))\varphi(x)=\iota'^{-1}(r)\varphi(x)=r\varphi(x)$. 
\end{proof}

\subsection{Rigidifications} \label{sec:rigiddet}

The orientation in the previous section is quite different from that given by Wood \cite{Wood}, O'Dorney \cite{O'Dorney}, and Dallaporta \cite{Dallaporta}, as we now explain and put to a different purpose.  

Let $\scrO_Y$ be a quadratic $\scrO_X$-algebra, $\scrI$ be a $\scrO_Y$-module which is locally free as an $\scrO_X$-module of rank 2, and $\scrL, \scrP$ be invertible $\scrO_X$-modules.
\begin{definition}
     We define the ($\scrL$-)\defi{rigidification} of $\scrI$ to be an $\scrO_X$-module isomorphism $r\colon \scrN(\scrI)\to \scrL$. 
\end{definition}

With the duality in \Cref{sec:wood} in mind, the ($\scrL$-)rigidification agrees with the \emph{$\scrL$-type orientation} of $(\scrO_Y, \scrI)$ in \cite{Wood}*{section 5}. Given an $\scrO_Y$-moduel isomorphisms $\varphi\colon \scrI\to\scrI'$ where $\scrI, \scrI'$ are equipped with ($\scrL$-)rigidificaitons $r$ and $r'$ respectively, we say that $\varphi$ is \defi{rigidified} if the induced isomorphism $(\wedge^2\varphi)\otimes \id\colon \scrN(\scrI)\to \scrN(\scrI')$ commutes with the rigidifications, i.e., the diagram 
\begin{equation}
\begin{tikzcd}
	\scrN(\scrI) && \scrN(\scrI') \\
	& \scrL
	\arrow["{(\wedge^2\varphi\otimes \id)}", from=1-1, to=1-3]
	\arrow["\sim", "r"', from=1-1, to=2-2]
	\arrow["r'", "\sim"', from=1-3, to=2-2]
\end{tikzcd}
\end{equation}
commutes. 

\begin{definition}
    We define a $\scrP$-\defi{determinant structure} on a locally free $\scrO_X$-module $\scrE$ of finite rank $n$ to be an $\scrO_X$ module isomorphism $\omega \colon \tbigwedge^n\scrE\to \scrP$.
\end{definition}

We note that a ($\scrL$-)rigidification of $\scrI$ is equivalent to a $\scrL\otimes(\scrO_Y/\scrO_X)$-determinant structure of $\scrI$. Given an $\scrO_X$-module isomorphism $\varphi \colon \scrE \to \scrE'$ where $\scrE,\scrE'$ have $\scrP$-determinant structures $\omega,\omega'$, we define $\det \varphi \in \scrO_X(X)$ by $\omega' \circ (\wedge^n \varphi) = (\det \varphi) \omega$.  


\begin{lem}
    The set of ($\scrL$-)rigidifications of $\scrI$ is a torsor under $\Gm(X) \colonequals \scrO_X(X)^\times$.
\end{lem}

\begin{proof}
    The action of $u\in \Gm(X)$ on a ($\scrL$-)rigidification $r\colon \scrN(\scrI)\to \scrL$ is induced by the left multiplication $m_u$ by $u$ on $\scrL$, i.e., $u\cdot r=m_u\circ r$. Then $m_u\circ r=r$ forces $u=1$, and thus this implies freeness. Given another ($\scrL$-)rigidification $r'\colon \scrN(\scrI)\to \scrL$, let $v=r'\circ r^{-1} \in \Aut_{\scrO_X}(\scrL)\simeq \Gm(X)$ (because $\scrL$ is a line bundle). Then $v=m_t$ for a unique $t\in \Gm(x)$ and $r'=
    m_t\circ r$. This implies transitivity. 
\end{proof}

\begin{remark}
    A ($\scrL$-)rigidification of $\scrI^\vee$ agrees with the $\scrL$-type orientation defined by Wood \cite{Wood}*{section 5}; over a Dedekind domain (where we consider a frational ideal $\mathfrak{a}$ instead of $\scrL$), this also agrees with the type $\mathfrak{a}$ orientation defined by O'Dorney \cite{O'Dorney}*{section 2.2}. Dallaporta \cite{Dallaporta}*{section 3.1} defines an orientation of $\scrO_Y$ to be an $\scrO_X$-module isomorphism $\scrO_Y/\scrO_X\xrightarrow{\sim} \scrL^\vee$ which recovers the orientation in \cite{Wood}*{Theorem 5.2} by setting $\scrL=\scrO^\vee_X$. The choice of dual is to deal with discriminant and parities. We note that the $\scrO_X$-module isomorphism $\tbigwedge^2\scrO_Y\simeq \scrO_Y/\scrO_X$ induces the $\scrL^\vee$-determinant structure $\tbigwedge^2\scrO_Y\xrightarrow{\sim}\scrL^\vee$. 

\end{remark}

\section{Norms}  \label{sec:norms}

In this section, we define the norm functor and establish its properties, comparing it to the functor of Wood.

\subsection{Norm functor}

Let $\calO_Y$ be a quadratic $\calO_X$-algebra and let $\scrI$ be a $\calO_Y$-module which is locally free as an $\calO_X$-module of rank $2$ (not yet pseudoregular).  

\begin{prop} \label{prop:norm}
There exists a unique quadratic $\scrO_X$-module 
\[ E=E_{\scrI} \colon \scrI \otimes \scrO_Y/\scrO_X \to \tbigwedge^2 \scrI \otimes \scrO_Y/\scrO_X \]
with the property that
\begin{equation} \label{eqn:conduniq}
E(x \otimes \gamma) = (\gamma x \wedge x) \otimes \gamma.  
\end{equation}
for all $x \in \scrI(U)$ and $\gamma \in \scrO_Y(U)$ with $U \subseteq X$ open.
\end{prop}

\begin{proof}
It is enough to show this locally, gluing by uniqueness.  So let $U=\Spec R$, $S=\scrO_Y(U)$ a free quadratic $R$-algebra, and $I=\scrI(U)$ an $S$-module free of rank $2$ over $R$.  Let $I=Re_1 \oplus Re_2$ and $S=R \oplus R\alpha$, and let $x \in I$ and $\gamma=r\alpha+s \in S$ with $r,s \in R$.  Since 
\begin{equation} 
\gamma x \wedge x = (r+s\alpha)x \wedge x = (s\alpha)x \wedge x = s(\alpha x \wedge x) 
\end{equation}
the map is indeed well-defined on $I \otimes S/R$.  Then 
\begin{equation} 
I \otimes S/R \simeq R(e_1 \otimes \alpha) \oplus R(e_2 \otimes \alpha)
\end{equation}
and an arbitrary element is of the form $x \otimes \alpha$ with $x=x_1 e_1 + x_2 e_2$.  In particular, the map is uniquely defined by \eqref{eqn:conduniq}.  We similarly have 
\begin{equation} 
\tbigwedge^2 I \otimes S/R = R((e_1 \wedge e_2) \otimes \alpha)
\end{equation}
and
\[ E(x \otimes \alpha) = (\alpha x \wedge x) \otimes \alpha \]
as a map of sets $E \colon I \otimes S/R \to \tbigwedge^2 I \otimes S/R$.

To see it is a quadratic map, let $\beta=\{e_1,e_2\}$ and $[\alpha]_\beta = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$.  Identifying standard bases as usual, we have 
\begin{equation} \label{eqn:x2yw}
\begin{aligned}
\alpha x \wedge x &=[\alpha]_\beta  [x]_\beta \wedge [x]_\beta = \begin{pmatrix} ax_1+bx_2 \\ cx_1+dx_2 \end{pmatrix} \wedge \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}\\
& = (x_2(ax_1+bx_2)-x_1(cx_1+dx_2))(e_1 \wedge e_2) = E(x_1,x_2)(e_1 \wedge e_2) 
\end{aligned}
\end{equation}
where
\begin{equation} \label{eqn:e1e2}
E(x_1,x_2) \colonequals -cx_1^2+(a-d)x_1x_2+bx_2^2
\end{equation}
is indeed a quadratic form, giving
\begin{equation} \label{eqn:x2yzq0}
E(x \otimes \alpha) = E(x_1,x_2) ((e_1 \wedge e_2) \otimes \alpha)
\end{equation}
and finishing the proof.
\end{proof}

We call the map $E$ in \Cref{prop:norm} the \defi{canonical exterior form} (associated to $\scrI$, over $\scrO_Y$).  To restore the domain as $\scrI$, we twist; let 
\begin{equation}
\scrN(\scrI) \colonequals \tbigwedge^2 \scrI \otimes (\scrO_Y/\scrO_X)^{\vee} \cong (\tbigwedge^2 \scrI \otimes \scrO_Y/\scrO_X) \otimes (\scrO_Y/\scrO_X)^{\vee 2}.
\end{equation}
We define the \defi{norm map} to be the twist by $(\scrO_Y/\scrO_X)^\vee$:
\begin{equation}
N_\scrI \colonequals E_\scrI \otimes (\scrO_Y/\scrO_X)^\vee \colon \scrI \to \scrN(\scrI)
\end{equation}
When we deal with similitudes, we often need to match the value line bundles for the norm maps. Given a ($\scrL$-)regidification $r\colon \scrN(\scrI)\to \scrL$, we define the \defi{modified norm map} $N_{\scrI, \scrL}$ to be the composition $N_{\scrI, \scrL}=r\circ N_\scrI$.
\begin{remark}
It is interesting to note that the norm functor is defined on all $\scrO_Y$-modules $\scrI$ that are locally free $\scrO_X$-modules of rank $2$, not necessarily pseudoregular.  This is analogous to the role of the \emph{exceptional rings} (which are not quaternion rings) in the case of ternary quadratic forms \cites{GL,Voight:quatring}, and so this suggests a generalization in higher rank.  
\end{remark}

\begin{lem} \label{lem:isnorm}
The norm map has 
\begin{equation} \label{eqn:NIAx}
N_{\scrI}(\gamma x) = \Nm(\gamma) N_{\scrI}(x)
\end{equation} 
for all $x \in \scrI(U)$ and $\gamma \in \calO_Y(U)$.  
\end{lem}

\begin{proof}
The twist in $N$ does not affect property \eqref{eqn:NIAx}, so it is equivalent to show it for $E_{\scrI}$.  We can check this property locally, so we refer to \eqref{eqn:x2yzq0}.  Again let $\gamma=r\alpha+s$ with $r,s \in R$, so that $[\gamma]_{\beta} = r[\alpha]_{\beta}+s$ and 
\begin{equation} 
[\gamma]_{\beta} \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} = 
\begin{pmatrix} (ra+s)x_1+rbx_2 \\ rcx_1+(rd+s)x_2 \end{pmatrix} = \begin{pmatrix} x_1' \\ x_2' \end{pmatrix}
\end{equation}  
so that
\[ E(\gamma x \otimes \alpha) = E(x_1',x_2') ((e_1 \wedge e_2) \otimes \alpha) \]
and then
\begin{equation}
\begin{aligned}
E(x_1',x_2') &= -c(x_1')^2 + (a-d)x_1'x_2' + b(x_2')^2 \\
  &= 
((ad-bc)r^2+(a+d)rs + s^2)(-cx_1^2+(a-d)x_1x_2+bx_2^2) \\
&= \Nm(r\alpha+s)E(x_1,x_2)
\end{aligned}
\end{equation}
as claimed.
\end{proof}

\begin{remark}
In \cite{Kneser}, a quadratic $R$-module $Q\colon M\to L$ is called \defi{of type $C$} if $C$ is a quadratic $R$-algebra, $M$ is a projective $C$-module of rank 1, and $Q(c\alpha)=\nrd(c)Q(\alpha)$ for all $c\in C$ and $\alpha\in M$, where $\nrd$ is the reduced norm on $C$.
Kneser shows the following.  Suppose that $\Ann(Q(M))\colonequals\{r\in R\colon rQ(M)=0\}=\{0\}$. Then there is a unique $R$-algebra homomorphism $\beta\colon\Clf^0(Q)\to C$ such that $\beta(c)\alpha=c\alpha$ for all $c\in\Clf^0(Q)$ and $\alpha\in M$. If $Q$ is primitive, then $\beta$ is an isomorphism. Our notion basically equips the modules with the type given by the Clifford map.
\end{remark}

\begin{exm} \label{exm:ournormisanorm}
Suppose $\scrI=\scrO_Y$ is trivial.  Then $\scrN(\scrI)=\tbigwedge^2 \scrI \otimes (\scrO_Y/\scrO_X)^\vee = \tbigwedge^2 \scrO_Y \otimes (\scrO_Y/\scrO_X)^\vee \cong \scrO_X$, the latter under the map $(\alpha \wedge \gamma) \otimes f \mapsto f(\alpha\gamma)$.  \Cref{lem:isnorm} then implies that $N_\scrI$ is just the usual norm $\Nm \colon \scrO_Y \to \scrO_X$.  
\end{exm}

\begin{thm} \label{normfunct}
The association $\scrI \mapsto N_\scrI$ gives a functor from the category of
\begin{center}
$\scrO_Y$-modules under semilinear module isomorphisms
\end{center}
to the category of
\begin{center}
quadratic $\scrO_X$-modules under similarities. 
\end{center}

This association is the \emph{unique} functor from the category of free $\scrO_Y$-modules with the property that if $\scrI=\scrO_Y$, then $\scrI \mapsto (\Nm_{\scrO_Y} \colon \scrO_Y \to \scrO_X)$ maps to the usual norm. 
\end{thm}

\begin{proof}
In \Cref{prop:norm}, we see that objects correspond to objects. To check morphisms, let $\psi \colon \scrI \to \scrI'$ be a semilinear $\scrO_Y$-module isomorphism with respect to $\sigma\in \Aut_{\scrO_X}(\scrO_Y)$; we need to check that the diagram
\begin{equation}
\begin{tikzcd}
	\scrI & \scrN(\scrI) \\
	\scrI' & \scrN(\scrI')
	\arrow["{N_\scrI}", from=1-1, to=1-2]
	\arrow["{\psi}", from=1-1, to=2-1]
	\arrow["{N_{\scrI'}}", from=2-1, to=2-2]
	\arrow["{\wedge^2\psi \otimes \sigma}", from=1-2, to=2-2]
\end{tikzcd}
\end{equation}
commutes so that $(\psi,\wedge^2 \psi \otimes \sigma)$ defines a similarity.  It is enough to check this for $E$ instead, to do so locally, and confirm
\begin{equation}
(\wedge^2 \psi \otimes \sigma)(E(x \otimes \alpha)) = (\psi(\alpha x) \wedge \psi(x)) \otimes \sigma(\alpha) = (\sigma(\alpha) \psi(x) \wedge \psi(x)) \otimes \sigma(\alpha) = E'(\psi(x) \otimes \sigma(\alpha))
\end{equation}
as in the proof of \Cref{prop:norm}.  

Our norm functor has the desired property by \Cref{exm:ournormisanorm}.  To show uniqueness, we again work with the universal framed object. Take $R=\Z[a,b,c,d,t,n]/(a+d-t,ad-bc-n)$ and $S=R\oplus R\gamma$ where $\gamma^2-t\gamma+n=0$. Let $I=Re_1+Re_2$ be an $S$-module with $\beta=\{e_1,e_2\}$ and $[\gamma]_\beta=\begin{pmatrix} a & b \\ c & d \end{pmatrix}\in\M_2(R)$. Then we obtain the norm map $N_{I}$ which is uniquely determined in \Cref{prop:norm}. Under a unique ring homomorphism, $N_\scrI$ is a specialization of $N_{I}$ by \Cref{lem: universal quadratic algebra}.
\end{proof}

\begin{cor}
The association in \Cref{normfunct} is the \emph{unique} functor from the category of pseudoregular $\scrO_Y$-modules with the property that $\scrI=\scrO_Y$ is associated to the usual norm map $\Nm_{\scrO_Y} \colon \scrO_Y \to \scrO_X$.     
\end{cor}

\begin{proof}
Since $I$ is pseudoregular, we can reduce to the free case by tensoring with $F=\Q(t,n)$. In particular, $I\otimes F$ is a free module of rank 2 over $S\otimes F$. Then we can conclude by \Cref{normfunct}.
\end{proof}


\subsection{Involutions}

In this section, we discuss two involutions on the category of pseudoregular $\scrO_Y$-modules.

We begin with the dual.  Let $\scrI$ be an $\scrO_Y$-module which is locally free of rank $2$ as an $\scrO_X$-module.  Then $\scrI^\vee\colonequals \HHom_{\scrO_X}(\scrI,\scrO_X)$ is also locally free of rank $2$ as an $\scrO_X$-module.  

\begin{lem}\label{dual is pseudoregular}
Suppose $\scrI$ is pseudoregular.  Then $\scrI^\vee$ is pseudoregular.  
\end{lem}

\begin{proof}
Since pseudoregularity is a local property, we may work locally on an affine open subset. Let $R$ be a commutative ring, $S=R\oplus R\alpha$ be a quadratic $R$-algebra, and $I=Re_1\oplus Re_2$ be a pseudoregular $S$-module. Then $I^\vee=\Hom_R(I, R)=Re^*_1\oplus Re^*_2$ where $e^*_j(e_j)=\delta_{ij}.$ Let $\lambda_I\colon S \to \End(I)\simeq M_n(R)$ and $\lambda_{I^\vee}\colon S\to \End_R(I^\vee)\simeq M_n(R)$. For each $x\in S$, we have $\lambda_I(x)=\lambda^\intercal_{I^\vee}$ and thus $c_A(x; T)=c_I(x; T)=c_{I^\vee}(x;T). $ This implies that $I^\vee$ is pseudoregular. 
\end{proof}

\begin{prop}\label{dual functor autoequivalence}
The map $\scrI \mapsto \scrI^\vee$ is an contravariant autoequivalence of the category of pseudoregular $\scrO_Y$-modules.  
\end{prop}

\begin{proof}
By \Cref{dual is pseudoregular}, objects are mapped to objects. A given morphism $f\colon \scrI\to \scrJ$ of $\scrO_Y$-modules is mapped to the dual morphism $f^\vee \colon \scrJ^\vee\to \scrI^\vee$ given by $f^\vee(\phi)=\phi\circ f$. There is a canonical evaluation $\scrO_X$ module isomorphism $\ev\colon \scrI \to \scrI^{\vee\vee}$ given by $\ev(x)=(\phi\mapsto \phi(x))$. Hence, the map is a contravariant equivalence. 
\end{proof}

\begin{remark}
    The dual functor is contravariant, so it reverses the direction of the morphisms.  However, every morphism (e.g. $\scrO_Y$-module isomorphism or similarity) we use is an isomorphism, and thus this yields compatible morphisms under duality. 
\end{remark}

\begin{remark}
Fix $X=\Spec{\Z}$ and $Y=\Spec S$ where $S$ is a quadratic order. Let $Q(x,y)=ax^2+bxy+cy^2$ be a $S$-oriented primitive binary quadratic form over $\Z$. There are two natural involutions. Postcomposing the orientation with the standard involution on $S$ sends $Q$ to the binary form $ax^2-bxy+cy^2$. This is the $\mu_2$-action on orientations. Second, multiplying $Q$ by the similitude factor $-1$ yields $-ax^2-bxy-cy^2$. However, if we restrict to the subgroup $\Z^\times_{>0} = \{1\}$ as in  \Cref{exm:narrowclass}, this operation is no longer allowed.
\end{remark}

\subsection{Comparison to Wood} \label{sec:wood}

Wood defines a \defi{linear binary quadratic form} as a global section $f\in\Sym^2M\otimes L$, and Proposition 6.1 shows that $f$ yields a corresponding quadratic $\scrO_X$-module $Q\colon\scrM^\vee\to L$. The dual ensures to preserve the discriminant between $f$ and its corresponding quadratic algebra (see \cite{Wood}*{Theorem 1.6}).  We therefore anticipate, in comparing to Wood, we will need to replace $\scrM$ with $\scrM^\vee$, see \eqref{eqn:sym2sym2}.

Let $\scrL \colonequals (\bigwedge^2\scrI)^\vee\otimes(\scrO_Y/\scrO_X)^\vee$. 
Wood \cite{Wood}*{(1)} defines the map \begin{equation}
\label{Woodeq1}
\begin{aligned}
\Psi \colon \scrL^\vee &\to \Sym^2\scrI \\
(x\wedge y)\otimes\gamma &\mapsto \gamma y\otimes x-\gamma x\otimes y
\end{aligned}
\end{equation}
As in section  \Cref{sec:quadmodules}, we translate this map into our (more classical) notion of binary quadratic modules. Taking the dual yields a map $\Psi^\vee\colon (\Sym^2\scrI)^\vee \to \scrL^{\vee\vee}$ given by $\Psi^\vee(f)(\theta)=f(\Psi(\theta))$ for all $f\in (\Sym^2\scrI)^\vee$ and $\theta \in \scrL^\vee$. The canonical isomorphism $(\Sym_2(\scrI^\vee))^\vee\cong (\Sym^2\scrI)^\vee$ yields a binary quadratic $\scrO_X$-module $Q_{\scrI^\vee}\colon \scrI^\vee\to \scrL$. The map $\scrI\mapsto Q_{\scrI^\vee}$ defines a contravariant functor which maps a $\scrO_Y$-module isomorphism $\psi\colon \scrI\to \scrI'$ to the similarity $(\psi^\vee, (\wedge^2\psi)^\vee\otimes \id)$ from $Q_{\scrI'^\vee}$ to $Q_{\scrI^\vee}$. 

\begin{remark}
\Cref{Woodeq1} allows us to directly obtain the corresponding binary quadratic module without passing through induced linear binary quadratic forms via \cite{Wood}*{Proposition 6.1}.
\end{remark}

\begin{lem} 
The composition of the dual functor and the norm functor is naturally isomorphic to the functor $\scrI \to Q_{\scrI^\vee}$, both functors being contravariant.
\end{lem}

\begin{proof} 
Let $\xi_{\scrI} \colon \tbigwedge^2 \scrI^\vee\to (\tbigwedge^2 \scrI)^\vee$ be the $\scrO_X$-module isomorphism defined by 
\begin{equation}
\xi_\scrI(\theta \wedge \eta)=u\wedge v\mapsto \theta(u)\eta(v)-\theta(v)\eta(u). 
\end{equation}
We claim that $(\id, \xi\otimes \id)$ is a similarity from $N_{\scrI^\vee}$ to $Q_\scrI$, i.e. the diagram \[\begin{tikzcd}
	\scrI^\vee & \tbigwedge^2\scrI^\vee \otimes (\scrO_Y/\scrO_X)^\vee\\
	\scrI^\vee & (\tbigwedge^2\scrI)^\vee\otimes(\scrO_Y/\scrO_x)^\vee
	\arrow["{N_{\scrI^\vee}}", from=1-1, to=1-2]
	\arrow["{\id}", from=1-1, to=2-1]
	\arrow["{Q}", from=2-1, to=2-2]
	\arrow["{\xi_\scrI\otimes \id}", from=1-2, to=2-2]
\end{tikzcd}\]
commutes. It is enough to show this locally. Let $U=\Spec R$, $S=\scrO_Y(U)= R \oplus R\alpha$ a free quadratic $R$-algera, $I=\scrI(U)=Re_1 \oplus Re_2$ an $S$-module free of rank 2 over $R$, and $L=(\tbigwedge^2I)^\vee\otimes (S/R)^\vee$. Let $\beta=\{e^\vee_1, e^\vee_2\}$. Then we have $[\alpha]_\beta = \begin{pmatrix} a & c \\ b & d \end{pmatrix}$ and thus $N_{I^\vee}(x,y)=(-bx^2+(a-d)xy+cy^2)(e^\vee_1\wedge e^\vee_2)\otimes\alpha^\vee$ by \cref{eqn:e1e2}. Applying \Cref{Woodeq1}, we get the map $\Psi|_U \colon L^\vee\to \Sym^2 I$ given by  $\Psi|_U((e_1\wedge e_2)\otimes \alpha)=\alpha e_2\otimes e_1-\alpha e_1\otimes e_2=be_1\otimes e_1+(d-a)e_1\otimes e_2-ce_2\otimes e_2$. This yields the map $\Psi^\vee|_U\colon (\Sym^2\scrI)^\vee\to L$ given $\Psi^\vee|_U((e_1\otimes e_2)^\vee)=b(e_1 \wedge e_2)^\vee\otimes \alpha^\vee$, $\Psi^\vee|_U((e_1\otimes e_2+e_2\otimes e_1)^\vee)=(d-a)(e_1\wedge e_2)^\vee\otimes \alpha^\vee$, and $\Psi^\vee|_U((e_2\otimes e_2)^\vee)=-c(e_1 \wedge e_2)^\vee\otimes \alpha^\vee$. From the isomorphism $(\Sym_2(I^\vee))^\vee\cong (\Sym^2 I)^\vee$. we obatin the quadratic module $Q\colon I^\vee\to L$ given by $Q(xe^\vee_1+ye^\vee_2)=(bx^2+(a-d)xy+cy^2)(e_1\wedge e_2)^\vee\otimes \alpha^\vee$. Then we have $(\xi_\scrI|_U\otimes \id)(N_{I^\vee}(x,y)=Q(x,y)$.

Next, let $\scrI'$ be another $\scrO_Y$-module which is locally free of rank 2 as an $\scrO_X$-module. Let $\psi\colon \scrI\to \scrI'$ be an $\scrO_Y$-module isomorphism. By \cref{normfunct}, the pair $(\psi^\vee, \wedge^2\psi^\vee\otimes \id)$ defines a similarity from $N_{\scrI'^\vee}$ to $N_{\scrI^\vee}$. We want to show that the diagram 
\[\begin{tikzcd}
	N_{\scrI'^\vee} &&& Q_{\scrI'} \\
	\\
	N_{\scrI^\vee} &&& Q_\scrI
	\arrow["{(\id, \,  \xi_{\scrI'}\otimes\id)}", from=1-1, to=1-4]
	\arrow["{(\psi^\vee, \, \wedge^2\psi^\vee\otimes\id)}"', from=1-1, to=3-1]
	\arrow["{(\psi^\vee, \, (\wedge^2\psi)^\vee\otimes \id)}", from=1-4, to=3-4]
	\arrow["{(\id, \, \xi_\scrI\otimes \id)}"', from=3-1, to=3-4]
\end{tikzcd}\]
commutes. We have $(\psi^\vee\circ\id)(\scrI'^\vee)=\scrI^\vee=(\id\circ  \psi^\vee)(\scrI')$ and
\begin{equation}
    \begin{aligned}
        (((\wedge^2\psi)^\vee\otimes\id)\circ (\xi_{\scrI'}\otimes\id))(\scrN(\scrI'^\vee))&=((\wedge^2\psi)^\vee\otimes \id)((\tbigwedge^2\scrI')^\vee \otimes(\scrO_Y/\scrO_X)^\vee)\\
    &= (\tbigwedge^2\scrI)^\vee\otimes (\scrO_Y/\scrO_X)^\vee\\
    &= (\xi_\scrI\otimes \id)(\tbigwedge^2\scrI^\vee\otimes(\scrO_Y/\scrO_X)^\vee)\\
    &= ((\wedge^2\psi^\vee\otimes \id)\circ(\xi_\scrI\otimes\id))(\scrN(\scrI'^\vee)).
    \end{aligned}
\end{equation}
\end{proof}

\begin{remark}
    Although the functor defined by Wood is covariant, all categories we work with are groupoids which are naturally equivalent to their opposite categories. Therefore, we could recover covariance by reversing isomorphisms. 
\end{remark}


\subsection{Canonical orientations}
We have a canonical $\calO_X$-module isomorphism 
\begin{equation} \label{eqn:canonisom}
\begin{aligned}
\Clf^0(N_\scrI)/\calO_X \cong \tbigwedge^2 \scrI \otimes \scrN(\scrI)^\vee 
= \tbigwedge^2 \scrI \otimes (\tbigwedge^2 \scrI \otimes (\scrO_Y/\scrO_X)^\vee)^\vee 
\cong \scrO_Y/\scrO_X.
\end{aligned}
\end{equation}

\begin{prop} \label{prop:canorient}
Suppose that $\scrI$ is pseudoregular.  Then there exists a unique $\calO_X$-algebra isomorphism 
\begin{equation}  \label{eqn:canorient-defn}
\Clf^0(N_\scrI) \xrightarrow{\sim} \scrO_Y 
\end{equation}
which lifts the canonical $\calO_X$-module isomorphism \eqref{eqn:canonisom}.
\end{prop}

We call the isomorphism \eqref{eqn:canorient-defn} the \defi{canonical orientation}.

\begin{proof}
We will exhibit a unique such isomorphism locally. On a open set $U=\Spec{R}$, we have $S=\scrO_Y(U)$ and $I=\scrI(U)$ with a good basis $1, \gamma, e_1, e_2$. Let $N_I \colon I \to L$ where $L= \tbigwedge^2 I \otimes (S/R)^\vee$.  Then $\Clf^0(N_I) \simeq R \oplus Re_1e_2$. In the canonical isomorphism \eqref{eqn:canonisom}, locally we have $\Clf^0(N_I)/R \simeq R(e_1e_2) \xrightarrow{\sim} S/R = R \gamma$ where the image of $e_1e_2$ is $u\gamma$ with $u \in R^\times$ and we rescale $e_1$ so that $u=1$.  

The map $e_1e_2 \mapsto \gamma$ in fact defines an $R$-algebra isomorphism. It is enough to show that $e_1e_2$ and $\gamma$ have the same characteristic polynomial.  From the above, using that $I$ is pseudoregular, we have $\Tr_I(\gamma)=\Tr_S(\gamma)=a$ and $\Nm_I(\gamma)=\Nm_S(\gamma)=-bc$.  We similarly compute using \eqref{eqn:e1e2}
that $(e_1e_2)e_1=e_1(a-e_1e_2)=ae_1+cd_2$ and $(e_1e_2)e_2 =be_1$ giving $[e_1e_2]_\beta=\begin{pmatrix} a & b\\ c & 0\end{pmatrix}$ which indeed matches. It is clear that the isomorphism is independent of the choice of good basis.
\end{proof}

\begin{cor} \label{cor:canori}
The association $\scrI \mapsto N_\scrI$ together with the canonical orientation gives a functor from the category of
\begin{center}
$\scrO_Y$-modules under isomorphisms
\end{center}
to the category of
\begin{center}
$\scrO_Y$-oriented quadratic $\scrO_X$-modules under oriented similarities
\end{center}
which is fibered over $\catQuad$.
\end{cor}

\begin{proof}
The statement follows from \Cref{normfunct} together with the functoriality of the the association of the canonical orientation (by uniqueness).  The fiber structure is immediate, as both categories map an object to $\calO_Y$.
\end{proof}



\section{Proofs of main results} \label{sec:finishproof}

In this section, we prove our main theorem and derive corollaries.  The proof proceeds in several steps.  We first define a quasi-inverse functor to the Clifford functor called the norm functor; we justify the name and show it nearly agrees with the construction of Wood \cite{Wood}*{(1)}.  Then we show that the composition of the two is naturally isomorphic to the identity.  

\subsection{Main theorems}

We now conclude the proof of the main theorems.

\begin{proof}[Proof of \Cref{Main Thm GSO}]
We have a Clifford functor $\mathcal{F}$ by \Cref{prop:oddcliff} and a norm functor $\mathcal{G}$ by \Cref{cor:canori}. The discrminant-preserving property is clear from the definition.  We finish by checking that the composition of the two functors in each direction is naturally isomorphic to the identity.

For each $Q \colon \scrM \to \scrL$ be an $\scrO_Y$-oriented binary quadratic $\scrO_X$ module, we have $(\mathcal{G} \circ \mathcal{F})(Q)=N_{\Clf^1(Q)}$ which is $\scrO_Y$-oriented. Since $\Clf^0(Q)/\calO_X \simeq \tbigwedge^2 \scrM \otimes \scrL^{\vee}$ as $\calO_X$-modules and $\scrM=\Clf^1(Q)$, then there is an $O_X$-module isomorphism $u_Q$ form $\scrN(\Clf^1(Q))=\scrN(\scrM)=\bigwedge^2\scrM \otimes (\Clf^0(Q)/\scrO_X)^\vee\simeq \bigwedge^2\scrM \otimes (\bigwedge^2 \scrM \otimes \scrL^\vee)^\vee$ to $\scrL$, and thus $(\id, u_Q)$ is an $\scrO_Y$-oriented similarity  between $N_{\Clf^1(Q)}$ and $Q$. On the other hand, for $\scrI$ be a pseudoregular $\scrO_Y$-module,  \Cref{prop:canorient} implies that $(\mathcal{F}\circ\mathcal{G})(\scrI)=\Clf^1(\scrI)=\scrI$ which is a pseudoregular $\Clf^0(\scrI)$-module with $\Clf^0(\scrI)\simeq \scrO_Y$. 

Next, we check the natural condition on morphisms. Let the pair of $\scrO_X$-module isomorphisms $\varphi \colon \scrM \to \scrM'$ and $u\colon \scrI \to \scrI'$ be a similarity between quadratic modules $\scrO_Y$-oriented binary quadratic $\scrO_X$-modules $Q \colon \scrM \to \scrI$ and $Q' \colon \scrM' \to \scrI'$. Then the diagram 
\begin{equation}
\begin{tikzcd}
	N_{\Clf^1(Q)} &&& Q\\
    \\
	N_{\Clf^1(Q')} &&& Q'
	\arrow["{(\id, u_Q)}", from=1-1, to=1-4]
	\arrow["{(\mathcal{G}\circ\mathcal{F})(\id, u)}"', from=1-1, to=3-1]
	\arrow["{(\varphi, u)}", from=1-4, to=3-4]
	\arrow["{(\id, u_{Q'})}", from=3-1, to=3-4]
\end{tikzcd}
\end{equation}
commutes.  Similarly, given pseudoregular $\scrO_Y$-modules $\scrI$ and $\scrI'$, let $\psi \colon \scrI \to \scrI'$ be an $\scrO_Y$-module isomorphism. It is clear that $(\mathcal{F}\circ\mathcal{G})(\psi)=\psi$.
\end{proof}

\begin{proof}[Proof of \Cref{Main Thm sim}]
The canonical isomorphism in \Cref{binary even cliff mod O_X} and the orientations together give the rigidifications with respect to the value line bundles, and thus objects map to objects. We show that oriented similitudes correspond to module isomorphisms. Let $(\varphi, \lambda)$ be an $\scrO_Y$-oriented similitude between quadratic $\scrO_X$-modules $(\scrM, \scrL, Q)$ and $(\scrM', \scrL, Q')$ with respect to orientations $\iota\colon \scrZ(Q)\to\scrO_Y$ and $\iota'\colon \scrZ(Q')\to\scrO_Y$ respestively.  Let $\gamma\colon \tbigwedge^2\scrM \otimes (\Clf^0(Q)/\scrO_X)^\vee \to \scrL$ and $\gamma'\colon \tbigwedge^2\scrM' \otimes (\Clf^0(Q')/\scrO_X)^\vee \to \scrL$ be the  $\scrO_X$-module isomorphisms given by \Cref{binary even cliff mod O_X}. Then $\varphi$ is an $\scrO_Y$-module isomorphism, and $r\colon \scrN(\scrM)\to \scrL$ given by $r=\gamma\circ (\id\otimes \iota^\vee)$ and $r'\colon \scrN(\scrM')\to \scrL$ given by $r'=\gamma'\circ (\id\otimes \iota'^\vee)$ are ($\scrL$-)regidifications for $\scrM$ and $\scrM'$ respectively. 

Conversely, let $\scrI$ and $\scrI'$ be pseudoregular $\scrO_Y$-modules equipped with $\scrL$-rigidifications $r\colon \scrN(\scrI)\to \scrL$ and $r'\colon \scrN(\scrI')\to \scrL$, and let $\varphi\colon \scrI \to \scrI'$ be an $\scrO_Y$ isomorphism. As shown in the proof of \Cref{normfunct}, $(\varphi, \wedge^2\varphi \otimes \id)$ is a similarity from $N_\scrI$ to $N_{\scrI'}$, and thus $(\varphi, r'\circ (\wedge^2\varphi \otimes \id)\circ r^{-1})$ is a similitude, i.e. the diagram 
\begin{equation} \label{eqn:Lr'}
\begin{tikzcd}
	\scrI && \scrN(\scrI) && \scrL \\
	\\
	\scrI' && \scrN(\scrI') && \scrL
	\arrow["N_{\scrI}", from=1-1, to=1-3]
	\arrow["\varphi"', from=1-1, to=3-1]
	\arrow["r", from=1-3, to=1-5]
	\arrow["\wedge^2\varphi\otimes \id"', from=1-3, to=3-3]
	\arrow["r'\circ (\wedge^2\varphi \otimes \id)\circ r^{-1}", from=1-5, to=3-5]
	\arrow["N_{\scrI'}", from=3-1, to=3-3]
	\arrow["r'", from=3-3, to=3-5]
\end{tikzcd}
\end{equation}
commutes. 
A similar proof to the one of \Cref{prop:canorient} could show that there exist unique $\scrO_X$-algebra isomorphisms $\Clf^0(r\circ N_{\scrI})\xrightarrow{\sim}\scrO_Y$ and $\Clf^0(r'\circ N_{\scrI'})\xrightarrow{\sim}\scrO_Y$, and thus $(\varphi, r'\circ (\wedge^2\varphi \otimes \id)\circ r^{-1})$ is $\scrO_Y$-oriented. 

For the fibered structure, we map each object in the first category to the pair $(\scrO_Y, \scrL)$ where $\scrL$ is its codomain; we map each object in the second one to the pair $(\scrO_Y, \scrL)$ where $\scrL$ is the chosen invertible $\scrO_X$-module for the regidification. The discriminant-preserving property and the fact that the composition of the two functors in each direction is naturally isomorphic to the identity are immediate from the proof of \Cref{Main Thm GSO}. 
\end{proof}

\begin{proof}[Proof of \Cref{Main Thm SO}]
We restrict the equivalence proven in \Cref{Main Thm sim} to the subcategories with the same objects but morphisms restricted to oriented isometries and rigidified isomorphisms, respectively, and claim that this restricts again to an equivalence.  It suffices to check that the Clifford functor carries the condition $\lambda=1$ on the similitude factor to compatibility with rigidification and vice versa.  We refer to \eqref{eqn:Lr'}: the right-hand square commutes, and so $\lambda=1$ corresponds exactly to the condition of a rigidified isomorphism, and conversely.  
\end{proof}


\subsection{Primitivity and invertibility}

In this section, we restrict our equivalences to nondegenerate objects to see the resulting restricted equivalences; as applications, taking isomorphism classes of objects, we derive relationships to Picard groups.  

\begin{definition}
    We say a quadratic $\scrO_X$-module $(\scrM, \scrL, Q)$ is \defi{primitive} if for each open $U\subseteq X$, the sections $Q(x)$ with $x\in \scrM(U)$ generate $\scrL(U)$ as an $\scrO_X(U)$-module. 
\end{definition}

\begin{prop}\label{primitive = invertible}
A quadratic $\calO_X$-module is primitive if and only if it corresponds under Clifford to an invertible $\calO_Y$-module.
\end{prop}

\begin{proof}
Both direction can be proved locally and glued by uniqueness. First, suppose that a quadratic $\scrO_X$-module $(\scrM, \scrL, Q)$ is primitive. Let $U=\Spec R$. Then $M=\scrM(U)=\Clf^1(Q)(U)$ and $S=\Clf^0(Q)(U)$ are free quadratic $R$-modules, and $L=\scrL(U)$ is a free $R$-module of rank 1. Let $M=Re_1 \oplus Re_2$,  $L=R\alpha$, and $S=R\oplus Re_1e_2$ with $Q(e_1)=a\alpha, T(e_1,e_2)=b\alpha$, and $Q(e_2)=c\alpha$. Then there exist $x, y\in R$ such that $Q(xe_1+ye_2)\in R^{\times}\alpha$. Let the map $\phi\colon S\to M$ be defined by $\phi(s)=(xe_1+ye_2)s$. Let $\beta={e_1, e_2}$. Since $[\phi]_\beta=\begin{pmatrix}
x & -cy\\
y & ax+by
\end{pmatrix}$ which has discriminant $(ax^2+bxy+cy^2)\alpha$, then $\phi$ is surjective. This implies that $M=(xe_1+ye_2)S$, and thus globally $\Clf^1(Q)$ is an invertible $\Clf^0(Q)$-module.

Conversely, suppose that $\Clf^1(Q)$ is an invertible $\Clf^0(Q)$-module. Then there exists $x, y\in R$ such that the left multiplication map $\phi_v\colon S\to M$ is an $S$-module isomorphism. Since $\phi_v$ is $R$-linear of quadratic $R$-modules, then $[\phi]_\beta\in R^{\times}$ and thus $Q(v)\in R^{\times}\alpha$. Hence, we conclude that $Q$ is primitive. 
\end{proof}

Now we prove the corollaries with respect to the isomorphism classes. 

\begin{proof}[Proof of \Cref{GSO class =Pic Y}]
Immediate from taking isomorphism classes on both sides of \Cref{Main Thm GSO} by \Cref{primitive = invertible}.
\end{proof}

\begin{exm} \label{exm:classical}
If $X=\Spec \Z$, then $Y=\Spec S$ is a quadratic ring with discriminant $d \in \Z$.  Then \Cref{GSO class =Pic Y} says that primitive binary quadratic forms of discriminant $d$ up to $\SL_2(\Z)$-equivalence and scaling by $\pm1$ are in bijection with the class group of $S$.  The orientation corresponds to a fixed choice of generator of $S/\Z$.
\end{exm}


\begin{proof}[Proof of \Cref{Main Thm GO}]
By \Cref{prop:oddcliff} and \Cref{normfunct}, similarities correspond to semilinear module isomorphisms which are determined by $\Aut_{\scrO_X}(\scrO_Y)$. Taking isomorphism classes together with \Cref{Main Thm GSO} yields the result. 
\end{proof}

\begin{example}\label{exm:narrowclass}
If $Y=\Spec S$ is a real quadratic ring over $X=\Spec \Z$ with discriminant $d$ and $H=\{1\}$, then \Cref{H-similitude class = Pic H} recovers the classical statement of Gauss composition saying that primitive binary quadratic forms of discriminant $d$ up to $\SL_2(\Z)$-equivalence  are in bijection with the narrow class group of $S$, and orientation corresponds to a fixed choice of generator of $S/\Z$.
\end{example}

\section{Applications and discussion} \label{sec:litreview}

We conclude in this section with some applications and further discussion.

\subsection{Genera and class sets}\label{genus}

In this section, we classify class sets of genera  which encode information about isomorphism of objects locally at all points in $X$. For primitive binary forms, we will see that we only need to consider global isomorphism classes. 

For a quadratic $\scrO_X$-module $(\scrM, \scrL, Q)$ and a point $x \in X$, let $(\scrM_x, \scrL_x, Q_x)$ be the base extension of $Q$ with respect to $\scrO_{X,x}$ where $\scrM_x=\scrM \otimes_{\scrO_X} \scrO_{X,x}$ and $\scrL_x=\scrL \otimes_{\scrO_X} \scrO_{X,x}$. If $Q$ has an $\scrO_Y$-orientation, then the corresponding local orientation for $Q_x$ is $(\scrO_Y)_x$ for $x\in X$.

Let $\scrO_Y$ be an orientation of $Q$ and $H\leq \scrO_X(X)^\times$.
\begin{itemize}
\item We define the \defi{oriented similarity genus} of $Q$ to be the set $\Gen_{\GSO}(Q)$ of quadratic $\scrO_X$-modules $(\scrM', \scrL', Q')$ such that there is an $(\scrO_Y)_x$-oriented similarity between $Q_x$ and $Q'_x$ for all $x\in X$.  
\item We can similarly define the \defi{oriented $H$-similitude genus} $\Gen_{\GSO, H}(Q)$. 
\item Forgetting orientations, we can also define the \defi{similarity genus} $\Gen_{\GO}(Q)$ and the \defi{$H$-similitude genus} $\Gen_{\GO, H}(Q)$. 
\end{itemize}
We define the \defi{oriented similarity class set} $\Cls_{\GSO}(Q)$ and  \defi{similarity class set} $\Cls_{\GO}(Q)$, as well as the \defi{oriented $H$-similitude class set} $\Cls_{\GSO,H}(Q)$ and the \defi{$H$-similitude class set} $\Cls_{\GO,H}(Q)$, to be the sets of global classes in the corresponding genera respectively. 

\begin{thm}\label{GSO class=Cls}
 All primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-modules are in the same oriented similarity genus. 
\end{thm}

\begin{proof}
    It is enough to show that for any primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-module $(\scrM, \scrL, Q)$, there is an $(\scrO_Y)_x$-oriented similarity between $Q_x$ and the norm $\Nm_x\colon (\scrO_Y)_x\to \scrO_{X,x}$. Given $x\in X$, we have $(\scrO_Y)_x=\scrO_{X,x} \oplus \scrO_{X,x}\alpha$, $\scrM_x=\scrO_{X,x}e_1\oplus\scrO_{X,x}e_2$ for a good basis $1, \alpha, e_1, e_2$ of $(\scrO_Y)_x$ and $\scrM_X$. We also have $\scrL_x=\scrO_{X,x}l$ for some $l\in \scrL_x$. By \Cref{prop:canorient}, there is a unique $\scrO_{X,x}$-algebra isomorphism between $\Clf^0(Q_x)$ and $(\scrO_Y)_x$ given by the map $e_1e_2\mapsto \alpha$. Suppose that $Q_x(xe_1+ye_2)=(ax^2+bxy+cy^2)l$ for $a,b,c\in\scrO_{X,x}$. Then we have $(e_1e_2)^2=be_1e_2-ac$, and thus $\Nm_x(x+y\alpha)=x^2+bxy+acy^2$. Since $Q_x$ is primitive and $\scrO_{X,x}$ is a local ring, then there exists some $x_0, y_0$ such that $ax^2_0+bx_0y_0+cy^2_0\in \scrO^\times_{X,x}$, and we can replace $e_1$ by $x_0e_1+y_0e_2$ and extend it to a basis for $\scrM_x$. Thus, without loss of generality, we may assume that $a$ is a unit. Let $\varphi \colon \scrM_x\to (\scrO_Y)_x$ and $\psi\colon \scrL_x\to \scrO_{X,x}$ be the $\scrO_{X,x}$-module isomorphisms defined by $\varphi(xe_1+ye_2)=x+a^{-1}y\alpha$ and $\psi(rl)=a^{-1}r$. Then we have $\Nm_x(\varphi(xe_1+ye_2))=x^2+a^{-1}bxy+a^{-1}cy^2=\psi(Q_x(xe_1+ye_2))$, and thus $(\varphi, \psi)$ is a similarity between $Q_x$ and $\Nm_x$. The choice of good basis and \Cref{prop:canorient} ensure that the similarity is oriented. 
\end{proof}

\begin{cor}\label{GSO class set}
    The oriented similarity classes of primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-modules are exactly the elements of $\Cls_{\GSO}(Q)$ for any primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-module $Q$.
\end{cor}

\begin{proof}
    Taking global classes in \Cref{GSO class=Cls} yields the result. 
\end{proof}

Fixing the value line bundle, we have the following corollary with respect to similitude. 
\begin{cor}
    The oriented similitude classes of primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-modules with a fixed value line bundle $\scrL$ are exactly the elements of $\Cls_{\GSO, \scrO_X(X)^\times}(Q)$ of any primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$-module with value line bundle $\scrL$.
\end{cor}

\begin{proof}
    We slightly modify the proof of \Cref{GSO class=Cls}. Given $x\in X$, there is an $\scrO_{X,x}$-isomorphism $\mu\colon \scrO_{X,x}\to \scrL_x$ given by $1\mapsto e$. Then we have $(\mu\circ\Nm_x)(x+y\alpha)=(x^2+bxy+acy^2)e$. It follows that $(\phi, \mu\circ \psi)$ is a similitude between $Q_x$ and $(\mu\circ\Nm_x)$.
\end{proof}

Next, we consider $H$-similitude classes with $H < \scrO_X(X)^\times$. The approach in the proof of \Cref{GSO class=Cls} does not work anymore because of the  restricted choices of similitude factors. Thus, we will not realize the $H$-similitude classes exactly as the elements of the $H$-similitude class set. Instead, we pass to the side of $\scrO_Y$-modules via Clifford. 

\begin{cor}
    There is a bijection between the oriented $H$-similitude class set of a primitive $\scrO_Y$-oriented binary quadratic $\scrO_X$ module and $\Pic^{(H)}Y$.
\end{cor}

\begin{proof}
We note that the local norm at each $x\in X$ of the transition function is in $H_x$. Then taking global classes yields $\Pic^{(H)}Y$.    
\end{proof}

\subsection{Binary orthogonal modular forms} \label{sec:algmodform}
In this section, we will apply the classifications of class sets in \Cref{genus} to understand the space of orthogonal modular forms on binary lattices. 

Let $F$ be a totally real number field and $Q\colon V\to F$ be a totally positive definite quadratic space with $\dim_F V=r$. For a $\Z_F$-lattice $\Lambda\subset V$ of rank $r$, the restriction $Q_\Lambda$ of $Q$ to $\Lambda$ yields a quadratic $\Z_F$-module. Let $\mathfrak{N}$ be the (signed) discriminant of $\Lambda$. One can consider the equivalences, which preserve lattices, given by the reductive groups $\Orthogonal, \SO, \GO$, or $\GSO$. The \defi{genus} $\Gen(\Lambda)$ of $\Lambda$ is the set of lattices in $V$ which becomes equivalent to $\Lambda$ at each completion. The set of
global equivalence classes in the genus defines the \defi{class set} $\Cls(\Lambda)$. The space of \defi{orthogonal modular forms} for $\Lambda$ (of trivial
weight) is the $\C$-vector space of functions on $\Cls(\Lambda),$ namely $M(\Lambda)\colonequals\{\Cls(\Lambda)\to\C\}$.

When the rank $r$ is small, just as in the classification of semisimple Lie groups, we obtain connections between orthogonal modular forms and classical, Hilbert,
and Siegel modular forms. For $r=3$, there
is a Hecke-equivariant, functorial association to classical modular forms, first exhibited by Birch \cite{Birch} and then generalized by Hein \cite{Hein} and Hein--Torna\'{r}a--Voight \cite{HeinTornariaVoight}. For $r=4$, the association to Hilbert modular forms are made explicit by Assaf--Fretwell--Ingalls--Logan--Secord--Voight \cite{AFILSV}. For $r=5$ and squarefree $\mathfrak{N}$, the association to Siegel paramodular forms are made explicit by Rama--Torna\'{r}ia \cite{RamaTornaria} and Dummigan--Pacetti--Rama--Torno\'{r}ia \cite{DummiganPacettiRamaTornaria}. 

The Clifford functor has played a pivotal role in the ternary and quaternary cases. In the missing binary case, \Cref{GSO class set} implies the isomorphism $\Cls(\Lambda)\simeq \Pic S$ where $S = \Clf^0(Q_\Lambda)$. Then we can rewrite the space of orthogonal modular forms $M(\Lambda)$ with respect to $\GSO$ as the $\C$-vector space $M(\Pic S)$ of functions on $\Pic S$.  

For $\mathfrak{p}\nmid\mathfrak{N}$ with $\mathfrak{p} = \mathfrak{P}\mathfrak{P}'$, we define the \defi{Hecke operator}
\begin{align*}
T_{\mathfrak{P}}\colon M(\Cl(S))&\to M(\Cl(S))\\
f&\mapsto\bigg([\mathfrak{A}]\mapsto f([\mathfrak{AP}])\bigg),
\end{align*}
and similarly for $\mathfrak{P}'$. Such operators pairwise commute and are self-adjoint with respect to a natural inner product. Thus, there is a basis of simultaneous  eigenvalues, called \defi{eigenforms}, which are exactly the multiplicative characters on $\Pic S$.

\begin{thm}
The Clifford and norm maps induce Hecke equivariant bijections between the space of orthogonal modular forms for $\Lambda$ and the space of functions on $\Pic S$ where $S=\Clf^0(Q_\Lambda)$.  
\end{thm}

\begin{proof}
The neighboring relation on orthogonal modular forms gives a similarity over the localization, matching up with the neighboring relation on ideal classes over the quadratic ring.  
\end{proof}

\begin{remark}
For a further connection to Hilbert modular forms via theta series, see Wu \cite{Wu}.
\end{remark}

\subsection{Recent work}\label{recent work}

To conclude, we review recent work generalizing Gauss composition. The history of the composition of binary quadratic forms and the revisit of Gauss composition in 19th and early 20th centuries can be found in \cite{Dickson23} (see also \cite{Towber}*{Introduction}).

Gauss's original approach in \cite{Gauss} was complicated. Influenced by Legendre, Dirichlet and Dedekind took another route in \cite{Dirichlet}*{Supplement X} (see also \cite{Cox}*{Section 3A} or \cite{Dickson51}*{Section IX}). Two quadratic forms $ax^2+bxy+cy^2$ and $a'x^2+b'xy+c'y^2$ over $\Z$ are called \emph{united} if they have the same discriminant and $\gcd(a, a', \frac{b+b'}{2})=1$. Dirichlet and Dedekind defined a composition for united forms and realized a group structure for the set of classes of primitive positive definite forms of the same discriminant. In 1961, following Dirchilet and Dedekind, Lubelski \cite{Lubelski} generalized the composition over Euclidean rings. 

In 1968, Butts--Estes \cite{ButtsEstes} introduced $C$-domains $D$ which are integral domains with characteristic not 2 and certain structural conditions, and developed explicit composition laws for binary quadratic forms over $D$ via united forms. They showed that the set of classes of primitive binary quadratic forms over $D$ with discriminants in a certain set $\Delta$ is a commutative semigroup. If the discriminant is fixed, then this recovers the classical case. Moreover, they considered the quadratic algebra $R=D[\omega]$ and gave a norm condition for an $R$-ideal generated by $A$ and $b+\omega$ as $D$-module to be invertible where $A$ is an invertible ideal of $D$ and $b\in D$. The direct compounds of binary quadratic forms correspond exactly to products of free rank-two $R$-modules, and whenever products of free $D$ modules in $R$ remain free, the classes of primitive form with discriminant $d\in\Delta$ form an abelian group $G_d$ under composition. They also constructed a surjective homomorphism from $G_d$ to a subgroup of the ideal class group of $R$, identifying the kernel as those classes containing a form that represents a unit in $D$.

Also in 1968, Kaplansky \cite{Kaplansky} extended the theory of composition to Bzout domain of characteristic not 2 via module multiplication. This recovers the same composition of united forms. 

In 1972, Butts--Dulin \cite{ButtsDulin} studied the connection between Gauss composition and composition of united forms. They considered the compound and the Gaussian compound of binary quadratic forms defined by Gauss. Then they gave necessary and sufficient conditions for existence in each case over a Bzout domain and for existence of composition of united forms in an integral domain of characteristic not 2 where two primitive binary quadratic forms of the same discriminant has a Gaussian compound. Furthermore, they showed that the composition of united forms holds over a Bzout.

In 1980, Towber  \cite{Towber} gave a generalization in which the domain of a quadratic form $Q\colon M\to R$ where $M$ is a locally free module of rank 2 over a commutative ring $R$ (with $1$) such that $\tbigwedge^2 M$ (equipped with an orientation given by a choice of generator) is a free $R$-module of rank 1. He also introduced a composition law on the set of equivalence classes under the action of $\SL_2(R)$ of primitive, oriented binary quadratic forms $ax^2+bxy+cy^2$ with a given discriminant and a given residue class of $b$ in $R/2R$. 

In 1982, Kneser \cite{Kneser} considered quadratic forms $Q \colon M \to R$ over a commutative ring $R$ where $\Clf^0(Q)$ is isomorphic to a given \emph{type} which is an $R$-algebra $C$. This $C$-module structure ensures the existence and the uniqueness of a composition map. The isomorphism classes of primitive binary quadratic forms of type $C$ with the composition law form an abelian group $G(C)$. Forgetting the quadratic form on $M$ yields a homomorphism $G(C)\to \Pic(C)$ which is in general neither injective nor surjective. To obtain the full Picard group, he then considered $M$ as invertible $C$-modules. \cite{Kneser}*{Proposition 2} gives quadratic $R$-modules (also called \emph{quadratic maps} by Kneser) $Q\colon M \to N$ where $N$ is invertible $R$-module, $Q(cx)=\Nm_{C/R}(c)Q(X)$ for all $c\in C$ and $x\in m$, and $Q$ is primitive. The isomorphism classes (oriented similarity classes in our notion) of such quadratic modules are isomorphic to $\Pic(C)$. This is exactly recovered by \Cref{GSO class =Pic Y}.

Most of the works above only considered $\SL_2$-equivalence of binary quadratic forms. In 2000, Mastropietro \cite{Mastropietro} considered equivalences given by matrices of determinants which are totally positive units over real quadratic number fields of class number
one with totally complex quadratic extensions. He gave the contruction of a correspondence between ideal class groups and such equivalence classes. 


In 2004, Bhargava \cite{Bhargava1} considered the space of $2 \times 2 \times 2$ cubical integer matrices modulo the natural action of $\SL_2(\Z) \times \SL_2(\Z) \times \SL_2(\Z)$ and described six composition laws, including Gauss composition, derived from this approach. He then gave interpretations of the connection between orbits of the six spaces and ideal classes of quadratic orders.  (It would be interesting to pursue a sheafified version of this approach.) \cite{Bhargava2} and \cite{Bhargava3} in the same year and \cite{Bhargava4} in 2008 developed analogous laws of composition on forms of degree $k>2$ so that the resulting orbits parametrize orders in number fields of degree $k$.  

In 2011, Wood \cite{Wood} gave a generalization of Gauss composition over any base scheme. Her dual point view considers linear binary quadratic forms over a scheme $X$ as global sections of $\Sym^2(\scrM)\otimes \scrL$ where $\scrM$ is a locally free $\scrO_X$-module of rank 2 and $\scrL$ is an invertible $\scrO_X$-module (see discussion in \cref{sec:wood}). The $\GL_2(\Z)\times \GL_1(Z)$-equivalences are exactly our notion of similarities. On the other hand, she considers pairs $(\scrO_Y, \scrI)$ where $\scrO_Y$ is a quadratic $\scrO_X$-algebra and $\scrI$ is a traceable $\scrO_Y$-module. \Cref{lem:traceable} has shown that being traceable is equivalent to being pseudoregular. Then \cref{Main Thm GO} recovers \cite{Wood}*{Theorem 1.4}, and thus restricting to primitive forms recovers \cite{Wood}*{Theorem 1.5} because primitive forms correspond to invertible modules by \Cref{primitive = invertible}. \cite{Wood}*{section 5} further equips an $\scrL$-type orientation corresponding to $(\scrO_Y, \scrI)$, and \Cref{Main Thm SO} recovers \cite{Wood}*{Theorem 5.1}. Unfortunately, Wood did not give group laws or isomorphisms with Picard groups in our style; instead, her results only provide a set-theoretical bijection with a disjoint union of quotients of Picard groups in the primitive case. 

Wood mentions that Lenstra suggested in a talk that Kneser's approach could yield a theorem in the style of \cite{Wood}*{Theorem 5.1} in the case when the forms are primitive and nondegenerate. He also suggested a Clifford algebra construction which could provide a theorem along the lines of \cite{Wood}*{Theorem 1.4}.

In 2016, O'Dorney \cite{O'Dorney} generalized Bhargava's theory of higher composition law over arbitrary Dedekind domains. The parametrization of quadratic, cubic, and quartic algebras as well as ideal classes in
quadratic algebras extended Bhargava's reinterpretation of Gauss composition. 

In 2021, Zemkov \cite{Zemkova} generalized Mastropietro's work to the case where the base field is any number field of narrow class number one and gave explicit correspondence between the ideal class group and the equivalence classes of binary quadratic forms. She also gave a short overview of previous works in the introduction section. 

In 2024, following Wood's approach with extra refinements, Dallaporta
\cite{Dallaporta} recovered from Woods bijection an explicit bijection between the
Picard group of a given quadratic algebra and a set of classes of primitive quadratic
forms over a scheme. \Cref{GSO class =Pic Y} recovers \cite{Dallaporta}*{Theorem 1.2} where the corresponding quadratic algebra is specified by the discriminant and parity.  

In 2025, Bitan \cite{Bitan} considered Gauss composition for binary quadratic forms over the ring of regular functions over
an affine curve over a finite field of odd characteristic. He used \'etale cohomology to describe the bijection between the equivalence classes of binary quadratic forms and the Picard group of the corresponding quadratic algebra. 

Finally and very recently, Mondal--Venkata Balaji \cite{Mondal} shared a preprint which also adopts the point of view that Gauss composition can be seen through the lens of the Clifford functor.  They prove functorial bijections (but not an equivalence of categories) for similarities and show that for similitude groups one can recover the Picard group when $2$ is a nonzerodivisor.  To show that the Clifford map is bijective on classes, they use the method of universal norms due to Bischel--Knus \cite{BK}.  


\begin{thebibliography}{KMRT98}
\bibitem[AFILSV]{AFILSV}
Eran Assaf, Dan Fretwell, Colin Ingalls, Adam Logan, Spencer Secord, and John Voight, \emph{Orthogonal modular forms attached to quaternary lattices}, in preparation.

\bibitem[Aue11]{Auel11}
Asher Auel, \emph{Clifford invariants of line bundle-valued quadratic forms}, MPIM preprint series\ \textbf{33} (2011).

\bibitem[Aue15]{Auel15}
Asher Auel, \emph{Surjectivity of the total Clifford invariant and Brauer dimension}, J. Algebra.\ \textbf{443} (2015), 395--421.

\bibitem[Bha04a]{Bhargava1}
Manjul Bhargava, \emph{Higher Composition Laws I: A New View on Gauss Composition, and Quadratic Generalizations}, Ann. Math.\ \textbf{159} (2004), no.~1, 217--250.

\bibitem[Bha04b]{Bhargava2}
Manjul Bhargava, \emph{Higher composition laws II: On cubic analogues of Gauss composition}, Ann. Math.\ \textbf{159} (2004), no.~2, 865--886.

\bibitem[Bha04c]{Bhargava3}
Manjul Bhargava, \emph{Higher composition laws III: The parametrization of quartic ringss}, Ann. Math.\ \textbf{159} (2004), no.~3, 1329--1360.

\bibitem[Bha08]{Bhargava4}
Manjul Bhargava, \emph{Higher composition laws IV: The parametrization of quintic rings}, Ann. Math.\ \textbf{167} (2008), no.~1, 53--94.

\bibitem[BK94]{BK}
W.~Bichsel and M.-A.~Knus, \emph{Quadratic forms with values in line bundles}, Recent advances in real algebraic geometry and quadratic forms (Berkeley, CA, 1990/1991; San Francisco, CA, 1991), Contemp.\ Math., vol.\ 155, Amer.\ Math.\ Soc., Providence, RI, 1994, 293--306. 

\bibitem[Bir91]{Birch}
Bryan John Birch, \emph{Hecke actions on classes of ternary quadratic forms}, Computational number theory (Debrecen, 1989), 1991, 191--212.

\bibitem[Bit25]{Bitan}
Rony A. Bitan, \emph{The Geometric GaussDedekind}, JTNB.\ \textbf{27} (2025), 373--387.

\bibitem[BD1972]{ButtsDulin}
Hubert Butts and Bill Dulin, \emph{Composition of binary quadratic forms over integral domains}, Acta Arithmetica \textbf{20} (1972), no.~3, 223--251.

\bibitem[BE1968]{ButtsEstes}
Hubert S. Butts and Dennis Estes, \emph{Modules and binary quadratic forms over integral domains}, Linear Algebra Appl.\ \textbf{1} (1968), no.~2, 153--180.

\bibitem[Cox22]{Cox}
David A. Cox, \emph{Primes of the Form $x^2+ny^2$ 
: Fermat, Class Field Theory, and Complex Multiplication. Third Edition with Solutions}, 
AMS Chelsea Publishing, 2022.

\bibitem[Dal24]{Dallaporta}
William Dallaporta, \emph{Recovering the Picard group of quadratic algebras from
Woods binary quadratic forms}, Int.\ J.\ Number Theory \textbf{21} (2025), no.~4, 739--767.

\bibitem[Dic1923]{Dickson23}
Leonard E. Dickson, \emph{History of the Theory of Numbers. Volume III: Quadratic and Higher Forms}, Carnegie Institution of Washington, 1923.

\bibitem[Dic1951]{Dickson51}
Leonard E. Dickson, \emph{Introduction to Number Theory}, 
The University of Chicago Press, 1951.

\bibitem[Dir99]{Dirichlet}
Richard Dedekind and Peter Gustav Lejeune Dirichlet, \emph{Vorlesungen uber Zahlentheorie}, 
Cambridge University Press, 2014.


\bibitem[DPRT21]{DummiganPacettiRamaTornaria}
Neil Dummigan, Ariel Pacetti, Gustavo Rama, and Gonzalo Tornara, \emph{Quinary forms and paramodular forms}, 2021, available at \url{https://arxiv.org/abs/2112.03797}.

\bibitem[Gau96]{Gauss}
Disquisitiones arithmeticae, \emph{Disquisitiones arithmeticae}, translated by Arthur A. Clarke, Yale University Press, 1996.

\bibitem[GL09]{GL}
Benedict H.\ Gross and Mark W.\ Lucianovic, \emph{On cubic rings and quaternion rings}, J.\ Number Theory \textbf{129} (2009), no.~6, 1468--1478. 

\bibitem[Hei16]{Hein}
Jeffery Hein, \emph{Orthogonal modular forms: an application to a conjecture of Birch, algorithms and computations}, Ph.D. thesis, Dartmouth College, 2016.

\bibitem[HTV25]{HeinTornariaVoight}
Jeffery Hein, Gonzalo Tornara, and John Voight, \emph{Computing Hilbert modular forms as orthogonal modular forms}, 2025, available at \url{https://arxiv.org/abs/2506.21981}.

\bibitem[Kap68]{Kaplansky}
Irving Kaplansky, \emph{Composition of binary quadratic forms}, Studia Math.\ \textbf{31} (1968), no.~5, 523--530.

\bibitem[Kne82]{Kneser}
Martin Kneser, \emph{Composition of binary quadratic forms}, J. Number Theory \textbf{15} (1982), no.~3, 406--413.

\bibitem[Knu91]{Knus}
Max-Albert Knus, \emph{Quadratic and Hermitian forms over rings}, Springer-Berlin, Heidelberg, 1991.

\bibitem[KMRT98]{bookofinv}
Max-Albert Knus, Alexander Merkurjev, Markus Rost, and Jean-Pierre Tignol, \emph{The book of involutions}, Amer.\ Math.\ Soc. Colloquium Publ., Amer.\ Math.\ Soc., Providence, RI, 1998.

\bibitem[Lub61]{Lubelski}
Salomon Lubelski, \emph{Unpublished results on number theory II. Composition theory of binary quadratic forms}, Acta Arithmetica,  \textbf{7} (1961), 9--17.

\bibitem[Mas2000]{Mastropietro}
Michael William Mastropietro, \emph{Quadratic forms and relative quadratic extensions},  Ph.D. thesis, University of California, San Diego, 2000.

\bibitem[MB2025]{Mondal}
Soham Mondal and T.\ E.\ Venkata Balaji, \emph{Classifying binary quadratic forms using Clifford invariants}, preprint, 2025.  

\bibitem[O'Do16]{O'Dorney}
Evan M. ODorney, \emph{Rings of small rank over a Dedekind domain and their ideals},  Research in the Mathematical Sciences\ \textbf{3} (2011).

\bibitem[RT20]{RamaTornaria}
Gustavo Rama and Gonzalo Tornara, \emph{Computation of paramodular forms}, ANTS XIV--Proceedings of the Fourteenth Algorithmic Number Theory Symposium, 2020, pp.~353--370.

\bibitem[Tow80]{Towber}
Jacob Towber, \emph{Composition of oriented binary quadratic form-classes over commutative rings}, Adv. Math.\ \textbf{36} (1980), no.~1, 1--107.

\bibitem[Voi11a]{Voight:quatring}
John Voight, \emph{Characterizing quaternion rings over an arbitrary base}, J.\ Reine Angew. Math. \textbf{657} (2011), 113--134.

\bibitem[Voi11b]{JVInvolution}
John Voight, \emph{Rings of low rank with a standard involution}, Illinois J. Math. \textbf{55} (2011), no.~3, 1135--1154.

\bibitem[Voi16]{Voight:quadmonoid} 
John Voight, \emph{Discriminants and the monoid of quadratic rings}, Pacific J. Math.\ \textbf{283} (2016), no.~2, 483--510.

\bibitem[Woo11]{Wood}
Melanie Matchett Wood, \emph{Gauss composition over an arbitrary base}, Adv. Math.\ \textbf{226} (2011), no.~2, 1756--1771.

\bibitem[Wu25]{Wu}
Haochen Wu, \emph{Hilbert modular forms from orthogonal modular forms on binary lattices}, 2025, preprint.

\bibitem[Zem21]{Zemkova}
Kristna Zemkov, \emph{Composition of binary quadratic forms over number fields}, Math. Slovaca \textbf{71} (2021), no.~6, 1339--1360.

\end{thebibliography}

\end{document}
