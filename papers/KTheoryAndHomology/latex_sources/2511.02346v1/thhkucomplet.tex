\section{Topological Hochschild homology of $ku$}
\label{chap:thhkucomplet}

Here we finish the computation of $\THH_*(ku)$. We will see that $u^{p-2}\sigma u$ is indeed a class of $\THH_{2p-1}(ku;ku/v_1)$ that can be compared to $\sigma v_1 \in \THH_*(\ell;H\Z_{(p)})$. We compute $\THH_*(ku;ku/v_1)$ in \cref{section:thhkuv1} using a comparison between the Brun spectral sequences \eqref{ss:lZ} and \eqref{ss:uTB} and the truncated Bockstein spectral sequence \eqref{ss:uT} -- which has fewer classes and is easier to track.

The techniques we developed in \cref{chap:truncated} can then be used to determine the $u$-Bockstein spectral sequence for $ku$, which is done in \cref{section:thhku}. We can compare the $v_1$-Bockstein spectral sequences \eqref{ss:l} and \eqref{ss:v1}, and the Bockstein spectral sequence \eqref{ss:u} can be recovered from the truncated Bockstein spectral sequence \eqref{ss:uT} and the gathered Bockstein spectral sequence \eqref{ss:v1}.

Lastly, the extensions can be computed from the differentials and bidegree constraints of the Bockstein spectral sequence \eqref{ss:u}, thus determining $\THH_*(ku)$ as $ku_*$-module.

Our $S$-algebra model for the quotient of $ku$ by $v_1$ will be
\begin{equation}
  ku/v_1 = ku\wedge_\ell H\Z_{(p)}
\end{equation}
which is also a $q$-cofibrant commutative $S$-algebra by remark VII.6.8 of \cite{elmendorf1997rings}.

\subsection{Computation of $\THH_*(ku;ku/v_1)$}
\label{section:thhkuv1}

We will now compute $\THH_*(ku;ku/v_1)$ using both a Brun spectral sequence and a Bockstein spectral sequence. The following results allow us to compute the first page of the Brun spectral sequences.
\begin{lemma}
  \begin{enumerate}[(a)]
  \item   $(ku/v_1\wedge_{ku} ku/v_1)_*\cong P_{p-1}(u)\otimes E(\sigma v_1)$ over $\Z_{(p)}$ with $|u|=2$ and $|\sigma v_1| = 2p-1$.
  \item   $V(0)_*(ku/v_1\wedge_{ku} ku/v_1)\cong P_{p-1}(u)\otimes E(\sigma v_1)$ over $\F_p$ with $|u|=2$ and $|\sigma v_1| = 2p-1$.
  \item $\THH_*(ku/v_1;H\Z_{(p)})\cong \THH_*(H\Z_{(p)})\otimes E(\sigma u) \otimes \Gamma(\varphi u)$ over $\Z_{(p)}$ with $|\sigma u|=3$ and $|\varphi u|=2p$.
  \item $\THH_*(ku/v_1;H\F_p)\cong V(0)_*\THH(H\Z_{(p)})\otimes E(\sigma u) \otimes \Gamma(\varphi u)$ over $\F_p$ with $|\sigma u|=3$ and $|\varphi u|=2p$.
  \end{enumerate}
\end{lemma}

\begin{proof}
  The Künneth spectral sequence computing $(ku/v_1\wedge_{ku} ku/v_1)_*$ has $E^2$-page $\operatorname{Tor}^{P(u)}_{*,*}(P_{p-1}(u),P_{p-1}(u)) = P_{p-1}(u)\otimes E(\sigma v_1)$ with $|u|=(0,2)$ and $|\sigma v_1|=(1,2p-2)$. For degree reasons, the spectral sequence collapse with no possible extensions, yielding $(a)$. Point $(b)$ follows from the absence of $p$-torsion.

  We use the Brun spectral sequence to compute $\THH_*(ku/v_1;H\Z_{(p)})$ and $\THH_*(ku/v_1;H\F_p)$:
  \begin{equation}
    \THH_*(H\Z_{(p)}; H(H\Z_{(p)}\wedge_{ku/v_1} H\Z_{(p)})_*) \Rightarrow \THH_*(ku/v_1;H\Z_{(p)})
  \end{equation}
  \begin{equation}
    \THH_*(H\F_p; H(H\F_p\wedge_{ku/v_1} H\F_p)_*) \Rightarrow \THH_*(ku/v_1;H\F_p) .
  \end{equation}

  The Künneth spectral sequence computing $(H\Z_{(p)}\wedge_{ku/v_1} H\Z_{(p)})_*$ has $E^2$-page $\operatorname{Tor}^{P_{p-1}(u)}_{*,*}(\Z_{(p)},\Z_{(p)})\cong E(\sigma u)\otimes \Gamma(\varphi u)$ with $|\sigma u|=(1,2)$ and $|\varphi u|=(2,2p-2)$. The indecomposables are $\sigma u$ and the divided power $\gamma_{p^i}\varphi u$. For bidegree reasons, they cannot support non-zero differentials, so the spectral sequence collapse with no possible extensions, and we have $(H\Z_{(p)}\wedge_{ku/v_1}H\Z_{(p)})_*\cong E(\sigma u) \otimes \Gamma(\varphi u)$. A similar argument yields $(H\F_p\wedge_{ku/v_1} H\F_p)_*\cong  E(\sigma u) \otimes \Gamma(\varphi u)$, this time over $\F_p$.

  Getting back to the Brun spectral sequences, when looking at the bidegrees modulo $2p$, we see that the indecomposables also cannot support non-zero differentials in both the integral and $V(0)$ case, so that the two spectral sequences collapse. The modulo $p$ $E^\infty$-page has exactly the right rank over $\F_p$ to fit into a long exact sequence of the multiplication by $p$ for the integral $E^\infty$-page. Having an extension in the integral spectral sequence would then mean that there is a non-zero differential in the modulo $p$ one. We conclude that there is no extension in the integral spectral sequence, and $(c)$ is proven. The modulo $p$ spectral sequence cannot have extensions, and we get $(d)$.
\end{proof}

We can write the following two spectral sequences computing $\THH$ of $ku$ with coefficients in $ku/v_1$. The first one, \eqref{ss:uT}, is a truncated Bockstein spectral sequence:
\begin{gather}
  \THH_*(ku;H\Z_{(p)})\botimes P_{p-1}(u) \cong \THH_*(H\Z_{(p)})\otimes E(\sigma u) \botimes P_{p-1}(u) \notag \\
  \Rightarrow \THH_*(ku;ku/v_1) \tag{$u_T$}; \label{ss:uT} \\
\end{gather}
The second one, \eqref{ss:uTB}, is a Brun spectral sequence:
\begin{gather}
  \THH_*(ku/v_1;H(ku/v_1\wedge_{ku}ku/v_1)_*) \notag \\
  \cong\THH_*(H\Z_{(p)}) \otimes E(\sigma u)\otimes \Gamma(\varphi u) \botimes E(\sigma v_1) \otimes P_{p-1}(u) \notag \\
  \Rightarrow \THH_*(ku;ku/v_1) \tag{$u_{TB}$}. \label{ss:uTB} \\
\end{gather}
The bidegrees are:
\begin{equation}
  \begin{aligned}
    & |\sigma u| = (3,0) \\
    & |\varphi u| = (2p,0) \\
    & |\mu_{kp}| = (2kp-1,0) \mbox{, $k\geq 1$ the generators of $\THH_*(H\Z_{(p)})$} \\
    & |u| = (0,2) \\
    & |\sigma v_1| = (0,2p-1).
  \end{aligned}
\end{equation}

For the following lemma, we will briefly use the non-truncated $u$-Bockstein spectral sequence ($u$) computing $\THH_*(ku)$ that we will study in the next section. It links the class $\sigma v_1$ of $\THH_*(\ell)$ to a class of $\THH_*(ku)$.
\begin{lemma}\label{prop:imagesigmav1}
  The map $\THH_*(\ell)\rightarrow \THH_*(ku)$ sends $\sigma v_1$ to a non-zero class represented up to a unit by $u^{p-2}\sigma u$ in the Bockstein spectral sequence computing $\THH_*(ku)$.
\end{lemma}
\begin{proof}
  Since $L$ is the (smashing) localization of $\ell$ at the Johnson-Wilson spectrum $E(1)$, we can conclude from \cref{prop:localizationthh} that there is a weak equivalence
  \begin{equation}
    \THH(L) \simeq \THH(\ell;L) .
  \end{equation}
  Similarly, there is a weak equivalence
  \begin{equation}
    \THH(KU) \simeq \THH(ku;KU) .
  \end{equation}

  $\THH(\ell;L)$ can be computed using a periodic Bockstein spectral sequence
  \begin{equation}
    \THH_*(\ell;H\Z_{(p)}) \botimes P(v_1,v_1^{-1}) \Rightarrow \THH_*(\ell;L) \tag{$L$} \label{ss:L}
  \end{equation}
  which is entirely determined by the map $\eqref{ss:l}\rightarrow \eqref{ss:L}$. In particular, we can see that $\sigma v_1$ is a generator over $\Q$ and $P_\Q(v_1,v_1^{-1})$ of the summand $\Sigma L_\Q$ in the splitting
  \begin{equation}
    \THH(L)_p \simeq (L\vee\Sigma L_\Q)_p.
  \end{equation}

  Since the splitting on $\THH(L)$ and $\THH(KU)$ are compatible, it must be that $\sigma v_1\in \THH_{2p-1}(\ell)$ is sent to a non-zero class in $\THH_{2p-1}(ku)$. There is also a relation $p\mu_p = \sigma v_1$, so that the only possibility is that the image of $\sigma v_1$ in $\THH_{2p-1}(ku)$ is represented by $u^{p-2}\sigma$ to get both the extension with $p\mu_p$ and the splitting of $\THH(KU)$.
\end{proof}

Since $\ell/v_1$ is just $H\Z_{(p)}$, we have a morphism between the Brun spectral sequences $\eqref{ss:lZ}\rightarrow \eqref{ss:uTB}$ induced by the inclusion of the summand $i:\ell\rightarrow ku$. This allows us to prove:
\begin{proposition}\label{prop:diffin6}
  In \eqref{ss:uTB}, there are differentials
  \begin{equation}
    d^{2p-4}(\gamma_k\varphi u)=u^{p-2}\sigma u\gamma_{k-1}\varphi u
  \end{equation}
  up to a unit for all $k\geq 1$.
\end{proposition}
\begin{proof}
  In the following commutative diagram:
  \begin{equation}
    \begin{tikzcd}
      \THH(\ell) \rar["i"] \dar["f"] & \THH(ku) \dar["f"] \\
      \THH(\ell;H\Z_{(p)}) \rar["i"] & \THH(ku;ku/v_1)
    \end{tikzcd}
  \end{equation}
  we have up to units, using \cref{prop:imagesigmav1}
  \begin{equation}
    f(i(\sigma v_1)) = f(u^{p-2}\sigma u) = u^{p-2} f(\sigma u) = i(f(\sigma v_1)) = i(\sigma v_1) .
  \end{equation}

  In order for this to be possible, there must be an extension $u\cdot u^{p-3}\sigma u = \sigma v_1$ in \eqref{ss:uTB}, and it must be that $u^{p-2}\sigma u$ is either a boundary or not an infinite cycle. Since it is an infinite cycle for degree reasons, it is a boundary. The only class in degree $2p$ is $\varphi u$, so up to a unit there is a differential $d^{2p-4}(\varphi u)=u^{p-2}\sigma u$ in \eqref{ss:uTB}.

  In the divided power algebra $\Gamma(\varphi u)$, $\varphi u\,\gamma_{k-1} \varphi u = k\,\gamma_k\varphi u$. We can then prove our formula by induction on $k$, using the facts that
  \begin{equation}
    k\,d(\gamma_k\varphi u) = d(\varphi u) \gamma_{k-1}\varphi u + \varphi u\,d(\gamma_{k-1}\varphi u)
  \end{equation}
  and that $\Z_{(p)}$ is an integral domain.
\end{proof}

We can now get a description of all the differentials in the truncated Bockstein spectral sequence \eqref{ss:uT}:
\begin{proposition}\label{prop:diffin5}
  In the spectral sequence \eqref{ss:uT}, the differentials are given by the formula:
  \begin{equation}
    d^{2p-4}(\mu_{(k+1)p})=p^{\nu(k)}u^{p-2}\sigma u\,\mu_{kp},\quad k\geq 1
  \end{equation}
  up to a unit, where $\nu$ is the $p$-adic valuation.
\end{proposition}
\begin{proof}
  The differentials given are the only possible in \eqref{ss:uT} for bidegree reasons; we only need to prove that they are indeed non-zero. We now know enough about \eqref{ss:uTB} to do so.

  By looking at the degrees modulo $2p$, we can list the classes of total degree $2kp - 1$ in $E^1$ of \eqref{ss:uTB}:
  \begin{equation}
    \mu_{kp}, \quad \gamma_{k-1}\varphi u\,\sigma v_1, \quad \gamma_{k-1}\varphi u\,u^{p-2}\sigma u,  \quad \gamma_i\varphi u\,\mu_{(k-i)p},\; 1\leq i < k .
  \end{equation}

  We know the following differentials in \eqref{ss:uTB}:
  \begin{equation}
    d^{2p-4}(\gamma_i\varphi u)=u^{p-2}\sigma u\gamma_{i-1}\varphi u
  \end{equation}
  for $i\geq 1$ from \cref{prop:diffin6};
  \begin{equation}
    d^{2p-1}(\mu_{(i+1)p})=p^{\nu(i)}\sigma v_1\mu_{ip}
  \end{equation}
  from the map $\eqref{ss:lZ}\rightarrow (u_{TB})$ and \cref{prop:diffin4};

  To complete the multiplicative description, we also note that $\sigma v_1$ is an infinite cycle for bidegree reasons, and that all the degreewise possible value for $d^{2p-4}(\mu_{(k-i)p})$ results in a non-zero $d^{2p-4}(\gamma_i\varphi u\,\mu_{(k-i)p})$.

  From this description, after $d^{2p-1}$ the only generator left in $E^{2p}_{2kp-1}$ is $p\mu_{kp}$, so that $\THH_{2kp-1}(ku;ku/v_1)$ is isomorphic to $\Z/p^{\nu(k)}\Z$. This proves our claim about \eqref{ss:uT}.
\end{proof}

We will now describe $\THH_*(ku;ku/v_1)$; once again, we will use $v_0$ to denote multiplication by $p$ in the $E^\infty$-page of the spectral sequence \eqref{ss:uT}, and $p\cdot$ to denote the multiplication in the target group.
\begin{proposition}
  $\THH_*(ku;ku/v_1)$ is generated as a $\Z_{(p)}[u]/(u^{p-1})$-module by
  \begin{equation}
    \begin{gathered}
      1,\, \sigma u,\, \mu_p \\
      v_0\mu_{kp},\, u\mu_{kp},\, k\geq 2 \\
      \sigma u\mu_{kp},\, k\geq 1 
    \end{gathered}
  \end{equation}
  with the relations:
  \begin{equation}
    \begin{aligned}
      u^{p-2}\cdot\sigma u & = p\cdot \mu_p \\
      u\cdot v_0\mu_{kp} & = p\cdot u\mu_{kp},\, k\geq 2 \\
      p^{\nu(k)+1}\cdot u\mu_{kp} & = 0 ,\, k\geq 2\\
      u^{p-3}\cdot u\mu_{kp} & = 0 ,\, k\geq 2\\
      p^{\nu(k)+1}\cdot \sigma u\mu_{kp} & = 0 ,\, k\geq 2 \\
      p^{\nu(k)}\cdot v_0\mu_{kp} & = 0,\, k\geq 2\\
      p^{\nu(k)}u^{p-2}\cdot \sigma u\mu_{kp} & = 0,\, k\geq 2.
    \end{aligned}
  \end{equation}
\end{proposition}
\begin{proof}
  Except for the extension $p\cdot \mu_p = u^{p-2}\sigma u$ this is the $E^\infty$-page of \eqref{ss:uT}. This extension is present in \eqref{ss:lZ}, and since from \cref{prop:imagesigmav1} the map $i:\THH_*(\ell;H\Z_{(p)})\rightarrow \THH_*(ku;ku/v_1)$ is such that $i(\sigma v_1) = u^{p-2}\sigma u$, and $i(\mu_p)=\mu_p$, it must be that $u^{p-2}\sigma u$ is also divisible by $p$ in $\THH_{2p-1}(ku;ku/v_1)$. The only possible extension is with $\mu_p$, so we get our formula up to a unit.
\end{proof}

Without the module structure, writing all the classes, this is:
\begin{equation}
  \begin{aligned}
    & \Z_{(p)}\{1,\, u,\, \dots,\, u^{p-2},\, \sigma u,\,  u\sigma u,\, \dots,\, u^{p-2}\sigma u,\,  \mu_p\} \\
    & \oplus\bigoplus_{k\geq 1} \faktor{\Z}{p^{\nu(k)+1}}\{u\mu_{kp},\, u^2\mu_{kp},\, \dots,\, u^{p-2}\mu_{kp}\} \\
    & \oplus\bigoplus_{k\geq 1} \faktor{\Z}{p^{\nu(k)+1}}\{\sigma u\mu_{kp},\, u\mu_{kp},\, \dots,\, u^{p-3}\mu_{kp}\} \\
    & \oplus\bigoplus_{k\geq 2} \faktor{\Z}{p^{\nu(k)}}\{v_0\mu_{kp},\, u^{p-2}\sigma u\mu_{kp}\}
  \end{aligned}
\end{equation}
with relations $u^{p-2}\sigma u = p\cdot \mu_p$ and $u\cdot v_0\mu_{kp}=p\cdot u\mu_{kp}$.


\subsection{Computation of the Bockstein spectral se\-quen\-ce for $\THH_*(ku)$}
\label{section:thhku}

We know enough of these first three spectral sequences to compute the fourth:
\begin{align}
    & \THH_*(\ell;H\Z_{(p)})\botimes P(v_1) && \Rightarrow \THH_*(\ell) \tag{\ref{ss:l}} \\
    & \THH_*(ku;H\Z_{(p)})\botimes P_{p-1}(u) && \Rightarrow \THH_*(ku;ku/v_1) \tag{\ref{ss:uT}} \\
    & \THH(ku;ku/v_1)\botimes P(v_1) && \Rightarrow \THH_*(ku) \tag{$v_1$} \label{ss:v1} \\
    & \THH_*(ku;H\Z_{(p)})\botimes P(u) && \Rightarrow \THH_*(ku). \tag{$u$} \label{ss:u}
\end{align}

From the map $\THH(\ell;H\Z_{(p)})\rightarrow \THH(k;ku/v_1)$ comes a morphism of spectral sequences $\eqref{ss:l}\rightarrow \eqref{ss:v1}$, which determines some differentials in \eqref{ss:v1}. These differentials, the one computed in the previous section in \eqref{ss:uT} and the lemmas relating a spectral sequence and its truncations yield a description of the differentials in \eqref{ss:u}.

\begin{theorem}\label{prop:diffinu}
  The differentials in \eqref{ss:u} are given by the formula:
  \begin{equation}
    d^{p^{n+1}-2}(p^n\mu_{(k+1)p^{n+1}}) = ku^{p^{n+1}-2}\sigma u \mu_{kp^{n+1}},\; k\geq 0,\; n\geq 0
  \end{equation}
  up to a unit and linearity with respect to multiplication by $u$.
\end{theorem}
\begin{proof}
  Here we make good use of our results on truncated spectral sequences.

  First, the differentials in \eqref{ss:uT} from \cref{prop:diffin5} are lifted to \eqref{ss:u} using \cref{prop:totalandsmall}, that is in \eqref{ss:u} there are differentials:
  \begin{equation}
     \quad d^{2p-4}(\mu_{(k+1)p})=p^{\nu(k)}u^{p-2}\sigma u\,\mu_{kp},\quad k\geq 1 \label{eq:somediffinu}
  \end{equation}
  and the corresponding differentials obtained by multplying the source and the target by any power of $u$. These are the only differentials $d^r$ with $2\leq r\leq 2p-4$ in \eqref{ss:u} since these are the only differentials in \eqref{ss:uT}, again using \cref{prop:totalandsmall}.

  We will now use \cref{prop:totaltotruncated} and \cref{prop:truncatedtototal}. With regard to \cref{prop:truncatedtototal}, in our current computation, a statement stronger than the general case can be made. The general case would say that a differential $d(x)=y$ in \eqref{ss:v1} would result in the existence of an element $x'$ such that $d(x')=y$ in \eqref{ss:v1}, and such that this differential can be lifted to one in \eqref{ss:u}; but in \eqref{ss:v1}, each generator is alone in its bidegree, so that necessarily $x=x'$. So each differential $d(x)=y$ in \eqref{ss:v1} can really be lifted to a differential $d(x)=y$ in \eqref{ss:u}.

  Using \cref{prop:totaltotruncated}, the differentials of formula \eqref{eq:somediffinu} results in \eqref{ss:v1} in
  \begin{equation}
    d^1(u^i\mu_{(k+1)p})=p^{\nu(k)}v_1u^{i-1}\sigma u\,\mu_{kp},\quad k\geq 1,\quad 1\leq i\leq p-2
  \end{equation}
  and the corresponding differentials obtained by multiplying the source and the target by any power of $v_1$. These are the only differentials $d^{2p-2}$ in \eqref{ss:v1} since having more differentials would result in more differentials $d^r$ in \eqref{ss:u} with $2\leq r \leq 2p-4$. This gives the $E^2$-page of \eqref{ss:v1}:
  \begin{equation}
    \begin{aligned}
      \eqref{ss:v1} :\; E^2 \cong & \Z_{(p)}\{1,\, u,\, \dots,\, u^{p-2},\, \sigma u,\,  u\sigma u,\, \dots,\, u^{p-3}\sigma u,\,  \mu_p\}\otimes P(v_1) \\
                         &  \oplus\bigoplus_{k\geq 2} \faktor{\Z}{p^{\nu(k)}}\{v_0\mu_{kp}\}\otimes P_{p-1}(u)\otimes P(v_1) \\
                         & \oplus\bigoplus_{k\geq 1} \faktor{\Z}{p^{\nu(k)+1}}\{\sigma u\mu_{kp},\, u\,\sigma u\mu_{kp},\, \dots,\, u^{p-3}\sigma u\mu_{kp}\} \\
                         & \oplus\bigoplus_{k\geq 1} \faktor{\Z}{p^{\nu(k)}}\{u^{p-2}\sigma u\mu_{kp},\, v_1\sigma u\mu_{kp},\, u\,v_1\sigma u\mu_{kp},\, \dots\}.
    \end{aligned}
  \end{equation}

  We have written all the generators $v_0\mu_{kp}$ with $v_0$ because we will now account for the differentials in \eqref{ss:l} of \cref{prop:diffinell}:
  \begin{equation}
    d^{p^n+\dots +p}(p^{n-1}\cdot v_0\mu_{kp^n}) = (k-1) v_1^{p^n+\dots+p}\sigma v_1\mu_{(k-1)p^n},\; k\geq 1,\; n\geq 1.
  \end{equation}
  Because of the morphism of spectral sequence $(\ell) \rightarrow (v_1)$, that formula is also true in \eqref{ss:v1}, and from \cref{prop:truncatedtototal} we deduce the formula in \eqref{ss:u} that was claimed (which also encompass formula \eqref{eq:somediffinu}).

  It remains to prove that the classes $\sigma u \mu_{kp},\, k\geq 1$ are infinite cycles in \eqref{ss:u}. The classes $u^{p-2}\sigma u \mu_{kp^2},\,k\geq 1$ are in the image of $\eqref{ss:l}\rightarrow \eqref{ss:v1}$ and so are infinite cycles in \eqref{ss:v1}, thus also in \eqref{ss:u} by \cref{prop:nulldiffs}. Since in \eqref{ss:u} the only $u^{p-2}$-torsion is in even degree, it must be that $\sigma u \mu_{kp^2}$ are infinite cycles in \eqref{ss:u}. The remaining classes to check are the $\sigma u\mu_{kp}$ with $p$ not dividing $k$. Once again we now that these classes support no differentials of height up to $u^{p-2}$, and are of $u^{p-2}$-torsion after $d^{p-2}$ by formula \eqref{eq:somediffinu}. If some $\sigma u\mu_{kp}$ supports a non-zero differential the target must be $p^{\nu(k-i)}u^{ip+1}\mu_{(k-i)p},\, 1\leq i \leq k-1$ for degree reasons, and that target must be of $u^{p-2}$-torsion, that is to say some
  \begin{equation}
    \begin{gathered}
      p^{\nu(k-i)}u^{ip+2}\mu_{(k-i)p}, \\
      p^{\nu(k-i)}u^{ip+3}\mu_{(k-i)p}, \\
      \vdots \\
      p^{\nu(k-i)}u^{ip+p-1}\mu_{(k-i)p}
    \end{gathered}
  \end{equation}
  is already the target of a differential. But the only possible differentials still not accounted for are the one targeting $p^{\nu(k-i)}u^{ip+1}\mu_{(k-i)p},\, 1\leq i \leq k-1$, and these are of height $u^h$ with $h$ reducing to 1 modulo $p$.
\end{proof}

We can change our generators so that the differentials are not given up to a unit but exactly.
\begin{proposition} \label{prop:diffexactes}
  We can change the generators $\mu_N$ and $\sigma u\mu_N$ of $\THH_*(ku;H\Z_{(p)})$ with a multiplication by a unit so that the differentials in \eqref{ss:u} are given by the formula:
  \begin{equation}
    d^{p^{n+1}-2}(p^n\mu_{(k+1)p^{n+1}}) = p^{\nu(k)}u^{p^{n+1}-2}\sigma u \mu_{kp^{n+1}},\; k\geq 0,\; n\geq 0
  \end{equation}
\end{proposition}
\begin{proof}
  Note that we have chosen $p^{\nu(k)}$ instead of $k$, but these are the same up to a unit. We could have written the same statement with $k$.

  The differentials are making the $\mu_N$ and $\sigma u\mu_{N}$ interact, and once we have chosen a specific unit for one of them, we have to use the same unit for all their multiplication by powers of $p$. Consider the simple, unoriented graph $\mathcal{G}$ whose vertices are the $\mu_N$ and $\sigma u \mu_N$ for $N \geq 0$ divisible by $p$, with an edge $\mu_N \text{---}\sigma u\mu_{N'}$ whenever there is a differential
  \begin{equation}
    d(p^i\mu_N) = p^ju^\bullet\sigma u\mu_{N'}
  \end{equation}
  for any $i$ and $j$, up to a unit, in the spectral sequence. The graph $\mathcal{G}$ is bipartite, with classes given by the presence or absence of $\sigma u$ in the vertex name. If we prove that $\mathcal{G}$ is acyclic, then we have proven our statement. Indeed, $\mathcal{G}$ is then a collection of tree; we can choose an arbitrary root in each connected component of $\mathcal{G}$; starting from the roots, we can change each generation of the trees by a unit to get the formula we want.

  We will reason on the $p$-adic valuation of $N$ and $N'$, denoted $\nu(N)$ and $\nu(N')$. There is an edge $\mu_N \text{---}\sigma u\mu_{N'}$ in $\mathcal{G}$ if and only if there exists $(k,n) \in \N^2$ such that
  \begin{equation}
    N = (k+1)p^{n+1} \quad N' = kp^{n+1}.
  \end{equation}

  Fix $N$, $k$ and $n$ that $N = (k+1)p^{n+1}$, let $N' = kp^{n+1}$. Then
  \begin{equation}
    \nu(N') \geq \nu(N) \iff n+1 = \nu(N)
  \end{equation}
  so that there can only be one edge $\mu_N\text{---}\sigma u\mu_{N'}$ such that $\nu(N') \geq \nu(N)$.

   Fix $N'$, $k$ and $n$ that $N' = kp^{n+1}$, let $N = (k+1)p^{n+1}$. Then
  \begin{equation}
    \nu(N) \geq \nu(N') \iff n+1 = \nu(N')
  \end{equation}
  so that there can only be one edge $\sigma u\mu_{N'}\text{---}\mu_{N}$ such that $\nu(N) \geq \nu(N')$.

  Combining both case, we see that from any vertex of $\mathcal{G}$, there is exactly one edge such that the $p$-adic valuation is non-decreasing. If there were a non-trivial cycle in $\mathcal{G}$, we could extract an irreducible cycle, that goes through any edge at most one time. Such cycle would be confined to vertices whose $p$-adic valuation is constant, otherwise each edge would strictly decrease the valuation. But any vertex has at most one neighboor whose $p$-adic valuation is the same, thus $\mathcal{G}$ is acyclic.
\end{proof}

\subsection{Computing the extensions and a presentation of $\THH_*(ku)$}

We first compute the extensions in the torsion-free part of the spectral sequence, from the knowledge that the $p$-torsion and the $u$-torsion must be the same in $\THH_*(ku)$.
\begin{proposition}
  The torsion-free part of $\THH_*(ku)$ is a quotient of
  \begin{equation}
    P(u)\otimes \Z_{(p)}\{1,\,\sigma u,\, \mu_p,\,v_0\mu_{p^2},\,v_0^2\mu_{p^3},\,\dots \}
  \end{equation}
  with relations
  \begin{equation}
    p\cdot \mu_p = u^{p-2}\sigma u
  \end{equation}
  \begin{equation}
    p\cdot v_0^n\mu_{p^{n+1}} = u^{p^{n+1}-p^n}v_0^{n-1}\mu_{p^n},\, n\geq 1.
  \end{equation}
\end{proposition}
\begin{proof}
  From the differentials of \cref{prop:diffinu}, the generators written are the only one not of $u$-torsion. We already know from \cref{prop:torsioncoincide} that they must not be of $p$-torsion. We will see that it implies that the extensions given are present. The $u$-tower over 1 is in even degree, so no extension are possible with the rest of the classes. We prove the rest of our formula by induction on $n$. Let us first observe that each extension must be with an element not already divisible by $p$; otherwise if $p\cdot v_0^n\mu_{p^{n+1}}=p\cdot u^kx$ for some $k\geq 1$ and $x$, then $v_0^n\mu_{p^{n+1}} - u^kx$ would be an element of $p$-torsion, but represented by an element not of $u$-torsion in the spectral sequence, so not of $u$-torsion. Then $u^{p-2}\sigma u$ is the only choice (up to a unit) for $p\cdot \mu_{p}$. Let $n\geq 1$.  If our formula holds up to rank $n-1$, then $p\cdot v_0^n\mu_{p^{n+1}}$ could degreewise be:
  \begin{equation}
    \begin{gathered}
      u^{p^{n+1}-2}\sigma u \\
      u^{p^{n+1}-p}\mu_p \\
      u^{p^{n+1}-p^2}v_0\mu_{p^2} \\
      \vdots \\
      u^{p^{n+1}-p^n}v_0^{n-1}\mu_{p^n} \\
    \end{gathered}
  \end{equation}
  but the only one not already divisible by $p$ is $u^{p^{n+1}-p^n}v_0^{n-1}\mu_{p^n}$.
\end{proof}

We now give a presentation of the torsion. Before computing the extensions, we need to ensure that the lifts of the classes of the spectral sequence we choose have the correct properties.

\begin{lemma} \label{lem:liftinssu}
  For any $n\geq 1$, $0\leq h < n$ and $a\geq 1$, $a$ not divisible by $p$, the infinite cycle
  \begin{equation}
    p^h\sigma u \mu_{ap^n}
  \end{equation}
  of the spectral sequence \eqref{ss:u} lifts to an element
  \begin{equation}
    v_0^h\sigma u\mu_{ap^n}
  \end{equation}
  in $\THH_*(ku)$ such that
  \begin{equation} \label{eq:thhkuliftuzero}
    u^{p^{n-h}-2}\cdot v_0^h\sigma u \mu_{ap^n} = 0 
  \end{equation}
  and if $a = bp + p - 1$ for some $b \geq 1$,
  \begin{equation} \label{eq:thhkuliftpzero}
    p\cdot u^{p^n-3}\cdot \sigma u\mu_{(bp + p -1)p^n} = u^{p^{n+1} - 3} v_0^{\nu(b)}\sigma u\mu_{bp^{n+1}}
  \end{equation}
  otherwise we have
  \begin{equation} \label{eq:thhkuliftpzeronotdiv}
    p\cdot u^{p^n-3}\cdot v_0^h\sigma u\mu_{ap^n} = 0.
  \end{equation}
  Moreover, in both case, $p \cdot v_0^h\sigma u\mu_{ap^n}$ and $v_0^{h + 1}\sigma u \mu_{ap^n}$ differ only by an element divisible by $u$.
\end{lemma}

\begin{proof}
  We see these relations in the exact couple defining the spectral sequence \eqref{ss:u}. Since there are differentials
  \begin{equation}
    d^{p^{n+1}-2}(p^n\mu_{(k+1)p^{n+1}}) = p^{\nu(k)}u^{p^{n+1}-2}\sigma u \mu_{kp^{n+1}},\; k\geq 0,\; n\geq 0
  \end{equation}
  we can populate the diagram
    \begin{equation}
    \begin{tikzcd}[column sep = small]
      A \ar[rr, "u"] & & A \ar[rr, "u"] \ar[dl, "j"] & & ... \ar[rr, "u"] & & A \ar[rr, "u"] & & A \ar[dl, "j"] \\
      & B \ar[ul, "\partial"] & & &   & & & B \ar[ul, "\partial"] & \\
      & & \alpha \ar[rr, mapsto] \ar[dl, mapsto] & & ... \ar[rr, mapsto] & & \beta \ar[rr, mapsto] & & 0 \\
      & p^{\nu(k)}\sigma u\mu_{kp^{n+1}} & & &   & & & p^n\mu_{(k+1)p^{n+1}} \ar[ul, mapsto] &
    \end{tikzcd}
  \end{equation}
  where $A = \THH_*(ku)$ and $B=\THH_*(ku;H\Z_{(p)})$. Here we set $\beta = \partial(p^n\mu_{(k+1)p^{n+1}})$. The existence of the differential ensure that $\beta$ lifts $p^{n+1}-3$ times through the multiplication by $u$ map to an element $\alpha\in\THH_*(ku)$, and that $j(\alpha) = p^{\nu(k)}\sigma u \mu_{kp^{n+1}}$, that is $\alpha$ is represented by the the infinite cycle $p^{\nu(k)}\sigma u \mu_{kp^{n+1}}$ of the spectral sequence. We then name that element of $\THH_*(ku)$
  \begin{equation}
    \alpha = v_0^{\nu(k)}\sigma u\mu_{kp^{n+1}}
  \end{equation}
 which implies that
 \begin{equation}
   \begin{aligned}
     u^{p^{n+1}-3}v_0^{\nu(k)}\sigma u\mu_{kp^{n+1}} & = \beta \\
     u^{p^{n+1}-2}v_0^{\nu(k)}\sigma u\mu_{kp^{n+1}} & = 0
   \end{aligned}
 \end{equation}
 which is another way to write \cref{eq:thhkuliftuzero}.
 
 Moreover, the map $\partial$ is a map of $\Z_{(p)}$-modules. Thus,
 \begin{equation}
   \partial(p^{n+1}\mu_{(k+1)p^{n+1}}) = p\cdot \partial(p^n\mu_{(k+1)p^{n+1}}) \in \THH_*(ku).
 \end{equation}
 When $k+1$ is divisible by $p$, write $k= bp + p - 1$ so that $k+1 = (b+1)p$, the left hand side is already named
 \begin{equation}
  \partial (p^{n+1}\mu_{(b+1)p^{n+2}}) = u^{p^{n+2}-3}v_0^{\nu(b)}\sigma u \mu_{bp^{n+2}}
 \end{equation}
 and the right hand side is
 \begin{equation}
   \begin{aligned}
     p\cdot \partial(p^n\mu_{(b+1)p^{n+2}})
     & = p\cdot u^{p^{n+1} - 3}v_0^{\nu((b+1)p - 1)} \sigma u\mu_{((b+1)p - 1)p^{n+1}} \\
     & = p\cdot u^{p^{n+1} - 3}\sigma u\mu_{(bp + p - 1)p^{n+1}}
   \end{aligned}
 \end{equation}
 which yields \cref{eq:thhkuliftpzero} written with $n\geq 0$ instead of $n \geq 1$.

 If $k+1$ is not divisible by $p$, we have $p^{n+1}\mu_{(k+1)p^{n+1}} = 0$ in $\THH_*(ku;H\Z_{(p)})$ so
 \begin{equation}
   p\cdot \partial(p^n\mu_{(k+1)p^{n+1}}) = p\cdot u^{p^{n+1} - 3}v_0^{\nu(k)} \sigma u\mu_{kp^{n+1}} = 0
 \end{equation}
 which is \cref{eq:thhkuliftpzeronotdiv}.

 In both cases, we have
 \begin{equation}
   j(p\cdot v_0^h\sigma u\mu_{ap^n}) = p^{h+1}\sigma u \mu_{ap^n} = j(v_0^{h+1}\sigma u \mu_{ap^n})
 \end{equation}
 that is $p\cdot v_0^h\sigma u\mu_{ap^n}$ and $v_0^{h+1}\sigma u\mu_{ap^n}$ are represented by the same class in the spectral sequence. By exactness of the diagram their difference must be a multiple of $u$.
\end{proof}

Having constructed lifts of all the infinite cycles of torsion, we can recover the torsion extensions.
\begin{proposition}
  The torsion $ku_*$-sub-module of $\THH_*(ku)$ is presented by the classes
  \begin{equation}
    v_0^h\sigma u\mu_{ap^n}
  \end{equation}
  in degree $2ap^n+2$ where $h$, $a$ and $n$ are integers such that $h\geq 0$, $n\geq 1$, $a\geq 1$ and p does not divide $a$, together with the relations:
  \begin{enumerate}
  \item $v_0^{h} \sigma u \mu_{ap^n} = 0$ for any $a \geq 1$ not divisible by $p$, $n \geq 1$ and $h \geq n$.
  \item $u^{p^{n-h}-2}\cdot v_0^h\sigma u \mu_{ap^n} = 0$ for any $a \geq 1$ not divisible by $p$,  $n \geq 1$ and $0 \leq h \leq n - 1$.
  \item $p\cdot \sigma u \mu_{(bp+p-1)p^n} = v_0\sigma u\mu_{(bp+p-1)p^n}+u^{p^{n+1}-p^n}v_0^{\nu(b)}\sigma u \mu_{bp^{n+1}}$ for any $b\geq 1$ and any $n \geq 1$.
  \item  $p\cdot v_0^h\sigma u \mu_{ap^n} = v_0^{h+1}\sigma u \mu_{ap^n}$ for any $a \geq 1$ not divisible by $p$, $n \geq 1$ and $h\geq 1$ or $h=0$ not in case 3.
  \end{enumerate}
\end{proposition}

\begin{proof}
  The lifts of \cref{lem:liftinssu} have the claimed properties. Point 1 follows from the order with respect to multiplication by $p$ in the $E^\infty$-page of the spectral sequence. Point 2 is proven in the lemma. We need to check 3 and 4. For any integer $m$ and any $h \geq 0$, the lemma state that in $\THH_*(ku)$, $p\cdot v_0^h\sigma u\mu_m$ must be equal to $v_0^{h+1}\sigma u\mu_m + u\alpha$ for some $\alpha\in\THH_{*-2}(ku)$. 
  
  We examine claim 3. Let $b\geq 1$ and $n\geq 1$. Since
  \begin{equation}
    p\cdot u^{p^n-3}\cdot \sigma u\mu_{(bp + p -1)p^n} = u^{p^{n+1} - 3} v_0^{\nu(b)}\sigma u\mu_{bp^{n+1}}
  \end{equation}
  we must have
  \begin{equation}
    p\cdot \sigma u\mu_{(bp + p -1)p^n} = v_0\sigma u\mu_{(bp + p -1)p^n} + u^{p^{n+1} - p^n} v_0^{\nu(b)}\sigma u\mu_{bp^{n+1}} + u\alpha
  \end{equation}
  with $\alpha$ such that $u^{p^n-2} \alpha = 0$.

  We now examine claim 4. Let $a \geq 1$ not divisible by $p$, $h\geq 0$ and $n\geq 1$. As before, we must have
  \begin{equation}
    p\cdot v_0^h\sigma u\mu_{ap^n} = v_0^{h+1}\sigma u \mu_{ap^n} + u\alpha
  \end{equation}
  with $u^{p^{n-h}-2}\alpha = 0$.

  We will prove that in both cases, $\alpha$ must be zero. Since \cref{lem:liftinssu} lift all the torsion classes of the spectral sequence, $\alpha$ must be written with the elements we have lifted. Let $a \geq 1$ not divisible by $p$, $h\geq 0$ and $n\geq 1$ be fixed (for claim 3, we can set $a = bp + p -1$ and $h =0$). To write $\alpha$, we need to find $c\geq 1$ not divisible by $p$, $m\geq 1$ and $k\geq 0$ such that
  \begin{equation}\label{eq:forsTinTHHku}
    |v_0^k\sigma u\mu_{cp^m}| < |v_0^h\sigma u\mu_{ap^n}| < |u^{p^{m-k}-2}v_0^k\sigma u\mu_{cp^m}| \leq |u^{p^{n-h}-2}v_0^h\sigma u\mu_{ap^n}|
  \end{equation}
  in order for the $u$-tower above $\alpha$ to end before the $u$-tower above $v_0^h\sigma u \mu_{ap^n}$.

  Computing the degree, we get
  \begin{equation}
    \begin{gathered}
      2cp^m + 2 < 2ap^n + 2 < 2cp^m + 2 + 2(p^{m - k} - 2) < 2ap^n + 2 + 2(p^{n-h} - 2) \\
      \iff 0 < ap^n - cp^m < p^{m - k} - 2 < ap^n - cp^m + p^{n - h} - 2.
    \end{gathered}
  \end{equation}

  If $m \leq n$, dividing by $p^m$ we get
  \begin{equation}
    0 < ap^{n - m} - c < p^{-k} - 2p^{-m} < ap^{n-m}-c +p^{n-m-h} - 2p^{-m}
  \end{equation}
  which is impossible since $ap^{n-m} -c$ is an integer.

  If $m > n$, dividing by $p^n$ we get
  \begin{equation}
    \begin{gathered}
      0 < a - cp^{m -n} < p^{m - n - k} - 2p^{-n} < a - cp^{m - n} + p^{-h} - 2p^{-n} \\
      \iff 2p^{-n} < a - cp^{m -n} + 2p^{-n}< p^{m - n - k} < a - cp^{m - n} + p^{-h}.
    \end{gathered}
  \end{equation}
  so that $p^{m - n -k} \geq 1$ must be an integer since $a - cp^{m - n}$ is also an integer. But there can be no integer in the open interval $(a - cp^{m-n} + 2p^{-n}, a - cp^{m-n} + p^{-h})$.

  Then $\alpha$ must be zero. The only extensions that are possible in terms of degree are the one we have written, and then we know they happen because we know the relations at the top of the $u$-towers.
\end{proof}



From the two previous results, we can give a presentation of $\THH_*(ku)$ as a $ku_*$-module.
\begin{theorem} \label{prop:thhku}
  $\THH_*(ku)$ is a quotient of the $\Z_{(p)}[u]$-module
  \begin{multline}
   \Z_{(p)}[u]\{1,\,\sigma u,\, v_0^n\mu_{p^{n+1}},\,n\geq 0\} \\
    \oplus \Z_{(p)}[u]\{v_0^h\sigma u\mu_{ap^n},\, n\geq 1,\, a\geq 1,\, \mbox{$a$ not divisible by $p$},\, h\geq 0\}
  \end{multline}
  by the relations in the non-torsion part:
  \begin{itemize}
  \item $p\cdot \mu_p = u^{p-2}\sigma u$.
  \item $p\cdot v_0^n\mu_{p^{n+1}} = u^{p^{n+1}-p^n}v_0^{n-1}\mu_{p^n}$ for any $n\geq 1$.
  \end{itemize}
  and the relations in the torsion part:
  \begin{itemize}
  \item $v_0^{h} \sigma u \mu_{ap^n} = 0$ for any $a\geq 1$ not divisible by $p$, $n \geq 1$, and $h \geq n$.
  \item $u^{p^{n-h}-2}\cdot v_0^h\sigma u \mu_{ap^n} = 0$ for any $a \geq 1$ not divisible by $p$,  $n\geq 1$, and $0 \leq h \leq n - 1$.
  \item $p\cdot \sigma u \mu_{(bp+p-1)p^n} = v_0\sigma u\mu_{(bp+p-1)p^n}+u^{p^{n+1}-p^n}v_0^{\nu(b)}\sigma u \mu_{bp^{n+1}}$ for any $b\geq 1$ and any $n\geq 1$.
  \item $p\cdot v_0^h\sigma u \mu_{ap^n} = v_0^{h+1}\sigma u \mu_{ap^n}$ for any $a\geq 1$ not divisible by $p$, $n\geq 1$ and $h\geq 1$ or $h=0$ not in the previous case.
  \end{itemize}
  The degrees are:
  \begin{equation}
    \begin{aligned}
      & |\mu_{kp}| = 2kp - 1 \\
      & |\sigma u| = 3 \\
      & |v_0| = 0 \\
      & |u| = 2
    \end{aligned}
  \end{equation}
  and $\nu$ is the $p$-adic valuation.
\end{theorem}

As studied in \cite{angeltveit2010topological} for $\THH_*(\ell)$, the torsion modules of $\THH_*(ku)$ are divided into periodic submodules $T_n$ for $n\geq 1$. Each $T_n$ correspond to the submodules of the torsion elements of degrees between $|\sigma u \mu_{p^n}|= 2p^n+2$ and $|\sigma u\mu_{2p^n}| - 1 = 2(2p^n) +1$. Each of these appears $p-1$ times, by replacing the leftmost class with $\sigma u\mu_{kp^n}$ for $1 \leq k \leq p - 1$, and $p$ copies (as submodules or quotients) of $T_n$ are present in $T_{n+1}$, so $T_n$ appears an infinite numbers of times. In the following figures, the generators are named and placed on the bottom horizontal line; the rest of the non-zero class are indicated by a $\circ$ when they come from $\THH_*(\ell)$, a $\bullet$ otherwise; going straight up indicate a multiplication by $p$, and going upward and right is a multiplication by $u$; when two lines go up from a single class, it means the multiplication by $p$ is the sum of the two elements reached. None of the named classes come from $\THH_*(\ell)$.

\input{fig1}

We can see that $\THH_*(ku)$ is not $\THH_*(\ell)$ \emph{étale}, by which we mean that
\begin{equation}
  \THH_*(ku) \neq ku_* \otimes_{\ell_*} \THH_*(\ell).
\end{equation}
The extensions of scalars, however, does yield an injection, and in fact a short exact sequence
\begin{equation}
  \begin{tikzcd}
    0 \rar & ku_*\otimes_{\ell_*} \THH_*(\ell) \rar & \THH_*(ku) \rar & \mathcal{C} \rar & 0
  \end{tikzcd}
\end{equation}
where the cokernel $\mathcal{C}$ can be presented as the quotient of the $\Z_{(p)}[u]$-module
\begin{equation}
  P_{p-2}(u)\otimes \Z_{(p)}\{1,\,\sigma u,\,\sigma u\mu_{ap^n},\, n\geq 1,\, a\geq 1,\, \mbox{$a$ not divisible by $p$}\}
\end{equation}
by the relation $p^{n} \sigma u \mu_{ap^n} = 0$ for any $a$ and $n$, $a$ not divisible by $p$.


%
%
%
%
