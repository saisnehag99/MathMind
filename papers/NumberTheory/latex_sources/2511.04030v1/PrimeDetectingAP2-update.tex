\documentclass[11pt,oneside,reqno]{amsart}
\usepackage{amssymb,amsmath,amsthm}
\usepackage{a4wide,comment,enumitem,url}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage{bm}
\usepackage{float}
%\usepackage{tabls}

\pagestyle{myheadings}
%\hoffset=-0.8true in
\hoffset=-0.15true in

\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{amsmath,amsopn,amssymb,amsfonts,stmaryrd}
\usepackage{verbatim}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{color}
%\usepackage{simplewick}
\usepackage{enumitem}
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{bbm}
\usepackage{mathrsfs}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{cancel}
\usepackage{tensor}
\usepackage{cleveref}
%\usepackage{refcheck}
\usepackage{ulem}

\newtheorem*{c41}{Conjecture}

\newcommand{\IR}{{\mathbb R}}%Reals
\newcommand{\IRm}{\IR^{\times}}%non-zero real
\newcommand{\IRp}{\IR^+}%positive real
\newcommand{\IC}{{\mathbb C}}%Complex
\newcommand{\ICm}{\IC^{\times}}%non-zero complex
\newcommand{\IP}{{\mathbb P}}%Projective
\newcommand{\IZ}{{\mathbb Z}}%Integers
\newcommand{\IZp}{\IZ^+}%Positive integers
\newcommand{\IZm}{\IZ^{-}}%Negative integers
\newcommand{\IZx}{\IZ^{\times}}%non-zero integers
\newcommand{\IN}{{\mathbb N}}%Natural numbers
\newcommand{\IQ}{{\mathbb Q}}%Rationals
\newcommand{\IQm}{{\mathbb Q}^{\times}}%non-zero rationals
\newcommand{\IQp}{{\mathbb Q}^+}%positive rationals
\newcommand{\IQc}{\overline{\QQ}}%Algebraic closure of the rationals
\newcommand{\IO}{{\mathbb O}}%Octonions
\newcommand{\IH}{{\mathbb H}}%quaternions
\newcommand{\IF}{{\mathbb F}}%finite field
\renewcommand{\S}{\mathbb{S}}
\renewcommand{\H}{\mathbb{H}}

\newcommand{\CA}{\mathcal{A}}
\newcommand{\CB}{\mathcal{B}}
\newcommand{\CC}{\mathcal{C}}
\newcommand{\CD}{\mathcal{D}}
\newcommand{\CE}{\mathcal{E}}
\newcommand{\CF}{\mathcal{F}}
\newcommand{\CG}{\mathcal{G}}
\newcommand{\CH}{\mathcal{H}}
\newcommand{\CI}{\mathcal{I}}
\newcommand{\CJ}{\mathcal{J}}
\newcommand{\CK}{\mathcal{K}}
\newcommand{\CL}{\mathcal{L}}
\newcommand{\CM}{\mathcal{M}}
\newcommand{\CN}{\mathcal{N}}
\newcommand{\CO}{\mathcal{O}}
\newcommand{\CR}{\mathcal{R}}
\newcommand{\CS}{\mathcal{S}}
\newcommand{\CT}{\mathcal{T}}
\newcommand{\CX}{\mathcal{X}}
\newcommand{\CZ}{\mathcal{Z}}

\renewcommand{\Im}{{\rm Im}}
\newcommand{\IRe}{{\rm Re}}
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\tr}{\mathrm{tr}}
\newcommand{\Pf}{\mbox{Pf}}
\newcommand{\sgn}{\mbox{sgn}}
\newcommand{\vc}[1]{\mathbf{#1}}


\newcommand{\SU}{\mathrm{SU}}
\newcommand{\SO}{\mathrm{SO}}
\newcommand{\USp}{\mathrm{USp}}
\newcommand{\U}{\mathrm{U}}
\newcommand{\Spin}{\mathrm{Spin}}
\newcommand{\Pin}{\mathrm{Pin}}
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\PSL}{\mathrm{PSL}}
\newcommand{\GL}{\mathrm{GL}}
\newcommand{\Cliff}{\mathrm{Cliff}}
\renewcommand{\O}{\mathrm{O}}


\newcommand{\su}[1]{{\mathfrak{su}_{#1}}}
\newcommand{\so}[1]{{\mathfrak{so}_{#1}}}
\renewcommand{\sp}[1]{{\mathfrak{sp}_{#1}}}
\newcommand{\eee}{{\mathfrak{e}}}
\renewcommand{\ggg}{{\mathfrak{g}}}
\newcommand{\fff}{{\mathfrak{f}}}
\newcommand{\zz}{\mathfrak{z}}


\newcommand{\AdS}{\mathrm{AdS}}
\newcommand{\CFT}{\mathrm{CFT}}
\newcommand{\SCFT}{\mathrm{SCFT}}
\newcommand\NS{\mathrm{NS}}
\newcommand\IRR{\mathrm{RR}}
\newcommand{\Pic}{\mathrm{Pic}}
\newcommand{\vol}{\mathrm{vol}}
\newcommand\hetdil{{\varphi_{het}}}
\def\ec{{\bf 8_c}}
\def\ev{{\bf 8_v}}
\def\es{{\bf 8_s}}
\newcommand{\ap}{{\alpha'}}
\newcommand{\N}{\mathbb N}
\newcommand{\C}{\mathbb C}
\newcommand{\Q}{\mathbb Q}

% orientifold planes and D-branes
\newcommand{\Or}{\Omega (-1)^{F_L}}
\newcommand{\Om}[1]{\ensuremath{\mathrm{O}#1^-}}
\newcommand{\Op}[1]{\ensuremath{\mathrm{O}#1^+}}
\newcommand{\Omt}[1]{\ensuremath{\widetilde{\mathrm{O}#1}{}^-}}
\newcommand{\Opt}[1]{\ensuremath{\widetilde{\mathrm{O}#1}{}^+}}
\newcommand{\D}[1]{\ensuremath{\mathrm{D}#1}}
\newcommand{\ssum}{{\textstyle{\displaystyle\sum}}}


%%%%%%%%%%%% MACROS MACROS MACROS %%%%%%%%%

\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}[thm]{Corollary}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{fact}[thm]{Fact}
\newtheorem{facts}[thm]{Facts}

\theoremstyle{definition}
\newtheorem{example}[thm]{Example}
\newtheorem{defn}[thm]{Definition}
\newtheorem*{notation}{Notation}
%\newtheorem*{rem}{Remark}
\newtheorem{rem}{Remark}
\newtheorem*{rems}{Remarks}
\newtheorem*{claim}{Claim}
%\renewcommand\qedsymbol{$\blacksquare$}
\numberwithin{equation}{section}
\numberwithin{thm}{section}

\setlist[enumerate]{leftmargin=*,label=\rm{(\arabic*)}}

\newcommand{\bmat}[1]{\left[ \smallmatrix #1 \endsmallmatrix \right]}
\newcommand{\pmat}[1]{\left( \smallmatrix #1 \endsmallmatrix \right)}
\newcommand{\mat}[1]{\left( \begin{matrix} #1 \end{matrix} \right)}

\newcommand{\com}[2]{{ \left[ #1, #2 \right] }}
\newcommand{\acom}[2]{{ \left\{ #1, #2 \right\} }}

\newcommand{\bra}[1]{\langle{#1}|}
\newcommand{\ket}[1]{|{#1}\rangle}
\newcommand{\braket}[2]{\langle{#1}|{#2}\rangle}

\newcommand{\normord}[1]{%
:\mathrel{\mspace{2mu}#1\mspace{2mu}}:%
}

\newcommand{\lng}{\langle}
\newcommand{\rng}{\rangle}
\newcommand{\dg}{\dagger}
\renewcommand{\sgn}{\textnormal{sgn}}
\newcommand{\pa}[2]{\left(\frac{#1}{#2}\right)}
\newcommand{\os}[2]{\overset{#1}{#2}}

%%%%%%%%%%%
\newcommand{\blue}[1]{{\textcolor{blue}{#1}}}
\newcommand{\bluebf}[1]{{\textcolor{blue}{\bf #1}}}


\def\lp{\left(}
\def\rp{\right)}
\def\lb{\left[}
\def\rb{\right]}

%%%%%%% Greek letters %%%%%%%%%%%%%%%%%%
\def\a{\alpha}
\def\b{\beta}
\def\d{\delta}
\def\h{\eta}
\def\k{\kappa}
\def\l{\lambda}
\def\p{\rho}
\def\x{\xi}
\def\w{\omega}
\def\u{\upsilon}
\def\z{\zeta}
\def\th{\theta}
\def\vth{\vartheta}
\def\ve{\varepsilon}
\def\e{\varepsilon}
\def\vf{\varphi}
\def\f{\phi}
\def\n{\nu}
\def\s{\sigma}
\def\g{\gamma}
\def\t{\tau}

\def\a{\alpha}
\def\b{\beta}
\def\d{\delta}
\def\h{\eta}
\def\k{\kappa}
\def\l{\lambda}
\def\p{\varrho}
\def\x{\zeta}
\def\w{\omega}
\def\u{\upsilon}
\def\z{\zeta}
\def\th{\theta}
\def\vth{\vartheta}
\def\ve{\varepsilon}
\def\e{\varepsilon}
\def\vf{\varphi}
\def\f{\phi}
\def\n{\nu}
\def\s{\sigma}
\def\g{\gamma}
\def\t{\tau}

\def\OO{{\Omega}}
\def\GG{\Gamma}
\def\DD{\Delta}
\def\LL{\Lambda}
\def\TH{\Theta}


\def\OO{{\Omega}}
\def\GG{\Gamma}
\def\DD{\Delta}
\def\LL{\Lambda}
\def\TH{\Theta}

\def\del{ \partial}
\newcommand{\delbar}{ \bar{\partial}}
\def\ddd{{\rm d}}

\def\ad{{\dot{\alpha}}}
\def\bd{{\dot{\beta}}}
\def\dd{{\dot{\delta}}}
\def\gd{{\dot{\gamma}}}
\def\ld{{\dot{\lambda}}}
\def\kd{{\dot{\kappa}}}
\def\pd{{\dot{\rho}}}


\newcommand{\zb}{{\bar z}}
\newcommand{\wb}{{\bar w}}
\newcommand{\ib}{{\bar \imath}}
\newcommand{\jb}{{\bar \jmath}}
\newcommand{\thb}{{\bar \theta}}
\newcommand{\Db}{{\bar D}}
\newcommand{\fb}{{\bar \phi}}
\newcommand{\lab}{{\bar \lambda}}
\newcommand{\Lab}{{\bar \Lambda}}
\newcommand{\xb}{{\bar \chi}}
\newcommand{\psib}{{\bar \psi}}
\newcommand{\alb}{{\bar \a}}
\newcommand{\bb}{{\bar \b}}
\newcommand{\kb}{{\bar k}}
\newcommand{\cb}{{\bar c}}
\newcommand{\mb}{{\bar m}}
\newcommand{\nb}{{\bar n}}
\newcommand{\pb}{{\bar p}}
\newcommand{\re}{{\rm Re}}
\newcommand{\im}{{\rm Im}}
\newcommand{\y}{{\rm \mathbbm{y}}}
\newcommand{\xx}{{\rm \mathbbm{x}}}
\newcommand{\err}{\mathrm{err}}
\renewcommand{\sb}{{\bar \s}}
\renewcommand{\sgn}{{\rm sgn}}
\newcommand{\R}{\mathbb R}
\newcommand{\Z}{\mathbb Z}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\vt}{\vartheta}
\newcommand{\lrb}[1]{\left(#1\right)}
\newcommand{\lrB}[1]{\left[#1\right]}
\newcommand{\lri}[1]{\left|#1\right|}

\newcommand{\half}{\frac{1}{2}}
\newcommand{\qrt}{\frac{1}{4}}
\newcommand{\cc}{{\rm c.c.}}

\newcommand{\ub}[1]{\underbrace{#1}}

\newcommand{\arccosh}{\operatorname{arccosh}}

\newcommand{\kbf}{\bf\color{green!30!black!70!}}

\def\wt{\widetilde}
\def\wh{\widehat}
\def\bar{\overline}
\newcommand{\andd}{\quad \mbox{ and } \quad}
\newcommand{\where}{\quad \mbox{ where }}


\newenvironment{discussion}{\noindent \newline \noindent \bf
 ************************** begin discussion\rm \\ \bf}{\rm \noindent \newline
 \noindent \bf ************************** end discussion \rm\\}
\setlist[itemize]{noitemsep, topsep=0pt}

\allowdisplaybreaks

\makeatletter
\newcommand{\vast}{\bBigg@{2}}
\newcommand{\Vast}{\bBigg@{5}}
\makeatother

\renewcommand{\pmod}[1]{\ \left( \mathrm{mod} \, #1 \right)}
\newcommand{\Pmod}[1]{\ ( \mathrm{mod} \, #1 )}
\newcommand{\erf}{{\mathrm{erf}}}
\newcommand{\erfi}{{\mathrm{erfi}}}
\newcommand{\PV}{{\,\mathrm{PV}}}
\newcommand{\rint}[2]{\tensor*[_{\ *\!\!\!}]{\int}{_{#1}^{#2}}}
\newcommand{\Res}{\operatorname{Res}}
\newcommand{\DDD}{\mathcal{D}}
\newcommand{\ord}{\operatorname{ord}}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\Arg}{\operatorname{Arg}}

\title{Prime detecting quasi-modular forms in higher level}
\author{Ben Kane}
\address{The University of Hong Kong, Department of Mathematics, Pokfulam, Hong Kong}
\email{bkane@hku.hk}
\author{Krishnarjun Krishnamoorthy}
	\address{Department of Mathematics, School of Engineering and Sciences, SRM University AP, Neerukonda, Mangalagiri Mandal
		Guntur District, Andhra Pradesh-522240}
        	\email[Krishnarjun Krishnamoorthy]{krishnarjunmaths@outlook.com, krishnarjun.k@srmap.edu.in}
\author{Yuk-Kam Lau}
\address{Weihai Institute for Interdisciplinary Research, Shandong University, China and Department of Mathematics, The University of Hong Kong,  Pokfulam, Hong Kong}
\email{yukkamlau@hku.hk}


\begin{document}

\date{\today}
\keywords{Quasimodular forms, sign changes of Fourier coefficients}
\subjclass[2020]{11F11,11F30}
\begin{abstract}
	In a previous work, the authors resolved a conjecture about the structure of prime-detecting quasi-modular forms by studying sign changes occurring in quasi-modular cusp forms. In this paper, we extend the considerations to prime-detecting quasi-modular forms of higher level, in particular describing the structure of the space of quasi-modular forms that detect primes in various arithmetic progressions. We also provide an ``analytic'' proof of the level one case.
\end{abstract}
\maketitle


\section{Introduction}

Recently Craig, van Ittersum and Ono \cite{CvIO}, showed that the set of primes is ``partition theoretic'', meaning that the set of primes can be described as the set of solutions certain Diohpantine equations involving partition functions. In fact they showed that there is an infinite family of such partition-theoretic identities that ``strongly detect'' primes. To describe one of the simplest such examples, given an $a\in \N$, we define the MacMahon partition function
\[
M_a(n) := \underset{n = m_1s_1 + \ldots + m_as_a}{\sum_{0 < s_1 <\ldots < s_a}} m_1\ldots m_a.
\]
Then one of the results of \cite{CvIO} states that an integer $n$ is a prime if and only if
\[
(n^2-3n+2)M_1(n) = 8 M_2(n).
\]
As mentioned before, this is just one of an infinite family of such relations. Some more recent results are available in \cite{Craig, GomezAP, Kang}.

\begin{defn}\label{defn:Detect}
    A sequence of numbers $a(n)$ is said to \textit{detect} a set $A\subseteq \N$ if $a(n)=0$ whenever $n\in A$. We say that $a(n)$ \textit{strongly detects} $A$ if in addition, $a(n) \neq 0$ whenever $n\notin A$.
\end{defn}

    The existence of prime detecting partition identities arose within the larger context of quasi-modular forms whose $n$-th Fourier coefficient detects (or strongly detects) primes. In particular, define a subset $\Omega$ of the graded ring of (integer weight) quasi-modular forms (of full level) such that $f\in\Omega$ if and only if for ($q:=e^{2\pi i\tau}$)
    \[
    f(\tau)=\sum_{n\geqslant 0} c_f(n) q^n,
    \]
    we have $c_f(n)$ strongly detects the primes. Let $\mathcal{E}$ denote the space of \begin{it}quasi-modular Eisenstein series\end{it} (i.e., the vector space spanned by Eisenstein series and their derivatives). In \cite[Theorem 2.3]{CvIO} the authors classify $\mathcal{E}\cap\Omega$, and propose the following conjecture.
    \begin{conj}\label{Conj:CvIO}
        With notation as above, $\Omega \subset \mathcal{E}$.
    \end{conj}

    In a recent work \cite{KKL1}, we prove this conjecture for quasi-modular forms of full level. In fact we deduce Conjecture \ref{Conj:CvIO} as a consequence of the following slightly stronger result. Let $\tilde{\Omega}$ be the set of all quasi-modular forms that detect primes. By this we mean that the Fourier coefficients of the quasi-modular form detect primes as in Definition \ref{defn:Detect}.
    \begin{thm}\label{thm:KKL}
        With notation as above, $\tilde{\Omega} \subset \mathcal{E}$. In particular, $\Omega \subset \mathcal{E}$.
    \end{thm}
    
    The purpose of this note is to investigate the situation for quasi-modular forms of arbitrary level. For $N,M\in\N$ and $m\in\Z$ with $\gcd(m,M)=1$, we let $\widetilde{\Omega}_{m,M}(\Gamma_1(N))$ be the set of quasi-modular forms $f$ of level $N$ (i.e., modular on $\Gamma_1(N)$) for which $c_f(p)=0$ for every $p\equiv m\pmod{M}$ with $p\nmid N$. Similarly, we let $\Omega_{m,M}(\Gamma_1(N))$ be those which are prime detecting in the sense that $f\in \Omega_{m,M}(\Gamma_1(N))$ if and only if 
    \[
    \left\{n\equiv m\pmod{M}: \gcd(n,N)=1,\ c_{f}(n)=0\right\}=\left\{p\equiv m\pmod{M}: p\text{ prime},\ p\nmid N\right\}.
    \]
    More generally we may define $\tilde{\Omega}_{m,M}(\Gamma_0(N), \chi)$ to be the set of all quasi-modular forms of level $\Gamma_0(N)$ and character $\chi$ which detect primes.

    It turns out that a naive generalization of Theorem \ref{thm:KKL} to higher level is not true. Contrary to the results in \cite{KKL1}, a quasi-modular form that detects primes need not lie in $\mathcal{E}(\Gamma_0(N),\chi)$ itself. That is, it is no longer true that $\tilde{\Omega}_{m,M}(\Gamma_0(N), \chi) \subseteq \mathcal{E}(\Gamma_0(N), \chi)$, the set of quasi-modular Eisenstein series (of suitable level, character etc.). More precisely, the ``cuspidal part'' of $f$ need not be zero. For example, if $E\in \mathcal{E}(\Gamma_0(N),\chi)\cap \widetilde{\Omega}_{1,3}(\Gamma_0(N),\chi)$, then for any quasi-modular form $f$ of level $N$ and character $\chi$, so is 
    \[
    E+f-f\otimes \chi_{-3},
    \]
    where $f\otimes \chi$ denotes the quadratic twist $f\otimes\chi(\tau)=\sum_{n\geq 0} \chi(n)c_f(n)q^n$ of $f$ and $\chi_D(n):=\left(\frac{D}{n}\right)$ is the Kronecker character. However, \textit{all} of the coefficients of $f-f\otimes\chi_{-3}$ vanish in the given arithmetic progression, so this function doesn't affect the detection problem \textit{within this arithmetic progression}.
    %We hence see that the main content of Theorem \ref{thm:mainAP} is that the coefficients in the fixed arithmetic progression of a prime-detecting form only come from Eisenstein series. In \cite{KKL1}, the arithmetic progression was all integers, and hence the form itself lied in the Eisenstein series subspace.
    
    To make matters more precise, we introduce the following sieving operator. For $m\in\Z$ and $M\in\N$, we define the \begin{it}sieving operator\end{it} $S_{M,m}$ acting on quasi-modular forms by 
    \[
    f\big|S_{M,m}(\tau):=\sum_{n\equiv m\pmod{M}} c_f(n)q^n.
    \]
    The sieving operator $S_{M,m}$ maps quasi-modular forms of level $N$ to quasi-modular forms of level $\lcm(N,M^2,MN)$ (for example, see \cite[Lemma 2.2 (2)]{Vanishing}).
    
    When detecting primes in the arithmetic progression $m\pmod{M}$, we may obviously add an arbitrary $g|S_{M',m'}$ for any arithmetic progression $m'\pmod{M'}$ that does not intersect the arithmetic progression $m\pmod{M}$. More generally, we may consider all the forms in the kernel of the sieving operator $S_{M,m}$. Thus $\ker(S_{M,m})$ sits naturally inside $\tilde{\Omega}_{m,M}$ as a subspace. Also, in view of Remark~\ref{rem3} below, it is also necessary to sieve the ``old-forms'' away from $f$ with the family $\{S_{N,n}\}_{(n,N)=1}$ of operators.  Our main theorem asserts that, once this is done, what remains is Eisenstein.
    
    %the {\color{red}direct sum of \sout{orthogonal}} complement{\color{red}s} of $\ker(S_{M,m}{\color{red}\circ S_{N,n}})$ inside $\tilde{\Omega}_{m,M}$ is Eisenstein. {\color{red}[[For "orthogonal" complement, do we need to discuss the inner product defined on the space of quasimodular forms?]]}
    
    \begin{thm}\label{thm:VanishPrimesArithmetic}
    For $M,N\in\N$ and $m\in\Z$ with $\gcd(m,M)=1$, let $\mathcal{V}_{m,M}$ be the subset of $n\in \{0,\dots N-1\}$ for which $(N\Z+n)\cap (M\Z+m)$ is non-empty\footnote{$(N\Z+n )\cap (M\Z+m) \neq \emptyset$ iff $m\equiv n$ mod $(M,N)$. The ``only if" part is clear, while for the ``if" part, we have the solution $x = m-  (m-n) \alpha M/(M,N) = n + (m-n)\beta N/(M,N)$ where $\alpha M+\beta N= (M,N)$.} and $\gcd(n,N)=1$. Then for a quasi-modular form $f$ of level $N$, we have $f\in \widetilde{\Omega}_{m,M}(\Gamma_1(N))$ if and only if $f\in\widetilde{\Omega}_{n,N}(\Gamma_1(N))$ for every $n\in \mathcal{V}_{m,M}$.
    
    Moreover, all of the coefficients of elements of $\widetilde{\Omega}_{m,M}(\Gamma_1(N))$ from the arithmetic progression $n\equiv m\pmod{M}$ relatively prime to $N$ come from coefficients of Eisenstein series in the sense that 
    \[
    \bigoplus_{n\in\mathcal{V}_{m,M}}\widetilde{\Omega}_{m,M}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}=\bigoplus_{n\in \mathcal{V}_{m,M}} \mathcal{E}\left(\Gamma_1(N)\right)\cap \widetilde{\Omega}_{n,N}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}. 
    \]
    In particular, we have 
    \[
    \bigoplus_{n\in\mathcal{V}_{m,M}}\Omega_{m,M}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}=\bigoplus_{n\in \mathcal{V}_{m,M}} \mathcal{E}\left(\Gamma_1(N)\right)\cap \Omega_{n,N}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}.
    \]
    \end{thm}
    

\begin{rem}
    Before we move forward, we mention that a Galois theoretic proof of Conjecture \ref{Conj:CvIO} was recently obtained in \cite{BvIMOS}. Their proof relies on an extension of the fundamental lemma of Ono-Skinner \cite{Ono-Skinner}. Their proof rests on showing that the Fourier coefficients of cusp forms vary erratically in congruence classes, while the proof of Theorem \ref{thm:KKL} rests on showing that the signs of the Fourier coefficients of cusp forms vary erratically. With regard to forms of higher level, the proof of \cite{BvIMOS} seems to follow through but for an important caveat. The forms considered should not have complex multiplication (in the sense of Ribet \cite{Ribet}). Our proof does not require this restriction and works in the most general setting. The key input here is provided by the prime number theorems\footnote{For an 
    $L$-function $L(s)=\sum_{n\geqslant 1} a_n n^{-s}$ (initially defined for $\Re(s)> 1$), 
    the prime number theorem refers to the asymptotic formula of the form
    \[
    \sum_{p \leqslant x} a_p \;=\; \frac{c\,x}{\log x} \,+\, o(x),
    \]
    where the constant $c$ may be zero.} for $L$-functions and Rankin-Selberg $L$-functions attached to quasi-modular forms (these are easily seen to be shifts of the corresponding $L$ functions attached to the original holomorphic modular forms and enjoy all of their analytic properties). These results rest on the analytic properties of the associated $L$-functions and therefore ultimately on the theory of newforms, irrespective of whether or not the forms possess complex multiplication. Thus our results are slightly more general than what can be deduced using Galois theoretic considerations.
    
    %{\color{red}Give a brief explanation as to why the CM hypothesis is unnecessary for us.}
    %{\color{purple}
    %The crucial ingredient is the prime number theorems\footnote{The prime number theorem for the $L$-function $L(s)=\sum_{n\ge 1}a_n n^{-s}$ (when $\re s \gg 1$) is referred to the formula $\sum_{p\le x} a_p = c x/(\log x) + o(x)$ where the constant $c$ may take the value $0$.} for the $L$-functions and Rankinâ€“Selberg $L$-functions associated with modular forms. These theorems are, in turn, based on the analytic properties of these $L$-functions; hence, the theory of newforms -- regardless of whether the forms are CM or not -- is applied.}
\end{rem}

    \begin{rem}
        A weaker statement (than Theorem \ref{thm:VanishPrimesArithmetic}) along the lines of Theorem \ref{thm:KKL} reads that, for any $n\in\mathcal{V}_{m,M}$,
        \begin{equation}\label{eqn:WeakInclusion}
            \widetilde{\Omega}_{m,M}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n} \subset \mathcal{E}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}.
        \end{equation}
    \end{rem}

    \begin{rem}\label{rem3}
        The condition $\gcd(n,N)=1$ in the theorem is necessary. There is a natural operator $V_d$ defined by
         \[
        f|V_d(\tau)=f(d\tau)=\sum_{n\geq 0}c_f(n)q^{dn}.
         \]
        This operator sends quasi-modular forms of level $N$ to those of level $Nd$. By applying the operators $V_p$ to forms of level $N'\mid N$, we may artificially force $c_f(p)=0$ for $p\mid N$. For example, if $f$ is a quasi-modular form of level $N$ and $g$ is a quasi-modular form of level $\frac{N}{p}$ with $c_g(1)\neq 0$, then the Fourier coefficients of 
        \[
        f-\frac{c_f(p)}{c_g(1)} g|V_p
        \]
        vanish precisely at the prime $p$ and any $p'$ for which $c_f(p')=0$.
    \end{rem}

    \begin{rem}

    The sieving operators $S_{M,m}$ and $S_{N,n}$ are a commuting family of projections in the sense that $S_{N,n}\circ S_{M,m} = S_{M,m}\circ S_{N,n} = S_{(n+N\Z)\cap (m+M\Z)}$. Recall that, if non-empty, by the Chinese remainder theorem, $(n+N\Z)\cap (m+M\Z)$ defines an arithmetic progression modulo $\lcm(N,M)$. If $(n+N\Z)$ does not intersect with $(m+M\Z)$, then by $S_{(n+N\Z)\cap (m+M\Z)}$, we denote the zero operator (which annihilates every quasi-modular form). Therefore the direct sum over $\bigoplus_{n\in \mathcal{V}_{m,M}}$ in Theorem \ref{thm:VanishPrimesArithmetic} maybe replaced with $\bigoplus_{\substack{1\le n\le N\\ \gcd(n,N)=1}}$.

    \end{rem}


    \begin{rem}    
    We also note that $S_{N,n}\circ S_{N,n} = S_{N,n}$ (and similarly for $S_{M,m}$ etc.). In particular, $S_{M,m}\circ S_{N,n}$ is a projection into the images of the respective sieving operators. %In particular, $\widetilde{\Omega}_{m,M}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}$ is orthogonal to $\widetilde{\Omega}_{m,M}\cap\ker(S_{M,m}\circ S_{N,n})$. That is to say that 
    Every element in $\widetilde{\Omega}_{m,M}$ can be written \textit{uniquely} as a sum of quasi modular forms coming from $\widetilde{\Omega}_{m,M}\cap\ker(S_{M,m}\circ S_{N,n})$ and $\widetilde{\Omega}_{m,M}|S_{M,m}|S_{N,n}$. Our main theorem now asserts that the second component is Eisenstein.
    
% {\color{red}When $(M\Z+m)\cap (N\Z+n)=\emptyset$, the operator $S_{M,m}\circ S_{N,n}$ is the zero operator, so one can replace $\bigoplus_{n\in \mathcal{V}_{m,M}}$ by $\bigoplus_{\substack{1\le n\le N\\ \gcd(n,N)=1}}$ in the theorem. 
    
%    {\color{blue} \textbf{KK:} What do you mean by \textit{a} complement? Is there a word missing?} Thank you. Better to add direct sum to mean a subspace complement, not set complement.} {\bf[BK: I think that this remark was not correct anymore. If $(N\Z+n)\cap (M\Z+m)$ is empty, then $S_{M,m}\circ S_{N,n}$ is the zero map, but if $(N\Z+n)\cap (M\Z+m)\neq\emptyset$ and $\gcd(N,n)\neq 1$, then we don't have this. I changed the statement a bit. {\color{red} YK: I think you are right.}]\rm}
    \end{rem}

    In light of Theorem \ref{thm:KKL}, the space $\tilde{\Omega}$ naturally breaks into two components; the first one arising from the kernel of the sieving operator, and the second arising from quasi-modular Eisenstein series. The sieving operator $S_{m,M}$ is a projection operator and its kernel is quite large (for example given a cusp form $f$, $f-f|S_{m,M}\in \ker(S_{m,M})$). Thus we direct our attention to the Eisenstein series part of $\tilde{\Omega}_{m,M}$. We define the Eisenstein series following Sections 4.5 and 4.6 of \cite{DiamondShurman}. Let $\chi, \psi$ be Dirichlet characters, primitive of level $N_1, N_2$ respectively. Let $k\geqslant 2$ be an integer. Suppose that $\chi(-1)\psi(-1) = (-1)^k$. Suppose
    \begin{equation}\label{eqn:EisensteinSeriesDefinition}
        E_{k,\chi,\psi} (\tau) = \delta(\chi) L(1-k, \psi) + 2 \sum_{n=1}^{\infty} \sigma_{k-1}^{\chi,\psi}(n) q^{n},
    \end{equation}
    where as before $q = e^{2\pi i\tau}$ and where
    \begin{equation}\label{eqn:DivisorFunctionDefn}
        \sigma_{k-1}^{\chi,\psi}(n) = \sum_{d | n} \chi\left(\frac{n}{d}\right) \psi(d) d^{k-1}
    \end{equation}
    is the weighted divisor function. The constant $\delta(\psi)$ equals $1$ if $\psi \equiv 1$ and is zero otherwise. If $N$ is the least common multiple of $N_1, N_2$ so that $\chi\psi$ is a primitive Dirichlet character modulo $N$, $E_{k,\chi,\psi}$ is modular of weight $k$ and level $\Gamma_0(N)$ with nebentype character $\chi\psi$. Finally, we denote by $E_2$, the usual non-holomorphic Eisenstein series of weight $2$, with Fourier expansion given by
    \[
    E_2(\tau) := 1 - 24 \sum_{n=1}^{\infty} \sigma_1(n) q^n.
    \]
    
    Ultimately, we want to describe a basis for this space\footnote{Similar to the $H_{k}$'s defined in \cite{CvIO}.}. To this end, we make the following definition. Let $M\in \mathbb{N}$ be fixed and choose $m$ coprime to $M$. For every pair of integers $\ell \geqslant 2$ and $k \geqslant 2$, and two Dirichlet characters $\chi, \psi$ modulo $M$ define
    \[
    H_{k, \ell, \chi, \psi} := \overline{\chi(m)}D^{\ell-1}E_{k, \psi, \chi} - \psi(m) E_{\ell, \overline{\psi}, \overline{\chi}}
    \]
    where we set $E_{0,\chi,\psi}\equiv 0$. Here $D$ is the familiar differential operator, defined as
    \[
    D:= \frac{1}{2\pi i} \frac{d}{d\tau}.
    \]

    \begin{thm}\label{thm:Basis}
        %\sout{Then (the image under the sieving operator of) $\Tilde{\Omega}_{m,M}$}
        The space 
        \[
        \bigoplus_{n\in\mathcal{V}_{m,M}}\widetilde{\Omega}_{m,M}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}
        \]
        is spanned by (the image under the sieving operator of)
        \[
            \bigcup_{K=2}^{\infty} \left\{H_{k_1,\ell_1,\chi_1,\psi_1} -H_{k_2, \ell_2, \chi_2, \psi_2}\ |\ k_1+\ell_1 = k_2+\ell_2 = K \right\}.
        \]
    \end{thm}

    We also have an analogue of \cite[Theorem 1.3]{KKL1} and may be proved similarly.
    
    \begin{thm}\label{thm:FiniteCheckAP}
        Suppose that $f\in \mathcal{E}(\Gamma_1(N))$. There exists an integer $r$, such that if there exists primes $\{p_1, \ldots, p_r\}$ all congruent to $m$ mod $M$ such that $c_{f}(p_i)=0$ for $i=1,2,\ldots,r$, then $f\in \tilde{\Omega}_{m,M}$.
    \end{thm}
    
    We conclude this paper by providing, in an appendix, a purely analytic proof of some of results for the level one case. In particular, we give an equivalent condition (see Theorem \ref{thm:Equivalence} below) in terms of certain ratios of the Riemann zeta function for the linear combination of certain divisor functions to detect primes. This can be used to easily produce examples of such identities which in turn can be translated to prime-detecting identities involving partition functions. As the notation and results leading up to the proof of Theorem \ref{thm:Equivalence} are self-contained and somewhat independent of the rest of the paper, we have given the details in a separate section.
    
    The paper is organized as follows. In Section \ref{sec:signchanges} we show that a quasimodular cusp form not in the kernel of the sieving operator exhibits infinitely many sign changes at the prime Fourier coefficients. In Section \ref{sec:arithmetic}, we show that the corresponding Eisenstein series exhibit at most finitely many sign changes and conclude the proof of Theorem \ref{thm:VanishPrimesArithmetic}. In Sections \ref{sec:Basis} and \ref{sec:FiniteCheckAP} we prove Theorems \ref{thm:Basis} and \ref{thm:FiniteCheckAP} respectively.
    

    \subsection*{Acknowledgements} The research was conducted during the conference HKU Number Theory Days 2025. The authors thank the Department of Mathematics at HKU and the Institute of Mathematical Research at HKU for supporting the conference and hosting the second author.
The research of the first author was supported by grants from the Research Grants Council of the Hong Kong SAR, China (project numbers HKU 17314122, HKU 17305923). The third author is supported by GRF (No. 17317822) and NSFC (No. 12271458).    

\section{Sign changes of quasi-modular cusp forms}\label{sec:signchanges}

    We let $\mathcal{S}(\Gamma_1(N))$ denote the space of quasi-modular cusp forms of level $N$ (i.e., the space spanned by cusp forms and their derivatives), and omit $\Gamma_1(N)$ in the notation if $N=1$ (i.e., $\mathcal{S}:=\mathcal{S}(\Gamma_1(1))$).
    
    In this section, we show that Fourier coefficients of quasi-modular cusp forms (of arbitrary level) exhibit sign changes. First we recall the main sign change lemma (for the full level case) from \cite{KKL1}. 
    
\begin{lem}\label{lem:signchanges}
Suppose that $F\in \mathcal{S}$ has a Fourier expansion 
\[
F(\tau)=\sum_{n\geqslant 1}c_{F}(n)q^n
\]
with $c_{F}(n)\in\R$. If $F\neq 0$, then the sequence $c_{F}(p)$, running over $p$ prime, has infinitely many sign changes. 
\end{lem} 

In higher levels, we have the following lemma.

\begin{lem}\label{lem:signchangesGamma1(N)}
    Suppose that $F\in \mathcal{S}(\Gamma_1(N))$ has a Fourier expansion 
    \[
    F(\tau)=\sum_{n\geqslant 1}c_{F}(n)q^n
    \]
    with $c_{F}(n)\in\R$.  If $F\neq 0$, then either $c_F(n)=0$ for all $n$ satisfying $(n,N)=1$ or $\{c_F(p)\}$ has infinitely many sign changes, as $p$ runs through the primes. 
\end{lem}

\begin{proof}
    Suppose that $F\neq 0$. We may express a quasi-modular cusp form $F$ as the linear combination of Hecke eigenforms and their derivatives;
    \[
    F= \sum_{f} \sum_j A_{f}(j) f^{(j)}
    \]
    where $A_f(j)\in \mathbb{C}$ and $f^{(j)}=D^j f$ is the normalized $j$-th derivative of $f$. We break the sum over $f$ based on the image of the $V$ map. Observe from \cite[Lemma 4]{Li} that it suffices to restrict ourselves to those $d$ which divide $N$. Hence, we write
    \[
    F = \sum_{d|N} G_d
    \]
    where
    \[
    G_d= \sum_{f} \sum_{j} A_f(j) f^{(j)} = \sum_{n=1}^{\infty} c_{G_d}(n) q^{nd}
    \]
    where the $f$ sum is restricted to those Hecke eigenforms in the image of $V_d$ operator.

    From construction, it follows that $c_F(dp)=\sum_{\ell|d} c_{G_\ell}(dp/\ell)$ for almost all primes $p$. In particular, $c_F(p) = c_{G_1}(p)$ for almost all primes $p$ as $c_{G_d}(p) =0$ for every $d>1$ and any prime $p>N$. If $G_1=0$, then  $c_F(n)=0$ for all $(n,N)=1$, because for all $1<d|N$, $G_d$ contributes a coefficient of $0$ to the term $q^n$ whenever $(n,N)=1$. Therefore the lemma would follow if we prove the infinite of sign changes in $c_{G_1}(p)$. This reduces the proof of the lemma to the case of $d=1$.

    When $d=1$, we may without loss of generality suppose that $F=G_1$. In this case, the proof is very similar to the proof of Lemma \ref{lem:signchanges}. We briefly sketch the arguments for the sake of completeness and refer the reader to \cite{KKL1} for more details. 

    After some rearrangement, we may write 
    \[
    c_F(p) = \sum_f \sum_j A_{f}(j) p^j a_f(p) = \sum_{f} P_{f}(p) a_f(p)
    \]
    for some polynomials $P_{f}(x)\in \C[x]$. For every $f$, we let the weight of $f$ to be $k_{f}\geqslant 4$ and the degree of $P_{f}$ to be $j_{f} \geqslant 0$. Denote the leading coefficient of $P_{f}$ as simply $A_{f}$. From the Ramanujan bound for $a_{f}$ \cite{Deligne1, Deligne2}, we know
    \[
    P_{f}(p)a_f(p) = A_f p^{j_f} a_f(p) + O\left(p^{j_{f} + \frac{k_{f}-1}{2} -1}\right),
    \]
    where the implied constant depends at most on $F$.

    Set $\alpha_0:= \max_{f}\left\{\alpha_f := j_f + \frac{k_f +1}{2}\right\}$. Summing over the primes, and using the prime number theorem in this setting (see \cite[Theorem 5.13]{IwaniecKowalski}) gives us
    \begin{equation}\label{eqm}
    \sum_{p\leqslant x} c_F(p) = o\left(\frac{x^{\alpha_0}}{\log(x)}\right).
    \end{equation}

    Similarly,
    \begin{eqnarray*}
    |c_F(p)|^2 
    &=& \sum_{f,g} P_f(p) \overline{P_g(p)} a_f(p)\overline{a_g(p)} \\
    &=& \sum_f |P_f(p)|^2 |a_f(p)|^2 + \sum_{f\neq g} P_f(p) \overline{P_g(p)} a_f(p)\overline{a_g(p)}.     
    \end{eqnarray*}

    Appealing to Rankin-Selberg theory and the Selberg orthogonality conjecture \cite{LY}, the sum over $p$ of $|c_F(p)|^2$ is dominated by the diagonal term. In particular the leading order of the asymptotic is obtained from the forms of the largest weight. Plugging this all in we get,
    \begin{align}\label{eqms}
    \sum_{p\leqslant x} |c_F(p)|^2 \gg_{F} \frac{x^{\beta_{0}}}{\log(x)}.
    \end{align}
    where $\beta_0 = 2\alpha_0-1$.
    It follows from Deligne's bound that for all prime $p$, 
    \[
    |c_F(p)|\leqslant \sum_{f} |P_{f}(p) a_f(p)| \leqslant \sum_{f} \|P_f\| p^{j_f}|a_f(p)| \leqslant C_F p^{\alpha_0-1}
    \]
    where $\|P\|=\sum_{r=0}^{m} |A_r|$ if $P(x)=\sum_{r=0}^m A_rx^r\in \mathbb{C}[x]$ and $C_F>0$ is a constant.  This yields
    \[
    \sum_{p\leqslant y} |c_F(p)|^2 = O\left(\frac{y^{2\alpha_0-1}}{\log(y)}\right).
    \]
With these ingredients we may now deduce the infinitude of sign changes as in \cite{KKL1}. This completes the proof.
\end{proof}

\begin{cor}\label{lem:signchangesarithmetic}
Suppose that $f\in\mathcal{S}(\Gamma_1(N))$ for some $N\in\N$ and 
\[
f(\tau)=\sum_{l\geqslant 1}c_f(l)q^l
\]
with $c_f(l)\in\R$. If $M\in\N$ and $m\in\Z$ with $\gcd(m,M)=1$, then for any $n\in \Z$ with $\gcd(n,N)=1$, either $f\in \ker(S_{M,m}\circ S_{N,n})$ or $\{c_f(p)\}_{p\equiv m\pmod{M},\, p\equiv n\pmod{N}}$ has infinitely many sign changes.
\end{cor}


\begin{proof}

The form $F:=f|S_{M,m}|S_{N,n}\in \mathcal{S}(\Gamma_1(L))$ for some $L|M^4 N^2$. By Lemma \ref{lem:signchangesGamma1(N)}, either $c_F(l)=0$ for all but finitely many  $(l,L)=1$ or $\{c_F(p)\}$ has infinitely many sign changes. As the Fourier coefficients are supported on (a subset of) $(m+M\Z)\cap (n+N\Z)$, all integers in the support are coprime with $L$. The desired result follows.
\end{proof}

%{\color{red}[[I'm sorry that I don't see why $F=0$ for the former case.]]} {\color{blue} KK: If you apply another $S_{n,N}$ operator, then it might be correct.}{\color{red} [[Agree.]]}


\section{Vanishing at primes in arithmetic progressions}\label{sec:arithmetic}

We begin with a lemma similar to \cite[Lemma 4.1]{KKL1}.
\begin{lem}\label{lem:EisensteinArithmetic}
Suppose that $f\in \mathcal{E}(\Gamma_1(N))$ with real Fourier coefficients. Then for every arithmetic progression $m\pmod{N}$ with $\gcd(m,N)=1$ there exists $\varepsilon_{m,N}\in \{-1,0,1\}$ for which every sufficiently large prime $p\equiv m\pmod{N}$ 
\[
\sgn(c_f(p))=\varepsilon_{m,N}.
\]
\end{lem}
\begin{proof}
The basis elements of $\mathcal{E}(\Gamma_1(N))$ are given by $D^{\ell}E_{k,\chi,\psi}|V_{\delta}$, where $\chi$ and $\psi$ are Dirichlet characters modulo $N$.
%, and the $n$-th Fourier coefficient of $D^{\ell}E_{k,\chi,\psi}|V_{\delta}$ is 
%\[
%(n\delta)^{\ell}\sum_{d\mid \frac{n}{\delta}} \chi(d)\psi\left(\frac{n}{d}\right) d^{k-1}.
%\]
%{\color{red}
%\textbf{KK:} I think the above should be $d | n$ and not $d | (n/\delta)$.
%}
%{\color{purple}
%\textbf{YK:} It seems to be  $n^{\ell}\sum_{d\mid \frac{n}{\delta}} \chi(d)\psi\Big(\frac{n/
%\delta}{d}\Big) d^{k-1}$.
%}
Suppose $f\in \mathcal{E}(\Gamma_1(N))$. Let us denote the Fourier coefficient of $f$ as $c_{f}(n)$.
For $n=p$ prime, expressing $f$ as a linear combination of the basis above, and using \eqref{eqn:DivisorFunctionDefn}, we see that the $p$-th coefficient can be written as a polynomial 
\[
c_f(p)=\sum_{r} \beta_r(\chi(p),\psi(p)) p^r,
\]
where the coefficients $\beta_r(\chi(p),\psi(p))\in\C$ only depend on $f$, $\chi(p)$ and $\psi(p)$. Since $\chi$ and $\psi$ are characters modulo $N$, for $p\equiv m\pmod{N}$ we have $\chi(p)=\chi(m)$ and $\psi(p) = \psi(m)$, so 
\[
c_f(p)=\sum_{r} \beta_r(\chi(m),\psi(m)) p^r
\]
is a polynomial in $p$ whose coefficients only depend on $f$ and $m$. If this polynomial vanishes identically, then we may take $\varepsilon_{m,N}:=0$, and otherwise we may choose $r_0$ largest so that $\beta_{r_0}(\chi(m),\psi(m))\neq 0$, in which case we may choose 
\[
\varepsilon_{n,N}:=\sgn\left(\beta_{r_0}(\chi(m),\psi(m))\right)\in\{\pm 1\}.
\]
The fact that $\beta_{r_0}(\chi(m),\psi(m))\in \mathbb{R}$ follows from the assumption that the Fourier coefficients of $f$ are real.
\end{proof} 

Theorem \ref{thm:VanishPrimesArithmetic} now follows by an argument similar to the proof of Theorem \ref{thm:KKL}.
\begin{proof}[Proof of Theorem \ref{thm:VanishPrimesArithmetic}]
Suppose that $f\in \widetilde{\Omega}_{m,M}(\Gamma_1(N))$. We split 
\[
f=f_E+f_S
\]
where $f_E \in \mathcal{E}(\Gamma_1(N))$ and $f_{S}\in \mathcal{S}(\Gamma_1(N))$. As in the proof of Theorem \ref{thm:KKL} (see \cite{KKL1}), we may isolate the real and imaginary parts of $f_E, f_S$ and deal with them separately. For brevity, we shall suppose that the Fourier coefficients of $f_E$ and $f_S$ are real valued and move forward.
For any $n\in\mathcal{V}_{m,M}$, Lemma \ref{lem:EisensteinArithmetic} gives us $\varepsilon_{n,N}$ for which 
\[
\sgn\left(c_{f_E}(p)\right)=\varepsilon_{n,N}
\]
for sufficiently large $p\equiv n\pmod{N}$. Since $(N\Z+n)\cap (M\Z+m)$ is non-trivial by assumption, there exist infinitely many $p$ in this intersection (since $(N\Z+n)\cap (M\Z+m)$ defines an arithmetic progression and since $(n,N)=(m,M) = 1$), and for such sufficiently large $p$ we have $c_{f_S}(p)=-c_{f_E}(p)$, implying that 
\[
\sgn\left(c_{f_S}(p)\right)=-\sgn\left(c_{f_E}(p)\right)=-\varepsilon_{n,N}.
\]
However, by Corollary~\ref{lem:signchangesarithmetic}, $\{c_{f_S}(p)\}_{p\in (N\Z+n)\cap (M\Z+m)}$ has infinitely many sign changes unless $f_S|S_{M,m}|S_{N,n}=0$. Therefore, 
\[
\sum_{n\in\mathcal{V}_{m,M}} f_S|S_{M,m}|S_{N,n}=0.
\]

%{\color{red}
%[[}Since there are no sign changes in this arithmetic progression, we conclude that $f_S$ is annihilated by the $S_{M',m'}$ for the arithmetic progression $m'\pmod{M'}$ defined by $N\Z+n\cap M\Z+m$. Since $f_S$ is annihilated by every such $S_{M',m'}$, we conclude that {\bf [BK: I think that this is where the issue in the proof was. We said that since it was annihilated for every such $m'$ and $M'$, then $f_S|S_{M,m}=0$, but it is only annihilated for $S_{M',m'}$ coming from $n\in\mathcal{V}_{m,M}$, and hence we only get that the coefficients of $f_S|S_{M,m}$ vanish at those $n$ relatively prime to $N$.]} {\color{red} Thanks, I see.]]}

But then 
\[
\sum_{n\in \mathcal{V}_{m,M}}f|S_{M,m}|S_{N,n}=\sum_{n\in\mathcal{V}_{m,M}}f_E|S_{M,m}|S_{N,n}.
\]
Since the vanishing of the coefficients of $f_E|S_{M,m}$ in arithmetic progressions are determined by the vanishing of the $\varepsilon_{n,N}$, and these only depend on $n\pmod{N}$ (or, equivalently, by the polynomials from the proof of Lemma \ref{lem:EisensteinArithmetic} vanishing identically), we see that the $p$-th coefficient of $f_E|S_{M,m}$ vanishes at every $p\equiv m\pmod{M}$ if and only if the $p$-th coefficient of $f_E$ vanishes at every $p\equiv n\pmod{N}$ for every $n\in\mathcal{V}_{m,M}$.

\end{proof}

\section{A spanning set for $\tilde{\Omega}_{m,M}$}\label{sec:Basis}

In this section, we prove Theorem \ref{thm:Basis}. Before the proof, it is convenient to first quickly verify that for any integer $K$, $H_{k_1,\ell_1,\psi_1,\chi_1} -H_{k_2, \ell_2, \psi_2, \chi_2} \in \tilde{\Omega}_{m,M}$, where $k_1 + \ell_1 = k_2 +\ell_2 = K$. With $k_1,\ell_1, k_2,\ell_2$ fixed as above, for ease of notation, let $H:=H_{k_1,\ell_1,\psi_1,\chi_1} -H_{k_2, \ell_2, \psi_2, \chi_2}$. For a prime $p\equiv m\mod M$, we may calculate the $p$-th Fourier coefficient of $H$ as 
\begin{multline*}
    a_H(p) = \overline{\chi_1(m)} \left(p^{\ell_1-1}(\chi_1(m) p^{k_1-1} + \psi_1(m))\right) - \psi_1(m)(\overline{\chi_1(m)}p^{\ell_1-1} + \overline{\psi_1(m)}) \\
    -\overline{\chi_2(m)} \left(p^{\ell_2-1}(\chi_2(m) p^{k_2-1} + \psi_2(m))\right) 
    + \psi_2(m)(\overline{\chi_2(m)}p^{\ell_2-1} + \overline{\psi_2(m)}) = 0.
\end{multline*}
Now we move to the proof of Theorem \ref{thm:Basis}. Suppose that $f$ is a quasi-modular form detecting primes congruent to $m$ modulo $M$ and lies in $\bigoplus_{n\in\mathcal{V}_{m,M}}\widetilde{\Omega}_{m,M}\left(\Gamma_1(N)\right)|S_{M,m}|S_{N,n}$.%\sout{We shall suppose that $f$ is in the orthogonal complement of $\ker(S_{m,M})$.}
From Theorem \ref{thm:VanishPrimesArithmetic}, $f$ is spanned by quasi-modular Eisenstein series. From Proposition 20\footnote{In Zagier's notation, $\phi=E_2$.} of \cite{Zagier}, $f$ is a linear combination of the derivatives of the level $N$ Eisenstein series and $E_2$.
Suppose that 
\[
f = \sum_{i=1}^{t} \alpha_i D^{\ell_i} E_{k_i, \chi_i, \psi_i}|S_{M,m}|S_{N,n} + \alpha_{t+1} D^{\ell_{t+1}} E_2|S_{M,m}|S_{N,n}.
\]
for some Dirichlet characters $\chi_i, \psi_i$. For ease of notation, we shall denote $E_{k_i, \chi_i, \psi_i}|S_{M,m}|S_{N,n}$ as simply $E_i$.

Suppose without loss of generality that $i=1,\ldots, r$ are the indices for which $k_i+\ell_i=K$. For $E_2$, we may consider the characters $\chi_{t+1}, \psi_{t+1}$ as trivial characters. We write
\[
f = \sum_{i=1}^{r} \alpha_i D^{\ell_i} E_{i} + g
\]
for some quasi-modular form $g$. If we define $K_g$ analogous to $K_f$ above, then we observe that $K_g < K_f$. For a prime $p\equiv m \mod M$, we have 
\begin{multline*}
    a_f(p) = \sum_{i=1}^{r} \alpha_i p^{\ell_i} \left( \chi_i(m) p^{k_i-1} + \psi_i(m)\right) + a_g(p)\\
    = p^{K_f-1} \sum_{i=1}^{r}\alpha_i\chi_i(m) + \sum_{i=1}^{r} \alpha_i\psi_{i}(m) p^{\ell_i} + a_g(p).
\end{multline*}
In particular we have 
\[
a_f(p) = p^{K-1} \sum_{i=1}^{r} \alpha_i\chi_i(m) + O\left(p^{K-2}\right)
\]
since $k_i >1$. As $f$ detects primes on that arithmetic progression, considering $p\to\infty$, this forces
\[
\sum_{i=1}^{r} \alpha_i\chi_i(m) = 0.
\]

Let $\{e_i\}$ denote the standard basis of $\mathbb{C}^r$. The orthogonal complement of $(\chi_1(m),\chi_2(m),\ldots, \chi_r(m))$ in $\mathbb{C}^r$ is spanned by $\{v_j := \overline{\chi_1(m)} e_1 - \overline{\chi_j(m)} e_j\}$ for $2\leqslant j \leqslant r$. Hence there exist constants $\beta_j$'s such that $(\alpha_1,\ldots, \alpha_r) = \beta_2 v_2 + \ldots + \beta_rv_r$.

Therefore, on rewriting the above equation, we have 
\[
f = \sum_{j=2}^{r} \beta_j \left(\overline{\chi_1(m)}D^{\ell_1}E_1 - \overline{\chi_j(m)} D^{\ell_j} E_j \right) + g.
\] 
We define the quasi modular form $h$ such that 
\begin{align*}
    f &= \sum_{j=2}^{r} \beta_j \left(\overline{\chi_1(m)}D^{\ell_1}E_1 - \psi_1(m) E_{\ell_1, \overline{\chi_1}, \overline{\psi_1}} + \psi_j(m) E_{\ell_j, \overline{\chi_j}, \overline{\psi_j}} - \overline{\chi_j(m)} D^{\ell_j} E_j \right) + h\\
    &=\sum_{j=2}^{r} \beta_j \left(H_{k_1,\ell_1,\chi_1,\psi_1} - H_{k_j,\ell_j,\chi_j,\psi_j}\right) + h
\end{align*}
Since we have already shown that $H_{k_1,\ell_1,\chi_1,\psi_1} - H_{k_j,\ell_j,\chi_j,\psi_j}\in \tilde{\Omega}_{m,M}$ earlier in the proof, we observe that $h\in \Tilde{\Omega}_{m,M}$ and $K_h < K_f$. If $K_f$ were equal to $2$, then $h\equiv 0$, since the space of quasi-modular Eisenstein series are spanned by forms of weight $2$ or larger. Thus the theorem follows by induction on $K_f$.

    \section{Finite checks for prime detection}\label{sec:FiniteCheckAP}

    The proof is a ready adaptation of the proof of \cite[Theorem 1.3]{KKL1} Suppose that 
    \[
    f = \sum_{\ell,k} \alpha_{\ell,k} D^{\ell} G_{k,\chi,\psi}|V_{\delta}.
    \]
    Choose $r$ to be the maximum of $\ell + k$ for which $\alpha_{\ell,k}\neq 0$. From the proof of Lemma \ref{lem:EisensteinArithmetic}, we may write 
    \[
    c_f(p)=\sum_{r} \beta_r(\chi(m),\psi(m)) p^r,
    \]
    whenever $p \equiv m\mod M$ is a prime. Now, if $c_f(p_i) = 0$ for $1\leqslant i\leqslant r+1$, then we obtain the system of equations
    \[
        \begin{pmatrix}
            1&p_1&p_1^2&\ldots&p_1^r\\
            1&p_2&p_2^2&\ldots&p_2^r\\
            \vdots&\vdots&\vdots&\ddots&\vdots\\
            1&p_{r+1}&p_{r+1}^2&\ldots&p_{r+1}^r
        \end{pmatrix}
        \begin{pmatrix}
            \beta_0(\chi(m),\psi(m))\\ \beta_1(\chi(m),\psi(m))\\ \vdots \\ \beta_r(\chi(m),\psi(m))
        \end{pmatrix} = 0.
    \]
    This system, being a Vandermonde system is uniquely solvable and hence $\beta_0(\chi(m),\psi(m)) = \beta_1(\chi(m),\psi(m)) = \ldots = \beta_r(\chi(m),\psi(m)) = 0$. Hence the claim follows.

\appendix

\section{An analytic proof for the level one case}\label{sec:AnalyticProof}

As in \cite{CvIO}, polynomial expressions involving Macmahon partition functions can be rewritten as polynomial equations involving various divisor functions. Thus the study of partition identities that detect primes is in principle a study of ``divisor function'' identities that detect primes. In this spirit we consider the following general situation.

For $1\leqslant i \leqslant r$, we choose polynomials $P_i(x)\in \Q[x]$. We also choose and fix non-negative integers $\{k_i\}_{i=1}^{r}$. We define the function
	\begin{equation}\label{Equation "a(n) definition"}
		a(n) := \sum_{i=1}^{r} P_i(n) \sigma_{k_i}(n) = \sum_{j=1}^{t} A_j n^{\ell_j} \sigma_{k_j}(n),
	\end{equation}
	for some $A_j\in \Q$ and (not necessarily distinct) non-negative integers $\ell_j$. We observe that 
	\begin{equation}\label{Equation "W definition"}
		W(s):= \sum_{j=1}^{t} A_j \zeta(s-\ell_j)\zeta(s-\ell_{j}-k_{j}) = \sum_{n=1}^{\infty} \frac{a(n)}{n^s}.
	\end{equation}
    Associate to $W$, two integers $R_{W}$ and $S_W$ defined by $R_{W} := \max_{j} \{\ell_j, \ell_j + k_j\} = \max_j \{\ell_j+k_j\}$ and $S_{W}:=\sum |A_j|$, where the sum is over all indices $j$ such that $\ell_j + k_j = R_W$.	We also define the closely related function
	\begin{equation}
		Z_{W}(s) := \prod_{j=1}^{t} \left(\zeta(s-\ell_{j}) \zeta(s-\ell_{j}-k_{j}) \right)^{A_j} = \sum_{n=1}^{\infty} \frac{b(n)}{n^s}
	\end{equation}
	for $\Re(s) \gg 1$. In order to state the main theorem, we introduce the following notation. For a quadruple of integers $\textbf{m}=(m_1,m_2,m_3,m_4)\in \Z^4$, we define
	\begin{multline}\label{Equation "W_m definition"}
		W_{\textbf{m}}(s):= \zeta(s-m_1)\zeta(s-m_3) + \zeta(s-m_2)\zeta(s-m_4)\\
		-\zeta(s-m_1)\zeta(s-m_4) - \zeta(s-m_2)\zeta(s-m_3) =: \sum_{n=1}^{\infty} \frac{a_{\textbf{m}}(n)}{n^s}.
	\end{multline}
	
	
	\begin{thm}\label{thm:Equivalence}
		Let notation be as above and fix a $W$ as in \eqref{Equation "W definition"}. Then the following are equivalent.
		\begin{enumerate}
			\item	$a(p)$ vanishes for all primes $p$,
			\item 	$Z_{W}(s)\equiv 1$,
			\item 	There exist integers $\{c_{\textbf{m}}\}_{\textbf{m}\in \Z^4}$, at most finitely many of them non-zero, such that $W(s) = \sum_{\textbf{m}\in \Z^{4}} c_{\textbf{m}}W_{\textbf{m}}(s)$,
            %{\color{red} I wonder if it should be:  There exist integers $c_{\textbf{m}}$, $\textbf{m}\in \Z^{4}$, such that at most finitely many of them are non-zero and $W(s) = \sum_{\textbf{m}\in \Z^{4}} c_{\textbf{m}}W_{\textbf{m}}(s)$.} {\color{blue}\textbf{KK:} Modified}
            \item   There exist $R_W$ distinct primes $\{p_1, \ldots, p_{R_W}\}$ such that $a(p_i)=0$ for $1\leqslant i\leqslant R_W$.
		\end{enumerate}
	\end{thm}

\begin{proof}

%    {\color{purple}\noindent
%[[YK: Let $M:=\{m_j: 1\le j \le u\}$ where $m_j$ is defined in the proof of Theorem~1. Then 
%$$
%a(p) = \sum_{j=1}^t A_j (p^{\ell_j+k_j}+p^{\ell_j}) = \sum_{m\in M} p^m\sum_{\substack{1\le j\le t\\ \ell_j=m \ {\rm or} \ \ell_j+k_j=m}} A_j = \sum_{m\in M} p^m A_m,\quad  {\rm say}.
%$$
%Hence $a(p)=0$ iff $A_m=0$, $\forall$ $m\in M$.
%
%For $m\in M$, we write $B_m:=B_j$ for $1\le j\le u$ satisfying $m_j=m$. Then,
%\begin{align*}
%\log Z_W(s) 
%& = \sum_p b(p)p^{-s} + \cdots = \sum_{m\in M} B_m (\sum_p p^m p^{-s} + \cdots) \\
%& = \sum_p \Big(\sum_{m\in M} B_m p^m\Big) p^{-s} +\cdots.  
%\end{align*}
%As $a(p)=b(p)$, we get $B_m = A_m$. Thus, $a(p)=0$ implies all $B_m=0$. This gives (1) $\Rightarrow$ (2) and the implication remains true for a little weakened condition (1), e.g. $a(p)$ vanishes for all sufficiently large primes $p$.]]}	

    The equivalence of (1) and (4) is the content of \cite[Theorem 1.3]{KKL1}. So we shall prove that (1), (2) and (3) are equivalent to one another.
    
		Let us prove that (1) implies (2). Clearing out denominators in the definition of $a(n)$ and by taking a suitable power of $Z_{W}(s)$ we may without loss of generality assume that all the $A_j$'s are integers.
        %{\color{red} \sout{Replacing $\ell_j+k_j$ by $\ell_j$ and $k_j$ by $-k_j$, we may assume all $k_j$ are nonnegative, then $R_W= \max_j \{\ell_j+k_j\}$. (But now $\ell_j$ may be negative.)}} {\color{blue} \textbf{KK:} The $k_i$'s are supposed to be the weights of Eisenstein series, so they are non-negative and are at least $2$. Nevertheless, $\sigma_{k}$ is defined for all $k$.} {\color{red} YK: Good. This assumption helps, but we need to include the case $k_i=0$ because the reduction (or induction) process introduces the term $\zeta(s-\ell_t)\zeta(s-\ell_t)$ for $\textbf{m} = (\ell_t,\ell_j,\ell_t,m_4)$.}
        After some rearrangement, we may write
		\[
		Z_{W}(s) = \prod_{j=1}^{u} \zeta(s-m_j)^{B_j}
		\]
		where, $m_1 < m_2 < \ldots < m_u$. Let $M:=\{m_j: 1\leqslant j \leqslant u\}$. To prove (2), it suffices to show that $B_j=0$ for all $j=1,\ldots,u$. From definition, observe that $b(n)$ is a multiplicative function. In other words, $Z_{W}$ has an Euler product expansion. We have
        \begin{align*}
        \log Z_W(s) 
        & = \sum_p b(p)p^{-s} + \cdots\\
        & = \sum_p \Big(\sum_{m_j\in M} B_j p^{m_j}\Big) p^{-s} +\cdots.  
        \end{align*}
		On the other hand, we observe that $a(p) = b(p)$ for every prime $p$. This implies that $B_j=0$ for every $1\leqslant j\leqslant u$. This proves (2).
		
		Let us assume (2) and prove (3). Henceforth we shall adopt the notation of \eqref{Equation "W definition"}. In that notation, we shall suppose that $A_j\neq 0$ for every $1\leqslant j \leqslant t$. For simplicity, we shall also suppose that $(\ell_{i}, k_i) \neq (\ell_{j}, k_{j})$ if $i\neq j$. We shall proceed by successive reductions, first on $S_W$ and then on $R_W$, and so on. If $W\equiv 0$, then we may choose $c_{\textbf{m}}=0$ for all $\textbf{m}$ and we are done. So we suppose otherwise, that is $W\neq 0$. In particular, since $Z_{W}\equiv 1$ by assumption, we have $S_{W} \geqslant 2$ and, since all $\ell_j$ and $k_j$ are non-negative, $R_W\ge 0$.
		
		Without loss of generality, suppose that $\ell_t + k_t = R_{W}$. Define $m_4 = \ell_{t}+k_{t}$. Suppose also without loss of generality that $A_t > 0$.  Since $Z_{W}(s)\equiv 1$, there exists at least one $j < t$ such that $\ell_j+k_j = \ell_t + k_t$ and $A_j < 0$. Since we have chosen the tuples $(\ell_i, k_i)$'s to be distinct it follows that $\ell_{j}\neq \ell_{t}$ and $k_{j}\neq k_{t}$. Relabeling indices if necessary we may suppose that $k_{t} > k_{j}$. In particular $k_{t}\neq 0$. Choose and fix such a $j$. We set $m_2 = \ell_{j}$ and $m_1 = m_3 = \ell_t$. Define $\tilde{W}(s) := W(s)+W_{\textbf{m}}(s)$. We observe that $Z_{\tilde{W}}(s) = Z_{W}(s) \equiv 1$ by assumption. We crucially observe that $R_{\tilde{W}}\leqslant R_{W}$ and if $R_{\tilde{W}} = R_{W}$, then $S_{\tilde{W}} \leqslant S_{W} - 2 < S_{W}$. Furthermore, $R_{\tilde{W}} < R_{W}$ if $S_{W}=2$. If $\tilde{W}\neq 0$, repeating the above process for $\tilde{W}$, we may ``peel off" one $W_{\textbf{m}}$ at a time from $W$.        
        
        To complete the proof, we need to make sure that this process terminates in finitely many steps. To see this, first observe that $R_{W}$ is non-increasing in this process. Second, at each step, at least one of $R_{W}$ or $S_{W}$ is strictly decreasing. Moreover, whenever $R_{W}$ is non-decreasing, the parameter $S_{W}$ is strictly decreasing, ultimately forcing $R_{W}$ to decrease after finitely many steps. Even though $S_{W}$ grows occasionally\footnote{When $S_{W}=2$, there are exactly two choices for $j$ such that the maximum $R_{W}$ is attained. We cancel them out by adding the corresponding $W_{\textbf{m}}$ and obtain $\tilde{W}$. In this step, $R_{\tilde{W}} < R_{W}$, but $S_{\tilde{W}}$ now counts the sum of coefficients of the pairs $(\ell_{j}, k_{j})$ such that $\ell_{j} + k_{j} = R_{\tilde{W}}$ and not $R_{W}$. Thus $S_{\tilde{W}} > S_{W}$ (and in fact this might be considerably larger).}, it is at most finite, at each step, and hence eventually goes down to zero, which in turn decreases $R_{W}$, keeping the reduction argument going. Continuing this process, we eventually end up with $R_{W}=0$ and $S_{W}= 2$; but then $W = \zeta^2(s) - \zeta^2(s) = 0$ (since $Z_{W}\equiv 1$). Following this procedure, we may write $W$ as a integral linear combination of $W_{\textbf{m}}$'s proving (3).

        %{
        %\color{blue} \textbf{KK:} From the highlighted parts above, the boundary case is when $k_{t} = k_{j}=0$, in which case the terms corresponding to $(\ell_{j}, k_{j})$ and $(\ell_{t}, k_{t})$ cancel each other out. Thus this case is also handled.
        %} {\color{red} YK: Good. This argument is more succinct. The selection of bigger $k$ will now lead to the choice of $\textbf{m}=(\ell_j,\ell_t,\ell_j,\ell_t)$ for the case $k_t=0$ in the previous proof. There is no need to separate into different cases then. Thank you.}

        
  %      {\color{red} Moreover, we observe 
   %     \begin{itemize}
    %      \item $k_t\ge 1$: Then $S_W\ge 2$. 
     %     \begin{enumerate}
      %        \item[(i)] If $S_{W} > 2$, then $S_{\tilde{W}} = S_{W}- 2$  and $R_{\tilde{W}} = R_W$. 
       %       \item[(ii)] If $S_{W}=2$, then $R_{\tilde{W}} < R_{W}$.
        %  \end{enumerate}
          

         % \item $k_t=0$: Then $S_W\ge 3$. Write  $S_W=A_t+|A_j|+\cdots$.
          %\begin{enumerate}
     %         \item[(i)] If $S_W >3$, then for $A_j=-1$,
      %    $$
       %   S_{\tilde{W}} = (A_t-1) + |A_j+2| +\cdots = A_t-1+|A_j|+\cdots= S_W-1,
        %  $$
         % or for $A_j\le -2$
          %$$
     %     S_{\tilde{W}} = (A_t-1) + |A_j+2| +\cdots = A_t-1+|A_j|-2+\cdots= S_W-3.
      %    $$           
       %   In either case, $S_{\tilde{W}}< S_W$ and $R_{\tilde{W}}= R_W$.
        %      \item[(ii)]  If $S_W=3$, then either $R_{\tilde{W}}< R_W$, or $S_{\tilde{W}}=2$ and $R_{\tilde{W}}=R_W=\ell_j+k_j$ with $k_j\ge 1$. (The latter case can then be handled with (ii) above.)
         % \end{enumerate}
        %\end{itemize}
        %}

        %\sout{If ${\color{red} S}_{W} > 2$, then ${\color{red} S}_{\tilde{W}} = {\color{red} S}_{W}- 2$ {\color{red} and $R_{\tilde{W}} = R_W$ for $k_t\neq 0$ while $S_{\tilde{W}} < S_{W}$ and $R_{\tilde{W}}\le R_W$ for $k_t=0$}. If ${\color{red} S}_{W}=2$, then ${\color{red} R}_{\tilde{W}} < {\color{red} R}_{W}$ {\color{red}for $k_t\neq 0$ and the case $k_t=0$ cannot happen.}} 
        
%        {\color{red} In summary, a successive application of the above process will reduce $W$ into an $\tilde{W}$ such that if $\tilde{W}\not\equiv 0$, then $Z_{\tilde{W}} \equiv 1$, and $0\le R_{\tilde{W}}< R_W$\footnote{Note $S_{\tilde{W}}$ is not under control of $S_W$ in this case.} or $0\leqslant S_{\tilde{W}} < S_{W}$\footnote{This happens when $R_{\tilde{W}}= R_W$. The inequality $S_{\tilde{W}} < S_{W}$ assures that further reductions of $W$ leads to an $\tilde{W}$ for which $R_{\tilde{W}}< R_W$ holds}. Repeating the argument for $\tilde{W}$, we will eventually reduce $W$ into $0$ after a finite number of steps of adding $\pm W_{\textbf{m}}(s)$'s.}
        
		Finally let us suppose (3) and prove (1). It suffices to verify that for every $\textbf{m}\in \Z^{4}$, and for every prime $p$, we have $a_{\textbf{m}}(p)=0$. We shall give the proof assuming $m_1 < m_2 < m_3 < m_4$, the other cases being treated similarly. Given $\textbf{m} = (m_1,m_2,m_3,m_4)\in \Z^{4}$, by direct computation, we have that 
		\begin{multline}\label{eqn:FourierCoefficientCalculation}
			a_{\textbf{m}}(p) = p^{m_1} \sigma_{m_3-m_1}(p) + p^{m_2}\sigma_{m_4-m_2}(p)-p^{m_1}\sigma_{m_4-m_1}(p) - p^{m_2}\sigma_{m_3-m_2}(p)\\
			= p^{m_3} +p^{m_1} + p^{m_4} + p^{m_2}-p^{m_4} - p^{m_1} - p^{m_3} - p^{m_2}=0.
		\end{multline}
		This completes the proof of the theorem.
\end{proof}


    \begin{rem}
        It is natural to want to extend this proof to forms of higher level, but this does not seem to be straightforward. When considering Eisenstein series of higher level, the associated Dirichlet series involves products of Dirichlet $L$-functions. More precisely, the analogue of $Z_{W}$ (say $Z_{W,N}$, for level $N$) in this situation is no longer a ratio of shifts of the Riemann zeta function, but of $L$-functions associated to Dirichlet characters. The pole of $\zeta(s)$ at the point $s=1$ was used to pinpoint the rightmost singularity of $\log(Z_{W}(s))$. But, as it is well known that the $L$-function associated to non-principal Dirichlet characters have neither zeros nor poles on the boundary of absolute convergence, we run into trouble when looking for the rightmost singularity of $\log(Z_{W,N}(s))$, unless a principal character appears in the decomposition. Futhermore, GRH predicts that $\log(Z_{W,N}(s))$ should not have any poles in the vertical strip of width $1/2$ to the left of region of convergence if there is no principal character. A workaround to this obstacle seems to require new ideas.
    \end{rem}

Along with the vanishing at the primes, it is interesting to investigate when $a(n)$ is non-negative. For a general $W$ as above, the answer depends on the  of $c_{\textbf{m}}$. For $W_{\textbf{m}}$ however, we have the following precise result.

\begin{lem}
    Let $\textbf{m}=(m_1,m_2,m_3,m_4)$ be given. Then $\sgn(a_{\textbf{m}}(n)) = \sgn(m_2-m_1)\sgn(m_4-m_3)$ for every composite number $n$.
\end{lem}

\begin{proof}
    We need only generalize the calculation in \eqref{eqn:FourierCoefficientCalculation}. Suppose $n$ is a composite number. From definition,
    \begin{align*}
        a_{\textbf{m}}(n)&=n^{m_1} \sigma_{m_3-m_1}(n) + n^{m_2}\sigma_{m_4-m_2}(n)-n^{m_1}\sigma_{m_4-m_1}(n) - n^{m_2}\sigma_{m_3-m_2}(n)\\
        &=\sum_{d|n} (n^{m_1} d^{m_3-m_1} + n^{m_2} d^{m_4-m_2} - n^{m_1} d^{m_4-m_1} - n^{m_2} d^{m_3-m_2})\\
        &=\sum_{d|n} \left(\left(\frac{n}{d}\right)^{m_2} - \left(\frac{n}{d}\right)^{m_1}\right) (d^{m_4}-d^{m_3}).
    \end{align*}
    The terms corresponding to $d=1$ and $d=n$ vanish. The remaining terms all non-zero and have the same sign which is $\sgn(m_2-m_1)\sgn(m_4-m_3)$. The lemma follows from here.
\end{proof}



\bibliographystyle{amsalpha}


\bibliography{Bibliography}

\end{document}